{"version":3,"file":"index.js","sources":["../../../node_modules/webrtc-adapter/src/js/utils.js","../../../node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","../../../node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","../../../node_modules/sdp/sdp.js","../../../node_modules/rtcpeerconnection-shim/rtcpeerconnection.js","../../../node_modules/webrtc-adapter/src/js/edge/getusermedia.js","../../../node_modules/webrtc-adapter/src/js/edge/edge_shim.js","../../../node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","../../../node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","../../../node_modules/webrtc-adapter/src/js/safari/safari_shim.js","../../../node_modules/webrtc-adapter/src/js/common_shim.js","../../../node_modules/webrtc-adapter/src/js/adapter_factory.js","../../../node_modules/webrtc-adapter/src/js/adapter_core.js","../../../src/js/lib/EventTarget.js","../../../src/js/lib/DataChannel.js","../../../src/js/lib/thumbDataURI.js","../../../src/js/index.js"],"sourcesContent":["/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar logDisabled_ = true;\nvar deprecationWarnings_ = true;\n\n// Utility methods.\nvar utils = {\n  disableLog: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    logDisabled_ = bool;\n    return (bool) ? 'adapter.js logging disabled' :\n        'adapter.js logging enabled';\n  },\n\n  /**\n   * Disable or enable deprecation warnings\n   * @param {!boolean} bool set to true to disable warnings.\n   */\n  disableWarnings: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    deprecationWarnings_ = !bool;\n    return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n  },\n\n  log: function() {\n    if (typeof window === 'object') {\n      if (logDisabled_) {\n        return;\n      }\n      if (typeof console !== 'undefined' && typeof console.log === 'function') {\n        console.log.apply(console, arguments);\n      }\n    }\n  },\n\n  /**\n   * Shows a deprecation warning suggesting the modern and spec-compatible API.\n   */\n  deprecated: function(oldMethod, newMethod) {\n    if (!deprecationWarnings_) {\n      return;\n    }\n    console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n        ' instead.');\n  },\n\n  /**\n   * Extract browser version out of the provided user agent string.\n   *\n   * @param {!string} uastring userAgent string.\n   * @param {!string} expr Regular expression used as match criteria.\n   * @param {!number} pos position in the version string to be returned.\n   * @return {!number} browser version.\n   */\n  extractVersion: function(uastring, expr, pos) {\n    var match = uastring.match(expr);\n    return match && match.length >= pos && parseInt(match[pos], 10);\n  },\n\n  /**\n   * Browser detector.\n   *\n   * @return {object} result containing browser and version\n   *     properties.\n   */\n  detectBrowser: function(window) {\n    var navigator = window && window.navigator;\n\n    // Returned result object.\n    var result = {};\n    result.browser = null;\n    result.version = null;\n\n    // Fail early if it's not a browser\n    if (typeof window === 'undefined' || !window.navigator) {\n      result.browser = 'Not a browser.';\n      return result;\n    }\n\n    // Firefox.\n    if (navigator.mozGetUserMedia) {\n      result.browser = 'firefox';\n      result.version = this.extractVersion(navigator.userAgent,\n          /Firefox\\/(\\d+)\\./, 1);\n    } else if (navigator.webkitGetUserMedia) {\n      // Chrome, Chromium, Webview, Opera, all use the chrome shim for now\n      if (window.webkitRTCPeerConnection) {\n        result.browser = 'chrome';\n        result.version = this.extractVersion(navigator.userAgent,\n          /Chrom(e|ium)\\/(\\d+)\\./, 2);\n      } else { // Safari (in an unpublished version) or unknown webkit-based.\n        if (navigator.userAgent.match(/Version\\/(\\d+).(\\d+)/)) {\n          result.browser = 'safari';\n          result.version = this.extractVersion(navigator.userAgent,\n            /AppleWebKit\\/(\\d+)\\./, 1);\n        } else { // unknown webkit-based browser.\n          result.browser = 'Unsupported webkit-based browser ' +\n              'with GUM support but no WebRTC support.';\n          return result;\n        }\n      }\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n      result.browser = 'edge';\n      result.version = this.extractVersion(navigator.userAgent,\n          /Edge\\/(\\d+).(\\d+)$/, 2);\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n        // Safari, with webkitGetUserMedia removed.\n      result.browser = 'safari';\n      result.version = this.extractVersion(navigator.userAgent,\n          /AppleWebKit\\/(\\d+)\\./, 1);\n    } else { // Default fallthrough: not supported.\n      result.browser = 'Not a supported browser.';\n      return result;\n    }\n\n    return result;\n  },\n\n};\n\n// Export.\nmodule.exports = {\n  log: utils.log,\n  deprecated: utils.deprecated,\n  disableLog: utils.disableLog,\n  disableWarnings: utils.disableWarnings,\n  extractVersion: utils.extractVersion,\n  shimCreateObjectURL: utils.shimCreateObjectURL,\n  detectBrowser: utils.detectBrowser.bind(utils)\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar utils = require('../utils.js');\nvar logging = utils.log;\n\n// Expose public methods.\nmodule.exports = function(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n\n  var constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function(key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function(mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      var remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      var getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(function(devices) {\n            devices = devices.filter(function(d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function(d) {\n              return matches.some(function(match) {\n                return d.label.toLowerCase().indexOf(match) !== -1;\n              });\n            });\n            if (!dev && devices.length && matches.indexOf('back') !== -1) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function(e) {\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        InvalidStateError: 'NotReadableError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotReadableError',\n        MediaDeviceKillSwitchOn: 'NotReadableError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraintName,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function(c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function(e) {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n\n  navigator.getUserMedia = getUserMedia_;\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      navigator.getUserMedia(constraints, resolve, reject);\n    });\n  };\n\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {\n      getUserMedia: getUserMediaPromise_,\n      enumerateDevices: function() {\n        return new Promise(function(resolve) {\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\n          return window.MediaStreamTrack.getSources(function(devices) {\n            resolve(devices.map(function(device) {\n              return {label: device.label,\n                kind: kinds[device.kind],\n                deviceId: device.id,\n                groupId: ''};\n            }));\n          });\n        });\n      },\n      getSupportedConstraints: function() {\n        return {\n          deviceId: true, echoCancellation: true, facingMode: true,\n          frameRate: true, height: true, width: true\n        };\n      }\n    };\n  }\n\n  // A shim for getUserMedia method on the mediaDevices object.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (!navigator.mediaDevices.getUserMedia) {\n    navigator.mediaDevices.getUserMedia = function(constraints) {\n      return getUserMediaPromise_(constraints);\n    };\n  } else {\n    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n    // function which returns a Promise, it does not accept spec-style\n    // constraints.\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, function(c) {\n        return origGetUserMedia(c).then(function(stream) {\n          if (c.audio && !stream.getAudioTracks().length ||\n              c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function(track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function(e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n\n  // Dummy devicechange event methods.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\n    navigator.mediaDevices.addEventListener = function() {\n      logging('Dummy mediaDevices.addEventListener called.');\n    };\n  }\n  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\n    navigator.mediaDevices.removeEventListener = function() {\n      logging('Dummy mediaDevices.removeEventListener called.');\n    };\n  }\n};\n","\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar utils = require('../utils.js');\nvar logging = utils.log;\n\nvar chromeShim = {\n  shimMediaStream: function(window) {\n    window.MediaStream = window.MediaStream || window.webkitMediaStream;\n  },\n\n  shimOnTrack: function(window) {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n          }\n          this.addEventListener('track', this._ontrack = f);\n        }\n      });\n      var origSetRemoteDescription =\n          window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function() {\n        var pc = this;\n        if (!pc._ontrackpoly) {\n          pc._ontrackpoly = function(e) {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', function(te) {\n              var receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = pc.getReceivers().find(function(r) {\n                  return r.track && r.track.id === te.track.id;\n                });\n              } else {\n                receiver = {track: te.track};\n              }\n\n              var event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver: receiver};\n              event.streams = [e.stream];\n              pc.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(function(track) {\n              var receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = pc.getReceivers().find(function(r) {\n                  return r.track && r.track.id === track.id;\n                });\n              } else {\n                receiver = {track: track};\n              }\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver: receiver};\n              event.streams = [e.stream];\n              pc.dispatchEvent(event);\n            });\n          };\n          pc.addEventListener('addstream', pc._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n    }\n  },\n\n  shimGetSendersWithDtmf: function(window) {\n    // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('getSenders' in window.RTCPeerConnection.prototype) &&\n        'createDTMFSender' in window.RTCPeerConnection.prototype) {\n      var shimSenderWithDtmf = function(pc, track) {\n        return {\n          track: track,\n          get dtmf() {\n            if (this._dtmf === undefined) {\n              if (track.kind === 'audio') {\n                this._dtmf = pc.createDTMFSender(track);\n              } else {\n                this._dtmf = null;\n              }\n            }\n            return this._dtmf;\n          },\n          _pc: pc\n        };\n      };\n\n      // augment addTrack when getSenders is not available.\n      if (!window.RTCPeerConnection.prototype.getSenders) {\n        window.RTCPeerConnection.prototype.getSenders = function() {\n          this._senders = this._senders || [];\n          return this._senders.slice(); // return a copy of the internal state.\n        };\n        var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n        window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n          var pc = this;\n          var sender = origAddTrack.apply(pc, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(pc, track);\n            pc._senders.push(sender);\n          }\n          return sender;\n        };\n\n        var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n        window.RTCPeerConnection.prototype.removeTrack = function(sender) {\n          var pc = this;\n          origRemoveTrack.apply(pc, arguments);\n          var idx = pc._senders.indexOf(sender);\n          if (idx !== -1) {\n            pc._senders.splice(idx, 1);\n          }\n        };\n      }\n      var origAddStream = window.RTCPeerConnection.prototype.addStream;\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origAddStream.apply(pc, [stream]);\n        stream.getTracks().forEach(function(track) {\n          pc._senders.push(shimSenderWithDtmf(pc, track));\n        });\n      };\n\n      var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origRemoveStream.apply(pc, [stream]);\n\n        stream.getTracks().forEach(function(track) {\n          var sender = pc._senders.find(function(s) {\n            return s.track === track;\n          });\n          if (sender) {\n            pc._senders.splice(pc._senders.indexOf(sender), 1); // remove sender\n          }\n        });\n      };\n    } else if (typeof window === 'object' && window.RTCPeerConnection &&\n               'getSenders' in window.RTCPeerConnection.prototype &&\n               'createDTMFSender' in window.RTCPeerConnection.prototype &&\n               window.RTCRtpSender &&\n               !('dtmf' in window.RTCRtpSender.prototype)) {\n      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n      window.RTCPeerConnection.prototype.getSenders = function() {\n        var pc = this;\n        var senders = origGetSenders.apply(pc, []);\n        senders.forEach(function(sender) {\n          sender._pc = pc;\n        });\n        return senders;\n      };\n\n      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n        get: function() {\n          if (this._dtmf === undefined) {\n            if (this.track.kind === 'audio') {\n              this._dtmf = this._pc.createDTMFSender(this.track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        }\n      });\n    }\n  },\n\n  shimSourceObject: function(window) {\n    var URL = window && window.URL;\n\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this._srcObject;\n          },\n          set: function(stream) {\n            var self = this;\n            // Use _srcObject as a private property for this shim\n            this._srcObject = stream;\n            if (this.src) {\n              URL.revokeObjectURL(this.src);\n            }\n\n            if (!stream) {\n              this.src = '';\n              return undefined;\n            }\n            this.src = URL.createObjectURL(stream);\n            // We need to recreate the blob url when a track is added or\n            // removed. Doing it manually since we want to avoid a recursion.\n            stream.addEventListener('addtrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n            stream.addEventListener('removetrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n          }\n        });\n      }\n    }\n  },\n\n  shimAddTrackRemoveTrack: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n    // shim addTrack and removeTrack.\n    if (window.RTCPeerConnection.prototype.addTrack &&\n        browserDetails.version >= 64) {\n      return;\n    }\n\n    // also shim pc.getLocalStreams when addTrack is shimmed\n    // to return the original streams.\n    var origGetLocalStreams = window.RTCPeerConnection.prototype\n        .getLocalStreams;\n    window.RTCPeerConnection.prototype.getLocalStreams = function() {\n      var self = this;\n      var nativeStreams = origGetLocalStreams.apply(this);\n      self._reverseStreams = self._reverseStreams || {};\n      return nativeStreams.map(function(stream) {\n        return self._reverseStreams[stream.id];\n      });\n    };\n\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function(stream) {\n      var pc = this;\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n\n      stream.getTracks().forEach(function(track) {\n        var alreadyExists = pc.getSenders().find(function(s) {\n          return s.track === track;\n        });\n        if (alreadyExists) {\n          throw new DOMException('Track already exists.',\n              'InvalidAccessError');\n        }\n      });\n      // Add identity mapping for consistency with addTrack.\n      // Unless this is being used with a stream from addTrack.\n      if (!pc._reverseStreams[stream.id]) {\n        var newStream = new window.MediaStream(stream.getTracks());\n        pc._streams[stream.id] = newStream;\n        pc._reverseStreams[newStream.id] = stream;\n        stream = newStream;\n      }\n      origAddStream.apply(pc, [stream]);\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      var pc = this;\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n\n      origRemoveStream.apply(pc, [(pc._streams[stream.id] || stream)]);\n      delete pc._reverseStreams[(pc._streams[stream.id] ?\n          pc._streams[stream.id].id : stream.id)];\n      delete pc._streams[stream.id];\n    };\n\n    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n      var pc = this;\n      if (pc.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      var streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(function(t) {\n            return t === track;\n          })) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      var alreadyExists = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n      var oldStream = pc._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(function() {\n          pc.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        var newStream = new window.MediaStream([track]);\n        pc._streams[stream.id] = newStream;\n        pc._reverseStreams[newStream.id] = stream;\n        pc.addStream(newStream);\n      }\n      return pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n    };\n\n    // replace the internal stream id with the external one and\n    // vice versa.\n    function replaceInternalStreamId(pc, description) {\n      var sdp = description.sdp;\n      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {\n        var externalStream = pc._reverseStreams[internalId];\n        var internalStream = pc._streams[externalStream.id];\n        sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n            externalStream.id);\n      });\n      return new RTCSessionDescription({\n        type: description.type,\n        sdp: sdp\n      });\n    }\n    function replaceExternalStreamId(pc, description) {\n      var sdp = description.sdp;\n      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {\n        var externalStream = pc._reverseStreams[internalId];\n        var internalStream = pc._streams[externalStream.id];\n        sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n            internalStream.id);\n      });\n      return new RTCSessionDescription({\n        type: description.type,\n        sdp: sdp\n      });\n    }\n    ['createOffer', 'createAnswer'].forEach(function(method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      window.RTCPeerConnection.prototype[method] = function() {\n        var pc = this;\n        var args = arguments;\n        var isLegacyCall = arguments.length &&\n            typeof arguments[0] === 'function';\n        if (isLegacyCall) {\n          return nativeMethod.apply(pc, [\n            function(description) {\n              var desc = replaceInternalStreamId(pc, description);\n              args[0].apply(null, [desc]);\n            },\n            function(err) {\n              if (args[1]) {\n                args[1].apply(null, err);\n              }\n            }, arguments[2]\n          ]);\n        }\n        return nativeMethod.apply(pc, arguments)\n        .then(function(description) {\n          return replaceInternalStreamId(pc, description);\n        });\n      };\n    });\n\n    var origSetLocalDescription =\n        window.RTCPeerConnection.prototype.setLocalDescription;\n    window.RTCPeerConnection.prototype.setLocalDescription = function() {\n      var pc = this;\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(pc, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(pc, arguments[0]);\n      return origSetLocalDescription.apply(pc, arguments);\n    };\n\n    // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n    var origLocalDescription = Object.getOwnPropertyDescriptor(\n        window.RTCPeerConnection.prototype, 'localDescription');\n    Object.defineProperty(window.RTCPeerConnection.prototype,\n        'localDescription', {\n          get: function() {\n            var pc = this;\n            var description = origLocalDescription.get.apply(this);\n            if (description.type === '') {\n              return description;\n            }\n            return replaceInternalStreamId(pc, description);\n          }\n        });\n\n    window.RTCPeerConnection.prototype.removeTrack = function(sender) {\n      var pc = this;\n      if (pc.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      var isLocal = sender._pc === pc;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n            'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      pc._streams = pc._streams || {};\n      var stream;\n      Object.keys(pc._streams).forEach(function(streamid) {\n        var hasTrack = pc._streams[streamid].getTracks().find(function(track) {\n          return sender.track === track;\n        });\n        if (hasTrack) {\n          stream = pc._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          pc.removeStream(pc._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        pc.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n  },\n\n  shimPeerConnection: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        // Translate iceTransportPolicy to iceTransports,\n        // see https://code.google.com/p/webrtc/issues/detail?id=4869\n        // this was fixed in M56 along with unprefixing RTCPeerConnection.\n        logging('PeerConnection');\n        if (pcConfig && pcConfig.iceTransportPolicy) {\n          pcConfig.iceTransports = pcConfig.iceTransportPolicy;\n        }\n\n        return new window.webkitRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype =\n          window.webkitRTCPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      if (window.webkitRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return window.webkitRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n    } else {\n      // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n      var OrigPeerConnection = window.RTCPeerConnection;\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (pcConfig && pcConfig.iceServers) {\n          var newIceServers = [];\n          for (var i = 0; i < pcConfig.iceServers.length; i++) {\n            var server = pcConfig.iceServers[i];\n            if (!server.hasOwnProperty('urls') &&\n                server.hasOwnProperty('url')) {\n              utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n              server = JSON.parse(JSON.stringify(server));\n              server.urls = server.url;\n              newIceServers.push(server);\n            } else {\n              newIceServers.push(pcConfig.iceServers[i]);\n            }\n          }\n          pcConfig.iceServers = newIceServers;\n        }\n        return new OrigPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n        get: function() {\n          return OrigPeerConnection.generateCertificate;\n        }\n      });\n    }\n\n    var origGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function(selector,\n        successCallback, errorCallback) {\n      var self = this;\n      var args = arguments;\n\n      // If selector is a function then we are in the old style stats so just\n      // pass back the original getStats format to avoid breaking old users.\n      if (arguments.length > 0 && typeof selector === 'function') {\n        return origGetStats.apply(this, arguments);\n      }\n\n      // When spec-style getStats is supported, return those when called with\n      // either no arguments or the selector argument is null.\n      if (origGetStats.length === 0 && (arguments.length === 0 ||\n          typeof arguments[0] !== 'function')) {\n        return origGetStats.apply(this, []);\n      }\n\n      var fixChromeStats_ = function(response) {\n        var standardReport = {};\n        var reports = response.result();\n        reports.forEach(function(report) {\n          var standardStats = {\n            id: report.id,\n            timestamp: report.timestamp,\n            type: {\n              localcandidate: 'local-candidate',\n              remotecandidate: 'remote-candidate'\n            }[report.type] || report.type\n          };\n          report.names().forEach(function(name) {\n            standardStats[name] = report.stat(name);\n          });\n          standardReport[standardStats.id] = standardStats;\n        });\n\n        return standardReport;\n      };\n\n      // shim getStats with maplike support\n      var makeMapStats = function(stats) {\n        return new Map(Object.keys(stats).map(function(key) {\n          return [key, stats[key]];\n        }));\n      };\n\n      if (arguments.length >= 2) {\n        var successCallbackWrapper_ = function(response) {\n          args[1](makeMapStats(fixChromeStats_(response)));\n        };\n\n        return origGetStats.apply(this, [successCallbackWrapper_,\n          arguments[0]]);\n      }\n\n      // promise-support\n      return new Promise(function(resolve, reject) {\n        origGetStats.apply(self, [\n          function(response) {\n            resolve(makeMapStats(fixChromeStats_(response)));\n          }, reject]);\n      }).then(successCallback, errorCallback);\n    };\n\n    // add promise support -- natively available in Chrome 51\n    if (browserDetails.version < 51) {\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n          .forEach(function(method) {\n            var nativeMethod = window.RTCPeerConnection.prototype[method];\n            window.RTCPeerConnection.prototype[method] = function() {\n              var args = arguments;\n              var self = this;\n              var promise = new Promise(function(resolve, reject) {\n                nativeMethod.apply(self, [args[0], resolve, reject]);\n              });\n              if (args.length < 2) {\n                return promise;\n              }\n              return promise.then(function() {\n                args[1].apply(null, []);\n              },\n              function(err) {\n                if (args.length >= 3) {\n                  args[2].apply(null, [err]);\n                }\n              });\n            };\n          });\n    }\n\n    // promise support for createOffer and createAnswer. Available (without\n    // bugs) since M52: crbug/619289\n    if (browserDetails.version < 52) {\n      ['createOffer', 'createAnswer'].forEach(function(method) {\n        var nativeMethod = window.RTCPeerConnection.prototype[method];\n        window.RTCPeerConnection.prototype[method] = function() {\n          var self = this;\n          if (arguments.length < 1 || (arguments.length === 1 &&\n              typeof arguments[0] === 'object')) {\n            var opts = arguments.length === 1 ? arguments[0] : undefined;\n            return new Promise(function(resolve, reject) {\n              nativeMethod.apply(self, [resolve, reject, opts]);\n            });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n    }\n\n    // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = window.RTCPeerConnection.prototype[method];\n          window.RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        window.RTCPeerConnection.prototype.addIceCandidate;\n    window.RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  }\n};\n\n\n// Expose public methods.\nmodule.exports = {\n  shimMediaStream: chromeShim.shimMediaStream,\n  shimOnTrack: chromeShim.shimOnTrack,\n  shimAddTrackRemoveTrack: chromeShim.shimAddTrackRemoveTrack,\n  shimGetSendersWithDtmf: chromeShim.shimGetSendersWithDtmf,\n  shimSourceObject: chromeShim.shimSourceObject,\n  shimPeerConnection: chromeShim.shimPeerConnection,\n  shimGetUserMedia: require('./getusermedia')\n};\n"," /* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress); // was: relAddr\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort); // was: relPort\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n}\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  // was: channels\n  parsed.numChannels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (codec.numChannels !== 1 ? '/' + codec.numChannels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      params.push(param + '=' + codec.parameters[param]);\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n}\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  caps.headerExtensions.forEach(function(extension) {\n    sdp += SDPUtils.writeExtmap(extension);\n  });\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.split(' ');\n    parts.shift();\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n        rtx: {\n          ssrc: secondarySsrc\n        }\n      };\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: secondarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  var cname;\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=thisisadapterortc ' + sessionId + ' ' + version + ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return {\n    kind: mline[0].substr(2),\n    port: parseInt(mline[1], 10),\n    protocol: mline[2],\n    fmt: mline.slice(3).join(' ')\n  };\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all fieldѕ are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\n// https://w3c.github.io/mediacapture-main/#mediastream\n// Helper function to add the track to the stream and\n// dispatch the event ourselves.\nfunction addTrackToStreamAndFireEvent(track, stream) {\n  stream.addTrack(track);\n  var e = new Event('addtrack'); // TODO: MediaStreamTrackEvent\n  e.track = track;\n  stream.dispatchEvent(e);\n}\n\nfunction removeTrackFromStreamAndFireEvent(track, stream) {\n  stream.removeTrack(track);\n  var e = new Event('removetrack'); // TODO: MediaStreamTrackEvent\n  e.track = track;\n  stream.dispatchEvent(e);\n}\n\nmodule.exports = function(window, edgeVersion) {\n  var RTCPeerConnection = function(config) {\n    var self = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          self[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.onicecandidate = null;\n    this.onaddstream = null;\n    this.ontrack = null;\n    this.onremovestream = null;\n    this.onsignalingstatechange = null;\n    this.oniceconnectionstatechange = null;\n    this.onicegatheringstatechange = null;\n    this.onnegotiationneeded = null;\n    this.ondatachannel = null;\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this.localDescription = null;\n    this.remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      var e = new Error('rtcpMuxPolicy \\'negotiate\\' is not supported');\n      e.name = 'NotSupportedError';\n      throw(e);\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers = new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        });\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this.dispatchEvent(event);\n    if (typeof this.onicegatheringstatechange === 'function') {\n      this.onicegatheringstatechange(event);\n    }\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (whih is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    this.transceivers.push(transceiver);\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var self = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        self.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        self.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      var err = new Error('Sender was not created by this connection.');\n      err.name = 'InvalidAccessError';\n      throw err;\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var self = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = self.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        self.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var self = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].candidates = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (self.transceivers[sdpMLineIndex].candidates !== null) {\n        self.transceivers[sdpMLineIndex].candidates.push(event.candidate);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var self = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var candidates = this.transceivers[sdpMLineIndex].candidates;\n    this.transceivers[sdpMLineIndex].candidates = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (self.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // ѕdpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        event.candidate.candidate = SDPUtils.writeCandidate(cand);\n      }\n\n      // update local description.\n      var sections = SDPUtils.splitSections(self.localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      self.localDescription.sdp = sections.join('');\n      var complete = self.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (self.iceGatheringState !== 'gathering') {\n        self.iceGatheringState = 'gathering';\n        self._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        self.dispatchEvent(event);\n        if (typeof self.onicecandidate === 'function') {\n          self.onicecandidate(event);\n        }\n      }\n      if (complete) {\n        self.dispatchEvent(new Event('icecandidate'));\n        if (typeof self.onicecandidate === 'function') {\n          self.onicecandidate(new Event('icecandidate'));\n        }\n        self.iceGatheringState = 'complete';\n        self._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      candidates.forEach(function(candidate) {\n        var e = new Event('RTCIceGatherEvent');\n        e.candidate = candidate;\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var self = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      self._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      self._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      self._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var self = this;\n    var args = arguments;\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, this.signalingState)) {\n      return new Promise(function(resolve, reject) {\n        var e = new Error('Can not set local ' + description.type +\n            ' in state ' + self.signalingState);\n        e.name = 'InvalidStateError';\n        if (args.length > 2 && typeof args[2] === 'function') {\n          args[2].apply(null, [e]);\n        }\n        reject(e);\n      });\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        self.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      this.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        self._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(self.remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = self.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            !SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 1;\n\n        if (!rejected && !transceiver.isDatachannel) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!self.usingBundle || sdpMLineIndex === 0) {\n            self._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          self._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    this.localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    switch (description.type) {\n      case 'offer':\n        this._updateSignalingState('have-local-offer');\n        break;\n      case 'answer':\n        this._updateSignalingState('stable');\n        break;\n      default:\n        throw new TypeError('unsupported type \"' + description.type +\n            '\"');\n    }\n\n    // If a success callback was provided, emit ICE candidates after it\n    // has been executed. Otherwise, emit callback after the Promise is\n    // resolved.\n    var cb = arguments.length > 1 && typeof arguments[1] === 'function' &&\n        arguments[1];\n    return new Promise(function(resolve) {\n      if (cb) {\n        cb.apply(null);\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var self = this;\n    var args = arguments;\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, this.signalingState)) {\n      return new Promise(function(resolve, reject) {\n        var e = new Error('Can not set remote ' + description.type +\n            ' in state ' + self.signalingState);\n        e.name = 'InvalidStateError';\n        if (args.length > 2 && typeof args[2] === 'function') {\n          args[2].apply(null, [e]);\n        }\n        reject(e);\n      });\n    }\n\n    var streams = {};\n    this.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    this.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      this.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      this.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          !SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 1;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (kind === 'application' && protocol === 'DTLS/SCTP') {\n        self.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          isDatachannel: true\n        };\n        return;\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          self.transceivers[sdpMLineIndex]) {\n        self._disposeIceAndDtlsTransports(sdpMLineIndex);\n        self.transceivers[sdpMLineIndex].iceGatherer =\n            self.transceivers[0].iceGatherer;\n        self.transceivers[sdpMLineIndex].iceTransport =\n            self.transceivers[0].iceTransport;\n        self.transceivers[sdpMLineIndex].dtlsTransport =\n            self.transceivers[0].dtlsTransport;\n        if (self.transceivers[sdpMLineIndex].rtpSender) {\n          self.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              self.transceivers[0].dtlsTransport);\n        }\n        if (self.transceivers[sdpMLineIndex].rtpReceiver) {\n          self.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              self.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = self.transceivers[sdpMLineIndex] ||\n            self._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = self._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            addTrackToStreamAndFireEvent(track, stream);\n            receiverList.push([track, rtpReceiver, stream]);\n            transceiver.associatedRemoteMediaStreams.push(stream);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        self._transceive(self.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = self.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        self.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        self.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        self.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        self._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (this._dtlsRole === undefined) {\n      this._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    this.remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    switch (description.type) {\n      case 'offer':\n        this._updateSignalingState('have-remote-offer');\n        break;\n      case 'answer':\n        this._updateSignalingState('stable');\n        break;\n      default:\n        throw new TypeError('unsupported type \"' + description.type +\n            '\"');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (self.remoteStreams.indexOf(stream) === -1) {\n          self.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            self.dispatchEvent(event);\n            if (typeof self.onaddstream === 'function') {\n              self.onaddstream(event);\n            }\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          var trackEvent = new Event('track');\n          trackEvent.track = track;\n          trackEvent.receiver = receiver;\n          trackEvent.transceiver = {receiver: receiver};\n          trackEvent.streams = [stream];\n          window.setTimeout(function() {\n            self.dispatchEvent(trackEvent);\n            if (typeof self.ontrack === 'function') {\n              self.ontrack(trackEvent);\n            }\n          });\n        });\n      }\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(self && self.transceivers)) {\n        return;\n      }\n      self.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return new Promise(function(resolve) {\n      if (args.length > 1 && typeof args[1] === 'function') {\n        args[1].apply(null);\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this.dispatchEvent(event);\n    if (typeof this.onsignalingstatechange === 'function') {\n      this.onsignalingstatechange(event);\n    }\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var self = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (self.needNegotiation === false) {\n        return;\n      }\n      self.needNegotiation = false;\n      var event = new Event('negotiationneeded');\n      self.dispatchEvent(event);\n      if (typeof self.onnegotiationneeded === 'function') {\n        self.onnegotiationneeded(event);\n      }\n    }, 0);\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      states[transceiver.iceTransport.state]++;\n      states[transceiver.dtlsTransport.state]++;\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0 || states.checking > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0 || states.completed > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this.dispatchEvent(event);\n      if (typeof this.oniceconnectionstatechange === 'function') {\n        this.oniceconnectionstatechange(event);\n      }\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var self = this;\n    var args = arguments;\n\n    var offerOptions;\n    if (arguments.length === 1 && typeof arguments[0] !== 'function') {\n      offerOptions = arguments[0];\n    } else if (arguments.length === 3) {\n      offerOptions = arguments[2];\n    }\n\n    var numAudioTracks = this.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = this.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        this._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        this._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(this._sdpSessionId,\n        this._sdpSessionVersion++);\n    this.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = self._createIceGatherer(sdpMLineIndex,\n            self.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (this._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + this.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    this.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, self._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && self.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !self.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return new Promise(function(resolve) {\n      if (args.length > 0 && typeof args[0] === 'function') {\n        args[0].apply(null, [desc]);\n        resolve();\n        return;\n      }\n      resolve(desc);\n    });\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var self = this;\n    var args = arguments;\n\n    var sdp = SDPUtils.writeSessionBoilerplate(this._sdpSessionId,\n        this._sdpSessionVersion++);\n    if (this.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + this.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    var mediaSectionsInOffer = SDPUtils.splitSections(\n        this.remoteDescription.sdp).length - 1;\n    this.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.isDatachannel) {\n        sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n' +\n            'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, self._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return new Promise(function(resolve) {\n      if (args.length > 0 && typeof args[0] === 'function') {\n        args[0].apply(null, [desc]);\n        resolve();\n        return;\n      }\n      resolve(desc);\n    });\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var err;\n    var sections;\n    if (!candidate || candidate.candidate === '') {\n      for (var j = 0; j < this.transceivers.length; j++) {\n        if (this.transceivers[j].isDatachannel) {\n          continue;\n        }\n        this.transceivers[j].iceTransport.addRemoteCandidate({});\n        sections = SDPUtils.splitSections(this.remoteDescription.sdp);\n        sections[j + 1] += 'a=end-of-candidates\\r\\n';\n        this.remoteDescription.sdp = sections.join('');\n        if (this.usingBundle) {\n          break;\n        }\n      }\n    } else if (!(candidate.sdpMLineIndex !== undefined || candidate.sdpMid)) {\n      throw new TypeError('sdpMLineIndex or sdpMid required');\n    } else if (!this.remoteDescription) {\n      err = new Error('Can not add ICE candidate without ' +\n          'a remote description');\n      err.name = 'InvalidStateError';\n    } else {\n      var sdpMLineIndex = candidate.sdpMLineIndex;\n      if (candidate.sdpMid) {\n        for (var i = 0; i < this.transceivers.length; i++) {\n          if (this.transceivers[i].mid === candidate.sdpMid) {\n            sdpMLineIndex = i;\n            break;\n          }\n        }\n      }\n      var transceiver = this.transceivers[sdpMLineIndex];\n      if (transceiver) {\n        if (transceiver.isDatachannel) {\n          return Promise.resolve();\n        }\n        var cand = Object.keys(candidate.candidate).length > 0 ?\n            SDPUtils.parseCandidate(candidate.candidate) : {};\n        // Ignore Chrome's invalid candidates since Edge does not like them.\n        if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n          return Promise.resolve();\n        }\n        // Ignore RTCP candidates, we assume RTCP-MUX.\n        if (cand.component && cand.component !== 1) {\n          return Promise.resolve();\n        }\n        // when using bundle, avoid adding candidates to the wrong\n        // ice transport. And avoid adding candidates added in the SDP.\n        if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n            transceiver.iceTransport !== this.transceivers[0].iceTransport)) {\n          if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n            err = new Error('Can not add ICE candidate');\n            err.name = 'OperationError';\n          }\n        }\n\n        if (!err) {\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.splitSections(this.remoteDescription.sdp);\n          sections[sdpMLineIndex + 1] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          this.remoteDescription.sdp = sections.join('');\n        }\n      } else {\n        err = new Error('Can not add ICE candidate');\n        err.name = 'OperationError';\n      }\n    }\n    var args = arguments;\n    return new Promise(function(resolve, reject) {\n      if (err) {\n        if (args.length > 2 && typeof args[2] === 'function') {\n          args[2].apply(null, [err]);\n        }\n        reject(err);\n      } else {\n        if (args.length > 1 && typeof args[1] === 'function') {\n          args[1].apply(null);\n        }\n        resolve();\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function() {\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    var cb = arguments.length > 1 && typeof arguments[1] === 'function' &&\n        arguments[1];\n    var fixStatsType = function(stat) {\n      return {\n        inboundrtp: 'inbound-rtp',\n        outboundrtp: 'outbound-rtp',\n        candidatepair: 'candidate-pair',\n        localcandidate: 'local-candidate',\n        remotecandidate: 'remote-candidate'\n      }[stat.type] || stat.type;\n    };\n    return new Promise(function(resolve) {\n      // shim getStats with maplike support\n      var results = new Map();\n      Promise.all(promises).then(function(res) {\n        res.forEach(function(result) {\n          Object.keys(result).forEach(function(id) {\n            result[id].type = fixStatsType(result[id]);\n            results.set(id, result[id]);\n          });\n        });\n        if (cb) {\n          cb.apply(null, results);\n        }\n        resolve(results);\n      });\n    });\n  };\n  return RTCPeerConnection;\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\n// Expose public methods.\nmodule.exports = function(window) {\n  var navigator = window && window.navigator;\n\n  var shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(function(e) {\n      return Promise.reject(shimError_(e));\n    });\n  };\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\nvar shimRTCPeerConnection = require('rtcpeerconnection-shim');\n\nmodule.exports = {\n  shimGetUserMedia: require('./getusermedia'),\n  shimPeerConnection: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n\n    if (window.RTCIceGatherer) {\n      // ORTC defines an RTCIceCandidate object but no constructor.\n      // Not implemented in Edge.\n      if (!window.RTCIceCandidate) {\n        window.RTCIceCandidate = function(args) {\n          return args;\n        };\n      }\n      // ORTC does not have a session description object but\n      // other browsers (i.e. Chrome) that will support both PC and ORTC\n      // in the future might have this defined already.\n      if (!window.RTCSessionDescription) {\n        window.RTCSessionDescription = function(args) {\n          return args;\n        };\n      }\n      // this adds an additional event listener to MediaStrackTrack that signals\n      // when a tracks enabled property was changed. Workaround for a bug in\n      // addStream, see below. No longer required in 15025+\n      if (browserDetails.version < 15025) {\n        var origMSTEnabled = Object.getOwnPropertyDescriptor(\n            window.MediaStreamTrack.prototype, 'enabled');\n        Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n          set: function(value) {\n            origMSTEnabled.set.call(this, value);\n            var ev = new Event('enabled');\n            ev.enabled = value;\n            this.dispatchEvent(ev);\n          }\n        });\n      }\n    }\n\n    // ORTC defines the DTMF sender a bit different.\n    // https://github.com/w3c/ortc/issues/714\n    if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n        get: function() {\n          if (this._dtmf === undefined) {\n            if (this.track.kind === 'audio') {\n              this._dtmf = new window.RTCDtmfSender(this);\n            } else if (this.track.kind === 'video') {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        }\n      });\n    }\n\n    window.RTCPeerConnection =\n        shimRTCPeerConnection(window, browserDetails.version);\n  },\n  shimReplaceTrack: function(window) {\n    // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n    if (window.RTCRtpSender &&\n        !('replaceTrack' in window.RTCRtpSender.prototype)) {\n      window.RTCRtpSender.prototype.replaceTrack =\n          window.RTCRtpSender.prototype.setTrack;\n    }\n  }\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\nvar logging = utils.log;\n\n// Expose public methods.\nmodule.exports = function(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n  var MediaStreamTrack = window && window.MediaStreamTrack;\n\n  var shimError_ = function(e) {\n    return {\n      name: {\n        InternalError: 'NotReadableError',\n        NotSupportedError: 'TypeError',\n        PermissionDeniedError: 'NotAllowedError',\n        SecurityError: 'NotAllowedError'\n      }[e.name] || e.name,\n      message: {\n        'The operation is insecure.': 'The request is not allowed by the ' +\n        'user agent or the platform in the current context.'\n      }[e.message] || e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  // getUserMedia constraints shim.\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    var constraintsToFF37_ = function(c) {\n      if (typeof c !== 'object' || c.require) {\n        return c;\n      }\n      var require = [];\n      Object.keys(c).forEach(function(key) {\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n          return;\n        }\n        var r = c[key] = (typeof c[key] === 'object') ?\n            c[key] : {ideal: c[key]};\n        if (r.min !== undefined ||\n            r.max !== undefined || r.exact !== undefined) {\n          require.push(key);\n        }\n        if (r.exact !== undefined) {\n          if (typeof r.exact === 'number') {\n            r. min = r.max = r.exact;\n          } else {\n            c[key] = r.exact;\n          }\n          delete r.exact;\n        }\n        if (r.ideal !== undefined) {\n          c.advanced = c.advanced || [];\n          var oc = {};\n          if (typeof r.ideal === 'number') {\n            oc[key] = {min: r.ideal, max: r.ideal};\n          } else {\n            oc[key] = r.ideal;\n          }\n          c.advanced.push(oc);\n          delete r.ideal;\n          if (!Object.keys(r).length) {\n            delete c[key];\n          }\n        }\n      });\n      if (require.length) {\n        c.require = require;\n      }\n      return c;\n    };\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (browserDetails.version < 38) {\n      logging('spec: ' + JSON.stringify(constraints));\n      if (constraints.audio) {\n        constraints.audio = constraintsToFF37_(constraints.audio);\n      }\n      if (constraints.video) {\n        constraints.video = constraintsToFF37_(constraints.video);\n      }\n      logging('ff37: ' + JSON.stringify(constraints));\n    }\n    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\n      onError(shimError_(e));\n    });\n  };\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      getUserMedia_(constraints, resolve, reject);\n    });\n  };\n\n  // Shim for mediaDevices on older versions.\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\n      addEventListener: function() { },\n      removeEventListener: function() { }\n    };\n  }\n  navigator.mediaDevices.enumerateDevices =\n      navigator.mediaDevices.enumerateDevices || function() {\n        return new Promise(function(resolve) {\n          var infos = [\n            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\n            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\n          ];\n          resolve(infos);\n        });\n      };\n\n  if (browserDetails.version < 41) {\n    // Work around http://bugzil.la/1169665\n    var orgEnumerateDevices =\n        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\n    navigator.mediaDevices.enumerateDevices = function() {\n      return orgEnumerateDevices().then(undefined, function(e) {\n        if (e.name === 'NotFoundError') {\n          return [];\n        }\n        throw e;\n      });\n    };\n  }\n  if (browserDetails.version < 49) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      return origGetUserMedia(c).then(function(stream) {\n        // Work around https://bugzil.la/802326\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(function(track) {\n            track.stop();\n          });\n          throw new DOMException('The object can not be found here.',\n                                 'NotFoundError');\n        }\n        return stream;\n      }, function(e) {\n        return Promise.reject(shimError_(e));\n      });\n    };\n  }\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    var remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        var obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    if (browserDetails.version < 44) {\n      return getUserMedia_(constraints, onSuccess, onError);\n    }\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n        'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\n\nvar firefoxShim = {\n  shimOnTrack: function(window) {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            e.stream.getTracks().forEach(function(track) {\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = {track: track};\n              event.transceiver = {receiver: event.receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        }\n      });\n    }\n    if (typeof window === 'object' && window.RTCTrackEvent &&\n        ('receiver' in window.RTCTrackEvent.prototype) &&\n        !('transceiver' in window.RTCTrackEvent.prototype)) {\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n        get: function() {\n          return {receiver: this.receiver};\n        }\n      });\n    }\n  },\n\n  shimSourceObject: function(window) {\n    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this.mozSrcObject;\n          },\n          set: function(stream) {\n            this.mozSrcObject = stream;\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n\n    if (typeof window !== 'object' || !(window.RTCPeerConnection ||\n        window.mozRTCPeerConnection)) {\n      return; // probably media.peerconnection.enabled=false in about:config\n    }\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (browserDetails.version < 38) {\n          // .urls is not supported in FF < 38.\n          // create RTCIceServers with a single url.\n          if (pcConfig && pcConfig.iceServers) {\n            var newIceServers = [];\n            for (var i = 0; i < pcConfig.iceServers.length; i++) {\n              var server = pcConfig.iceServers[i];\n              if (server.hasOwnProperty('urls')) {\n                for (var j = 0; j < server.urls.length; j++) {\n                  var newServer = {\n                    url: server.urls[j]\n                  };\n                  if (server.urls[j].indexOf('turn') === 0) {\n                    newServer.username = server.username;\n                    newServer.credential = server.credential;\n                  }\n                  newIceServers.push(newServer);\n                }\n              } else {\n                newIceServers.push(pcConfig.iceServers[i]);\n              }\n            }\n            pcConfig.iceServers = newIceServers;\n          }\n        }\n        return new window.mozRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype =\n          window.mozRTCPeerConnection.prototype;\n\n      // wrap static methods. Currently just generateCertificate.\n      if (window.mozRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return window.mozRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n\n      window.RTCSessionDescription = window.mozRTCSessionDescription;\n      window.RTCIceCandidate = window.mozRTCIceCandidate;\n    }\n\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = window.RTCPeerConnection.prototype[method];\n          window.RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        window.RTCPeerConnection.prototype.addIceCandidate;\n    window.RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function(stats) {\n      var map = new Map();\n      Object.keys(stats).forEach(function(key) {\n        map.set(key, stats[key]);\n        map[key] = stats[key];\n      });\n      return map;\n    };\n\n    var modernStatsTypes = {\n      inboundrtp: 'inbound-rtp',\n      outboundrtp: 'outbound-rtp',\n      candidatepair: 'candidate-pair',\n      localcandidate: 'local-candidate',\n      remotecandidate: 'remote-candidate'\n    };\n\n    var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function(\n      selector,\n      onSucc,\n      onErr\n    ) {\n      return nativeGetStats.apply(this, [selector || null])\n        .then(function(stats) {\n          if (browserDetails.version < 48) {\n            stats = makeMapStats(stats);\n          }\n          if (browserDetails.version < 53 && !onSucc) {\n            // Shim only promise getStats with spec-hyphens in type names\n            // Leave callback version alone; misc old uses of forEach before Map\n            try {\n              stats.forEach(function(stat) {\n                stat.type = modernStatsTypes[stat.type] || stat.type;\n              });\n            } catch (e) {\n              if (e.name !== 'TypeError') {\n                throw e;\n              }\n              // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n              stats.forEach(function(stat, i) {\n                stats.set(i, Object.assign({}, stat, {\n                  type: modernStatsTypes[stat.type] || stat.type\n                }));\n              });\n            }\n          }\n          return stats;\n        })\n        .then(onSucc, onErr);\n    };\n  },\n\n  shimRemoveStream: function(window) {\n    if ('removeStream' in window.RTCPeerConnection.prototype) {\n      return;\n    }\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      var pc = this;\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(function(sender) {\n        if (sender.track && stream.getTracks().indexOf(sender.track) !== -1) {\n          pc.removeTrack(sender);\n        }\n      });\n    };\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimOnTrack: firefoxShim.shimOnTrack,\n  shimSourceObject: firefoxShim.shimSourceObject,\n  shimPeerConnection: firefoxShim.shimPeerConnection,\n  shimRemoveStream: firefoxShim.shimRemoveStream,\n  shimGetUserMedia: require('./getusermedia')\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nvar utils = require('../utils');\n\nvar safariShim = {\n  // TODO: DrAlex, should be here, double check against LayoutTests\n\n  // TODO: once the back-end for the mac port is done, add.\n  // TODO: check for webkitGTK+\n  // shimPeerConnection: function() { },\n\n  shimLocalStreamsAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getLocalStreams = function() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n    }\n    if (!('getStreamById' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getStreamById = function(id) {\n        var result = null;\n        if (this._localStreams) {\n          this._localStreams.forEach(function(stream) {\n            if (stream.id === id) {\n              result = stream;\n            }\n          });\n        }\n        if (this._remoteStreams) {\n          this._remoteStreams.forEach(function(stream) {\n            if (stream.id === id) {\n              result = stream;\n            }\n          });\n        }\n        return result;\n      };\n    }\n    if (!('addStream' in window.RTCPeerConnection.prototype)) {\n      var _addTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        if (this._localStreams.indexOf(stream) === -1) {\n          this._localStreams.push(stream);\n        }\n        var self = this;\n        stream.getTracks().forEach(function(track) {\n          _addTrack.call(self, track, stream);\n        });\n      };\n\n      window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n        if (stream) {\n          if (!this._localStreams) {\n            this._localStreams = [stream];\n          } else if (this._localStreams.indexOf(stream) === -1) {\n            this._localStreams.push(stream);\n          }\n        }\n        _addTrack.call(this, track, stream);\n      };\n    }\n    if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        var index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        var self = this;\n        var tracks = stream.getTracks();\n        this.getSenders().forEach(function(sender) {\n          if (tracks.indexOf(sender.track) !== -1) {\n            self.removeTrack(sender);\n          }\n        });\n      };\n    }\n  },\n  shimRemoteStreamsAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getRemoteStreams = function() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n    }\n    if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n        get: function() {\n          return this._onaddstream;\n        },\n        set: function(f) {\n          if (this._onaddstream) {\n            this.removeEventListener('addstream', this._onaddstream);\n            this.removeEventListener('track', this._onaddstreampoly);\n          }\n          this.addEventListener('addstream', this._onaddstream = f);\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            var stream = e.streams[0];\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.indexOf(stream) >= 0) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = e.streams[0];\n            this.dispatchEvent(event);\n          }.bind(this));\n        }\n      });\n    }\n  },\n  shimCallbacksAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    var prototype = window.RTCPeerConnection.prototype;\n    var createOffer = prototype.createOffer;\n    var createAnswer = prototype.createAnswer;\n    var setLocalDescription = prototype.setLocalDescription;\n    var setRemoteDescription = prototype.setRemoteDescription;\n    var addIceCandidate = prototype.addIceCandidate;\n\n    prototype.createOffer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    prototype.createAnswer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    var withCallback = function(description, successCallback, failureCallback) {\n      var promise = setLocalDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setLocalDescription = withCallback;\n\n    withCallback = function(description, successCallback, failureCallback) {\n      var promise = setRemoteDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setRemoteDescription = withCallback;\n\n    withCallback = function(candidate, successCallback, failureCallback) {\n      var promise = addIceCandidate.apply(this, [candidate]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.addIceCandidate = withCallback;\n  },\n  shimGetUserMedia: function(window) {\n    var navigator = window && window.navigator;\n\n    if (!navigator.getUserMedia) {\n      if (navigator.webkitGetUserMedia) {\n        navigator.getUserMedia = navigator.webkitGetUserMedia.bind(navigator);\n      } else if (navigator.mediaDevices &&\n          navigator.mediaDevices.getUserMedia) {\n        navigator.getUserMedia = function(constraints, cb, errcb) {\n          navigator.mediaDevices.getUserMedia(constraints)\n          .then(cb, errcb);\n        }.bind(navigator);\n      }\n    }\n  },\n  shimRTCIceServerUrls: function(window) {\n    // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n    var OrigPeerConnection = window.RTCPeerConnection;\n    window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        var newIceServers = [];\n        for (var i = 0; i < pcConfig.iceServers.length; i++) {\n          var server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') &&\n              server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n    window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n    // wrap static methods. Currently just generateCertificate.\n    if ('generateCertificate' in window.RTCPeerConnection) {\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n        get: function() {\n          return OrigPeerConnection.generateCertificate;\n        }\n      });\n    }\n  },\n  shimTrackEventTransceiver: function(window) {\n    // Add event.transceiver member over deprecated event.receiver\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        ('receiver' in window.RTCTrackEvent.prototype) &&\n        // can't check 'transceiver' in window.RTCTrackEvent.prototype, as it is\n        // defined for some reason even when window.RTCTransceiver is not.\n        !window.RTCTransceiver) {\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n        get: function() {\n          return {receiver: this.receiver};\n        }\n      });\n    }\n  },\n\n  shimCreateOfferLegacy: function(window) {\n    var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n    window.RTCPeerConnection.prototype.createOffer = function(offerOptions) {\n      var pc = this;\n      if (offerOptions) {\n        var audioTransceiver = pc.getTransceivers().find(function(transceiver) {\n          return transceiver.sender.track &&\n              transceiver.sender.track.kind === 'audio';\n        });\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            audioTransceiver.setDirection('sendonly');\n          } else if (audioTransceiver.direction === 'recvonly') {\n            audioTransceiver.setDirection('inactive');\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          pc.addTransceiver('audio');\n        }\n\n        var videoTransceiver = pc.getTransceivers().find(function(transceiver) {\n          return transceiver.sender.track &&\n              transceiver.sender.track.kind === 'video';\n        });\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            videoTransceiver.setDirection('sendonly');\n          } else if (videoTransceiver.direction === 'recvonly') {\n            videoTransceiver.setDirection('inactive');\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          pc.addTransceiver('video');\n        }\n      }\n      return origCreateOffer.apply(pc, arguments);\n    };\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimCallbacksAPI: safariShim.shimCallbacksAPI,\n  shimLocalStreamsAPI: safariShim.shimLocalStreamsAPI,\n  shimRemoteStreamsAPI: safariShim.shimRemoteStreamsAPI,\n  shimGetUserMedia: safariShim.shimGetUserMedia,\n  shimRTCIceServerUrls: safariShim.shimRTCIceServerUrls,\n  shimTrackEventTransceiver: safariShim.shimTrackEventTransceiver,\n  shimCreateOfferLegacy: safariShim.shimCreateOfferLegacy\n  // TODO\n  // shimPeerConnection: safariShim.shimPeerConnection\n};\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\nvar utils = require('./utils');\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object.\nfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  var nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    var wrappedCallback = function(e) {\n      cb(wrapper(e));\n    };\n    this._eventMap = this._eventMap || {};\n    this._eventMap[cb] = wrappedCallback;\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  var nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[cb]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    var unwrappedCb = this._eventMap[cb];\n    delete this._eventMap[cb];\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get: function() {\n      return this['_on' + eventNameToWrap];\n    },\n    set: function(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap] = cb);\n      }\n    }\n  });\n}\n\nmodule.exports = {\n  shimRTCIceCandidate: function(window) {\n    // foundation is arbitrarily chosen as an indicator for full support for\n    // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n    if (window.RTCIceCandidate && 'foundation' in\n        window.RTCIceCandidate.prototype) {\n      return;\n    }\n\n    var NativeRTCIceCandidate = window.RTCIceCandidate;\n    window.RTCIceCandidate = function(args) {\n      // Remove the a= which shouldn't be part of the candidate string.\n      if (typeof args === 'object' && args.candidate &&\n          args.candidate.indexOf('a=') === 0) {\n        args = JSON.parse(JSON.stringify(args));\n        args.candidate = args.candidate.substr(2);\n      }\n\n      // Augment the native candidate with the parsed fields.\n      var nativeCandidate = new NativeRTCIceCandidate(args);\n      var parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      var augmentedCandidate = Object.assign(nativeCandidate,\n          parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment,\n        };\n      };\n      return augmentedCandidate;\n    };\n\n    // Hook up the augmented candidate in onicecandidate and\n    // addEventListener('icecandidate', ...)\n    wrapPeerConnectionEvent(window, 'icecandidate', function(e) {\n      if (e.candidate) {\n        Object.defineProperty(e, 'candidate', {\n          value: new window.RTCIceCandidate(e.candidate),\n          writable: 'false'\n        });\n      }\n      return e;\n    });\n  },\n\n  // shimCreateObjectURL must be called before shimSourceObject to avoid loop.\n\n  shimCreateObjectURL: function(window) {\n    var URL = window && window.URL;\n\n    if (!(typeof window === 'object' && window.HTMLMediaElement &&\n          'srcObject' in window.HTMLMediaElement.prototype &&\n        URL.createObjectURL && URL.revokeObjectURL)) {\n      // Only shim CreateObjectURL using srcObject if srcObject exists.\n      return undefined;\n    }\n\n    var nativeCreateObjectURL = URL.createObjectURL.bind(URL);\n    var nativeRevokeObjectURL = URL.revokeObjectURL.bind(URL);\n    var streams = new Map(), newId = 0;\n\n    URL.createObjectURL = function(stream) {\n      if ('getTracks' in stream) {\n        var url = 'polyblob:' + (++newId);\n        streams.set(url, stream);\n        utils.deprecated('URL.createObjectURL(stream)',\n            'elem.srcObject = stream');\n        return url;\n      }\n      return nativeCreateObjectURL(stream);\n    };\n    URL.revokeObjectURL = function(url) {\n      nativeRevokeObjectURL(url);\n      streams.delete(url);\n    };\n\n    var dsc = Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,\n                                              'src');\n    Object.defineProperty(window.HTMLMediaElement.prototype, 'src', {\n      get: function() {\n        return dsc.get.apply(this);\n      },\n      set: function(url) {\n        this.srcObject = streams.get(url) || null;\n        return dsc.set.apply(this, [url]);\n      }\n    });\n\n    var nativeSetAttribute = window.HTMLMediaElement.prototype.setAttribute;\n    window.HTMLMediaElement.prototype.setAttribute = function() {\n      if (arguments.length === 2 &&\n          ('' + arguments[0]).toLowerCase() === 'src') {\n        this.srcObject = streams.get(arguments[1]) || null;\n      }\n      return nativeSetAttribute.apply(this, arguments);\n    };\n  }\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n'use strict';\n\nvar utils = require('./utils');\n// Shimming starts here.\nmodule.exports = function(dependencies, opts) {\n  var window = dependencies && dependencies.window;\n\n  var options = {\n    shimChrome: true,\n    shimFirefox: true,\n    shimEdge: true,\n    shimSafari: true,\n  };\n\n  for (var key in opts) {\n    if (hasOwnProperty.call(opts, key)) {\n      options[key] = opts[key];\n    }\n  }\n\n  // Utils.\n  var logging = utils.log;\n  var browserDetails = utils.detectBrowser(window);\n\n  // Export to the adapter global object visible in the browser.\n  var adapter = {\n    browserDetails: browserDetails,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Uncomment the line below if you want logging to occur, including logging\n  // for the switch statement below. Can also be turned on in the browser via\n  // adapter.disableLog(false), but then logging from the switch statement below\n  // will not appear.\n  // require('./utils').disableLog(false);\n\n  // Browser shims.\n  var chromeShim = require('./chrome/chrome_shim') || null;\n  var edgeShim = require('./edge/edge_shim') || null;\n  var firefoxShim = require('./firefox/firefox_shim') || null;\n  var safariShim = require('./safari/safari_shim') || null;\n  var commonShim = require('./common_shim') || null;\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n      commonShim.shimCreateObjectURL(window);\n\n      chromeShim.shimGetUserMedia(window);\n      chromeShim.shimMediaStream(window);\n      chromeShim.shimSourceObject(window);\n      chromeShim.shimPeerConnection(window);\n      chromeShim.shimOnTrack(window);\n      chromeShim.shimAddTrackRemoveTrack(window);\n      chromeShim.shimGetSendersWithDtmf(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n      commonShim.shimCreateObjectURL(window);\n\n      firefoxShim.shimGetUserMedia(window);\n      firefoxShim.shimSourceObject(window);\n      firefoxShim.shimPeerConnection(window);\n      firefoxShim.shimOnTrack(window);\n      firefoxShim.shimRemoveStream(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n      commonShim.shimCreateObjectURL(window);\n\n      edgeShim.shimGetUserMedia(window);\n      edgeShim.shimPeerConnection(window);\n      edgeShim.shimReplaceTrack(window);\n\n      // the edge shim implements the full RTCIceCandidate object.\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n      commonShim.shimCreateObjectURL(window);\n\n      safariShim.shimRTCIceServerUrls(window);\n      safariShim.shimCallbacksAPI(window);\n      safariShim.shimLocalStreamsAPI(window);\n      safariShim.shimRemoteStreamsAPI(window);\n      safariShim.shimTrackEventTransceiver(window);\n      safariShim.shimGetUserMedia(window);\n      safariShim.shimCreateOfferLegacy(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n'use strict';\n\nvar adapterFactory = require('./adapter_factory.js');\nmodule.exports = adapterFactory({window: global.window});\n","export default class EventTarget {\n  constructor() {\n    this.listeners = {};\n  }\n\n  addEventListener(type, callback) {\n    if (!(type in this.listeners)) {\n      this.listeners[type] = [];\n    }\n    this.listeners[type].push(callback);\n  }\n\n  removeEventListener(type, callback) {\n    if (!(type in this.listeners)) return;\n\n    const stack = this.listeners[type];\n    for (let i = 0, l = stack.length; i < l; i += 1) {\n      if (stack[i] === callback) {\n        stack.splice(i, 1);\n        return;\n      }\n    }\n  }\n\n  dispatchEvent(event) {\n    if (!(event.type in this.listeners)) return true;\n\n    const stack = this.listeners[event.type];\n    for (let i = 0, l = stack.length; i < l; i += 1) {\n      stack[i].call(this, event);\n    }\n    return !event.defaultPrevented;\n  }\n\n  on(type, callback) {\n    return this.addEventListener(type, callback);\n  }\n}\n","import 'webrtc-adapter';\n\nimport EventTarget from './EventTarget';\n\nexport default class DataChannel extends EventTarget {\n  constructor() {\n    super();\n\n    this.peers = {};\n\n    this.newPeer = {\n      connection: null,\n      channel: null,\n      data: null,\n    };\n\n    this.RTCPeerConnectionOptions = { iceServers: [{ urls: ['stun:stun.l.google.com:19302'] }] };\n    this.RTCDataChannelOptions = { ordered: false, maxPacketLifeTime: 1000 };\n\n    this.signalingServer = io.connect('/');\n\n    this.bindClassMethods();\n    this.setEventListeners();\n  }\n\n  bindClassMethods() {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const method in this) {\n      if (typeof this[method] === 'function') {\n        this[method] = this[method].bind(this);\n      }\n    }\n  }\n\n  setEventListeners() {\n    this.signalingServer.on('connect', this.onConnection);\n    this.signalingServer.on('peerIce', this.onPeerIce);\n    this.signalingServer.on('peerAnswer', this.onPeerAnswer);\n    this.signalingServer.on('peerOffer', this.onPeerOffer);\n    this.signalingServer.on('peerWantsACall', this.onPeerWantsACall);\n    this.signalingServer.on('peerUpdate', this.onPeerUpdate);\n    this.signalingServer.on('peerDisconnect', this.onPeerDisconnect);\n    this.signalingServer.on('signalingServerMessage', this.onSignalingServerMessage);\n  }\n\n  sendMessage(label, ...input) {\n    const data = input.length === 1 ? input[0] : input;\n    const peerKeys = Object.keys(this.peers);\n\n    peerKeys.forEach((peerId) => {\n      if (!this.peers[peerId].channel) return;\n      if (this.peers[peerId].channel.readyState !== 'open') return;\n\n      const message = JSON.stringify({ label, data });\n      this.peers[peerId].channel.send(message);\n    });\n  }\n\n  onConnection() {\n    console.log(this.signalingServer.id);\n  }\n\n  onPeerIce(peerId, RTCIceCandidate) {\n    if (!RTCIceCandidate.candidate) return;\n    if (!this.peers[peerId]) return;\n\n    this.peers[peerId].connection.addIceCandidate(RTCIceCandidate);\n  }\n\n  onPeerAnswer(peerId, RemoteRTCSessionDescription) {\n    if (!this.peers[peerId]) return;\n\n    this.peers[peerId].connection.setRemoteDescription(RemoteRTCSessionDescription);\n  }\n\n  onPeerOffer(peerId, RemoteRTCSessionDescription) {\n    if (this.peers[peerId]) return;\n\n    this.peers[peerId] = { ...this.newPeer };\n    const Peer = this.peers[peerId];\n\n    Peer.connection = new RTCPeerConnection(this.RTCPeerConnectionOptions, null);\n\n    Peer.connection\n      .setRemoteDescription(RemoteRTCSessionDescription)\n      .then(() => Peer.connection.createAnswer())\n      .then((LocalRTCSessionDescription) => {\n        Peer.connection.setLocalDescription(LocalRTCSessionDescription);\n        this.signalingServer.emit('peerAnswer', peerId, LocalRTCSessionDescription);\n      })\n      .catch(() => {\n        this.dispatchEvent(new CustomEvent('connectionError', {\n          detail: { message: 'Failed to connect to another users' },\n        }));\n      });\n\n    Peer.connection.addEventListener('icecandidate', (RTCPeerConnectionIceEvent) => {\n      if (!RTCPeerConnectionIceEvent.candidate) return;\n\n      this.signalingServer.emit('peerIce', peerId, RTCPeerConnectionIceEvent.candidate);\n    });\n\n    Peer.connection.addEventListener('datachannel', (RTCDataChannelEvent) => {\n      if (!RTCDataChannelEvent.channel) return;\n\n      Peer.channel = RTCDataChannelEvent.channel;\n\n      Peer.channel.addEventListener('open', () => {\n        this.dispatchEvent(new CustomEvent('dataChannelStateChange', {\n          detail: { state: 'open', connection: { peerId } },\n        }));\n\n        Peer.channel.addEventListener('message', this.onMessage);\n      });\n\n      Peer.channel.addEventListener('close', () => {\n        this.dispatchEvent(new CustomEvent('dataChannelStateChange', {\n          detail: { state: 'close', connection: { peerId } },\n        }));\n      });\n    });\n  }\n\n  onPeerWantsACall(peerId) {\n    if (this.peers[peerId]) return;\n\n    this.peers[peerId] = { ...this.newPeer };\n    const Peer = this.peers[peerId];\n\n    Peer.connection = new RTCPeerConnection(this.RTCPeerConnectionOptions, null);\n\n    Peer.channel = Peer.connection.createDataChannel('datachannel', this.RTCDataChannelOptions);\n\n    Peer.connection.addEventListener('datachannel', (event) => {\n      Peer.channel = event.channel;\n    });\n\n    Peer.connection.addEventListener('icecandidate', (RTCPeerConnectionIceEvent) => {\n      if (!RTCPeerConnectionIceEvent.candidate) return;\n\n      this.signalingServer.emit('peerIce', peerId, RTCPeerConnectionIceEvent.candidate);\n    });\n\n    Peer.connection.addEventListener('negotiationneeded', () => {\n      Peer.connection\n        .createOffer()\n        .then((LocalRTCSessionDescription) => {\n          Peer.connection.setLocalDescription(LocalRTCSessionDescription);\n          this.signalingServer.emit('peerOffer', peerId, LocalRTCSessionDescription);\n        })\n        .catch(() => {\n          this.dispatchEvent(new CustomEvent('connectionError', {\n            detail: { message: 'Failed to connect to another users' },\n          }));\n        });\n    });\n\n    Peer.channel.addEventListener('open', () => {\n      this.dispatchEvent(new CustomEvent('dataChannelStateChange', {\n        detail: { state: 'open', connection: { peerId } },\n      }));\n\n      Peer.channel.addEventListener('message', this.onMessage);\n    });\n\n    Peer.channel.addEventListener('close', () => {\n      this.dispatchEvent(new CustomEvent('dataChannelStateChange', {\n        detail: { state: 'close', connection: { peerId } },\n      }));\n    });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  onPeerUpdate(peerId, data) {\n    if (!this.peers[peerId]) return;\n\n    const userData = JSON.parse(data);\n\n    this.peers[peerId].data = {\n      name: userData.name,\n      uri: userData.uri,\n    };\n\n    this.dispatchEvent(new CustomEvent('peerUpdate', {\n      detail: { peer: { id: peerId, name: userData.name, uri: userData.uri } },\n    }));\n  }\n\n  onMessage(MessageEvent) {\n    const { label, data } = JSON.parse(MessageEvent.data);\n\n    if (label === 'userdata') this.onPeerUserData(data);\n    if (label === 'message') {\n      this.dispatchEvent(new Event('message', { bubbles: false, cancelable: false }));\n    }\n  }\n\n  onPeerDisconnect(peerId) {\n    if (!this.peers[peerId]) return;\n\n    this.peers[peerId].channel.close();\n    this.peers[peerId].connection.close();\n    delete this.peers[peerId];\n  }\n\n  onSignalingServerMessage(label, data) {\n    //\n    console.log(label, data);\n\n    if (label === 'roomCreated') {\n      this.dispatchEvent(new CustomEvent('roomSuccess', {\n        detail: { action: 'created', room: { name: data } },\n      }));\n    }\n\n    if (label === 'roomJoined') {\n      this.dispatchEvent(new CustomEvent('roomSuccess', {\n        detail: { action: 'joined', room: { name: data } },\n      }));\n    }\n\n    if (label === 'roomError') {\n      this.dispatchEvent(new CustomEvent('roomError', {\n        detail: { message: data },\n      }));\n    }\n  }\n\n  createRoom() {\n    this.signalingServer.emit('createRoom');\n  }\n\n  joinRoom(roomName) {\n    this.signalingServer.emit('joinRoom', roomName);\n  }\n\n  signalReady(name, uri) {\n    this.signalingServer.emit('userReady', JSON.stringify({ name, uri }));\n  }\n}\n","export default (image, dSize = 100) =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const img = new Image();\n    const canvas = document.createElement('canvas');\n    canvas.width = dSize;\n    canvas.height = dSize;\n    reader.addEventListener('load', () => {\n      img.addEventListener('load', () => {\n        if (img.width === img.height) {\n          canvas.getContext('2d').drawImage(img, 0, 0, dSize, dSize);\n        } else {\n          canvas\n            .getContext('2d')\n            .drawImage(\n              img,\n              img.width > img.height ? (img.width - img.height) / 2 : 0,\n              img.width > img.height ? 0 : (img.height - img.width) / 2,\n              img.width > img.height ? img.height : img.width,\n              img.width > img.height ? img.height : img.width,\n              0,\n              0,\n              dSize,\n              dSize,\n            );\n        }\n        resolve(canvas.toDataURL());\n      });\n      img.addEventListener('error', reject);\n      img.src = reader.result;\n    });\n    reader.addEventListener('error', reject);\n    reader.readAsDataURL(image);\n  });\n","import DataChannel from './lib/DataChannel';\nimport thumbDataURI from './lib/thumbDataURI';\n\nlet datachannel = null;\n\nconst $buttonCreateRoom = document.querySelector('.button_create-room');\nconst $targetRoomName = document.querySelector('.target_room-name');\nconst $inputRoomName = document.querySelector('.input_room-name');\nconst $buttonJoinRoom = document.querySelector('.button_join-room');\n\nconst $inputUserName = document.querySelector('.input_user-name');\nconst $inputUserPicture = document.querySelector('.input_user-picture');\nconst $readyButton = document.querySelector('.button_ready');\n\nconst log = {\n  blue: (label, ...data) =>\n    console.log(`%c ${label} `, 'background: dodgerblue; color: white', ...data),\n  red: (label, ...data) => console.log(`%c ${label} `, 'background: red; color: white', ...data),\n  green: (label, ...data) =>\n    console.log(`%c ${label} `, 'background: yellowgreen; color: white', ...data),\n};\n\nconst onRoomError = (event) => {\n  log.orange('WARN', event.detail.message);\n};\n\nconst onRoomSuccess = (event) => {\n  const action = event.detail.action === 'created' ? 'created and joined' : 'joined';\n  const name = event.detail.room.name;\n\n  if (event.detail.action === 'created') {\n    $targetRoomName.textContent = name;\n  }\n\n  $inputRoomName.disabled = true;\n  $buttonCreateRoom.disabled = true;\n  $buttonJoinRoom.disabled = true;\n\n  log.blue('LOG', `Successfully ${action} the \"${name}\" room`);\n};\n\nconst onStateChange = (event) => {\n  const state = event.detail.state;\n  const peerId = event.detail.connection.peerId;\n\n  if (state === 'open') log.green('CONNECTION', `established with ${peerId}`);\n  if (state === 'close') log.red('DISCONNECTION', `from ${peerId}`);\n};\n\nconst onPeerUpdate = (event) => {\n  log.blue('LOG', `got update from peer ${event.detail.peer.id} name: ${event.detail.peer.name}`);\n};\n\nconst onReady = () => {\n  const name = $inputUserName.value;\n  const picture = $inputUserPicture.files[0];\n\n  if (!name || name === '' || !picture) return;\n\n  thumbDataURI(picture).then(uri => datachannel.signalReady(name, uri));\n};\n\nconst onJoinRoom = () => {\n  const roomName = $inputRoomName.value;\n  if (!roomName || roomName === '') return;\n  datachannel.joinRoom(roomName);\n};\n\nconst onKeyDown = (event) => {\n  if (event.keyCode !== 13) return;\n  onJoinRoom();\n};\n\nconst initDataChannel = () => {\n  datachannel = new DataChannel();\n\n  $buttonJoinRoom.addEventListener('click', onJoinRoom);\n  $inputRoomName.addEventListener('keydown', onKeyDown);\n  $buttonCreateRoom.addEventListener('click', datachannel.createRoom);\n  $readyButton.addEventListener('click', onReady);\n\n  datachannel.on('roomError', onRoomError);\n  datachannel.on('roomSuccess', onRoomSuccess);\n  datachannel.on('dataChannelStateChange', onStateChange);\n  datachannel.on('peerUpdate', onPeerUpdate);\n};\n\nconst init = () => {\n  initDataChannel();\n\n  window.peers = datachannel.peers;\n  window.send = datachannel.sendMessage;\n};\n\ninit();\n"],"names":["logging","utils","require$$0","sdp","SDPUtils","shimRTCPeerConnection","require$$1","require$$2","require$$3","require$$4","adapterFactory","global","EventTarget","listeners","addEventListener","type","callback","push","removeEventListener","stack","i","l","length","splice","dispatchEvent","event","call","defaultPrevented","on","DataChannel","peers","newPeer","RTCPeerConnectionOptions","iceServers","urls","RTCDataChannelOptions","ordered","maxPacketLifeTime","signalingServer","io","connect","bindClassMethods","setEventListeners","method","bind","onConnection","onPeerIce","onPeerAnswer","onPeerOffer","onPeerWantsACall","onPeerUpdate","onPeerDisconnect","onSignalingServerMessage","sendMessage","label","input","data","peerKeys","Object","keys","forEach","peerId","channel","readyState","message","JSON","stringify","send","log","id","RTCIceCandidate","candidate","connection","addIceCandidate","RemoteRTCSessionDescription","setRemoteDescription","Peer","RTCPeerConnection","then","createAnswer","LocalRTCSessionDescription","setLocalDescription","emit","catch","CustomEvent","RTCPeerConnectionIceEvent","RTCDataChannelEvent","state","onMessage","createDataChannel","createOffer","userData","parse","name","uri","peer","MessageEvent","onPeerUserData","Event","bubbles","cancelable","close","action","room","createRoom","joinRoom","roomName","signalReady","image","dSize","Promise","resolve","reject","reader","FileReader","img","Image","canvas","document","createElement","width","height","getContext","drawImage","toDataURL","src","result","readAsDataURL","datachannel","$buttonCreateRoom","querySelector","$targetRoomName","$inputRoomName","$buttonJoinRoom","$inputUserName","$inputUserPicture","$readyButton","onRoomError","orange","detail","onRoomSuccess","textContent","disabled","blue","onStateChange","green","red","onReady","value","picture","files","onJoinRoom","onKeyDown","keyCode","initDataChannel","init"],"mappings":";;;;;;;;;;;;;AAAA;;;;;;;;AAQA,AAEA,IAAI,YAAY,GAAG,IAAI,CAAC;AACxB,IAAI,oBAAoB,GAAG,IAAI,CAAC;;;AAGhC,IAAI,KAAK,GAAG;EACV,UAAU,EAAE,SAAS,IAAI,EAAE;IACzB,IAAI,OAAO,IAAI,KAAK,SAAS,EAAE;MAC7B,OAAO,IAAI,KAAK,CAAC,iBAAiB,GAAG,OAAO,IAAI;UAC5C,yBAAyB,CAAC,CAAC;KAChC;IACD,YAAY,GAAG,IAAI,CAAC;IACpB,OAAO,CAAC,IAAI,IAAI,6BAA6B;QACzC,4BAA4B,CAAC;GAClC;;;;;;EAMD,eAAe,EAAE,SAAS,IAAI,EAAE;IAC9B,IAAI,OAAO,IAAI,KAAK,SAAS,EAAE;MAC7B,OAAO,IAAI,KAAK,CAAC,iBAAiB,GAAG,OAAO,IAAI;UAC5C,yBAAyB,CAAC,CAAC;KAChC;IACD,oBAAoB,GAAG,CAAC,IAAI,CAAC;IAC7B,OAAO,kCAAkC,IAAI,IAAI,GAAG,UAAU,GAAG,SAAS,CAAC,CAAC;GAC7E;;EAED,GAAG,EAAE,WAAW;IACd,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;MAC9B,IAAI,YAAY,EAAE;QAChB,OAAO;OACR;MACD,IAAI,OAAO,OAAO,KAAK,WAAW,IAAI,OAAO,OAAO,CAAC,GAAG,KAAK,UAAU,EAAE;QACvE,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;OACvC;KACF;GACF;;;;;EAKD,UAAU,EAAE,SAAS,SAAS,EAAE,SAAS,EAAE;IACzC,IAAI,CAAC,oBAAoB,EAAE;MACzB,OAAO;KACR;IACD,OAAO,CAAC,IAAI,CAAC,SAAS,GAAG,6BAA6B,GAAG,SAAS;QAC9D,WAAW,CAAC,CAAC;GAClB;;;;;;;;;;EAUD,cAAc,EAAE,SAAS,QAAQ,EAAE,IAAI,EAAE,GAAG,EAAE;IAC5C,IAAI,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACjC,OAAO,KAAK,IAAI,KAAK,CAAC,MAAM,IAAI,GAAG,IAAI,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC;GACjE;;;;;;;;EAQD,aAAa,EAAE,SAAS,MAAM,EAAE;IAC9B,IAAI,SAAS,GAAG,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC;;;IAG3C,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC;IACtB,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC;;;IAGtB,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE;MACtD,MAAM,CAAC,OAAO,GAAG,gBAAgB,CAAC;MAClC,OAAO,MAAM,CAAC;KACf;;;IAGD,IAAI,SAAS,CAAC,eAAe,EAAE;MAC7B,MAAM,CAAC,OAAO,GAAG,SAAS,CAAC;MAC3B,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS;UACpD,kBAAkB,EAAE,CAAC,CAAC,CAAC;KAC5B,MAAM,IAAI,SAAS,CAAC,kBAAkB,EAAE;;MAEvC,IAAI,MAAM,CAAC,uBAAuB,EAAE;QAClC,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC;QAC1B,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS;UACtD,uBAAuB,EAAE,CAAC,CAAC,CAAC;OAC/B,MAAM;QACL,IAAI,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,sBAAsB,CAAC,EAAE;UACrD,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC;UAC1B,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS;YACtD,sBAAsB,EAAE,CAAC,CAAC,CAAC;SAC9B,MAAM;UACL,MAAM,CAAC,OAAO,GAAG,mCAAmC;cAChD,yCAAyC,CAAC;UAC9C,OAAO,MAAM,CAAC;SACf;OACF;KACF,MAAM,IAAI,SAAS,CAAC,YAAY;QAC7B,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,oBAAoB,CAAC,EAAE;MACnD,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC;MACxB,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS;UACpD,oBAAoB,EAAE,CAAC,CAAC,CAAC;KAC9B,MAAM,IAAI,SAAS,CAAC,YAAY;QAC7B,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,sBAAsB,CAAC,EAAE;;MAErD,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC;MAC1B,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS;UACpD,sBAAsB,EAAE,CAAC,CAAC,CAAC;KAChC,MAAM;MACL,MAAM,CAAC,OAAO,GAAG,0BAA0B,CAAC;MAC5C,OAAO,MAAM,CAAC;KACf;;IAED,OAAO,MAAM,CAAC;GACf;;CAEF,CAAC;;;AAGF,WAAc,GAAG;EACf,GAAG,EAAE,KAAK,CAAC,GAAG;EACd,UAAU,EAAE,KAAK,CAAC,UAAU;EAC5B,UAAU,EAAE,KAAK,CAAC,UAAU;EAC5B,eAAe,EAAE,KAAK,CAAC,eAAe;EACtC,cAAc,EAAE,KAAK,CAAC,cAAc;EACpC,mBAAmB,EAAE,KAAK,CAAC,mBAAmB;EAC9C,aAAa,EAAE,KAAK,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC;CAC/C;;ACvID,IAAIA,SAAO,GAAGC,OAAK,CAAC,GAAG,CAAC;;;AAGxB,gBAAc,GAAG,SAAS,MAAM,EAAE;EAChC,IAAI,cAAc,GAAGA,OAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;EACjD,IAAI,SAAS,GAAG,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC;;EAE3C,IAAI,oBAAoB,GAAG,SAAS,CAAC,EAAE;IACrC,IAAI,OAAO,CAAC,KAAK,QAAQ,IAAI,CAAC,CAAC,SAAS,IAAI,CAAC,CAAC,QAAQ,EAAE;MACtD,OAAO,CAAC,CAAC;KACV;IACD,IAAI,EAAE,GAAG,EAAE,CAAC;IACZ,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE;MACnC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,UAAU,IAAI,GAAG,KAAK,aAAa,EAAE;QACpE,OAAO;OACR;MACD,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,KAAK,QAAQ,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;MAChE,IAAI,CAAC,CAAC,KAAK,KAAK,SAAS,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,QAAQ,EAAE;QACxD,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC;OACzB;MACD,IAAI,QAAQ,GAAG,SAAS,MAAM,EAAE,IAAI,EAAE;QACpC,IAAI,MAAM,EAAE;UACV,OAAO,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;SAC9D;QACD,OAAO,CAAC,IAAI,KAAK,UAAU,IAAI,UAAU,GAAG,IAAI,CAAC;OAClD,CAAC;MACF,IAAI,CAAC,CAAC,KAAK,KAAK,SAAS,EAAE;QACzB,EAAE,CAAC,QAAQ,GAAG,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC;QAChC,IAAI,EAAE,GAAG,EAAE,CAAC;QACZ,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,QAAQ,EAAE;UAC/B,EAAE,CAAC,QAAQ,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;UACnC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;UACrB,EAAE,GAAG,EAAE,CAAC;UACR,EAAE,CAAC,QAAQ,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;UACnC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACtB,MAAM;UACL,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;UAChC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACtB;OACF;MACD,IAAI,CAAC,CAAC,KAAK,KAAK,SAAS,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,QAAQ,EAAE;QACxD,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC,SAAS,IAAI,EAAE,CAAC;QAClC,EAAE,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;OAC3C,MAAM;QACL,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE;UACnC,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;YACxB,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC,SAAS,IAAI,EAAE,CAAC;YAClC,EAAE,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;WAC3C;SACF,CAAC,CAAC;OACJ;KACF,CAAC,CAAC;IACH,IAAI,CAAC,CAAC,QAAQ,EAAE;MACd,EAAE,CAAC,QAAQ,GAAG,CAAC,EAAE,CAAC,QAAQ,IAAI,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;KACtD;IACD,OAAO,EAAE,CAAC;GACX,CAAC;;EAEF,IAAI,gBAAgB,GAAG,SAAS,WAAW,EAAE,IAAI,EAAE;IACjD,IAAI,cAAc,CAAC,OAAO,IAAI,EAAE,EAAE;MAChC,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC;KAC1B;IACD,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;IACtD,IAAI,WAAW,IAAI,OAAO,WAAW,CAAC,KAAK,KAAK,QAAQ,EAAE;MACxD,IAAI,KAAK,GAAG,SAAS,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE;QAC9B,IAAI,CAAC,IAAI,GAAG,IAAI,EAAE,CAAC,IAAI,GAAG,CAAC,EAAE;UAC3B,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;UAChB,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC;SACf;OACF,CAAC;MACF,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;MACtD,KAAK,CAAC,WAAW,CAAC,KAAK,EAAE,iBAAiB,EAAE,qBAAqB,CAAC,CAAC;MACnE,KAAK,CAAC,WAAW,CAAC,KAAK,EAAE,kBAAkB,EAAE,sBAAsB,CAAC,CAAC;MACrE,WAAW,CAAC,KAAK,GAAG,oBAAoB,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;KAC7D;IACD,IAAI,WAAW,IAAI,OAAO,WAAW,CAAC,KAAK,KAAK,QAAQ,EAAE;;MAExD,IAAI,IAAI,GAAG,WAAW,CAAC,KAAK,CAAC,UAAU,CAAC;MACxC,IAAI,GAAG,IAAI,KAAK,CAAC,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;MACnE,IAAI,0BAA0B,GAAG,cAAc,CAAC,OAAO,GAAG,EAAE,CAAC;;MAE7D,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,KAAK,MAAM,IAAI,IAAI,CAAC,KAAK,KAAK,aAAa;oBACrD,IAAI,CAAC,KAAK,KAAK,MAAM,IAAI,IAAI,CAAC,KAAK,KAAK,aAAa,CAAC;UAChE,EAAE,SAAS,CAAC,YAAY,CAAC,uBAAuB;YAC9C,SAAS,CAAC,YAAY,CAAC,uBAAuB,EAAE,CAAC,UAAU;YAC3D,CAAC,0BAA0B,CAAC,EAAE;QAClC,OAAO,WAAW,CAAC,KAAK,CAAC,UAAU,CAAC;QACpC,IAAI,OAAO,CAAC;QACZ,IAAI,IAAI,CAAC,KAAK,KAAK,aAAa,IAAI,IAAI,CAAC,KAAK,KAAK,aAAa,EAAE;UAChE,OAAO,GAAG,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;SAC5B,MAAM,IAAI,IAAI,CAAC,KAAK,KAAK,MAAM,IAAI,IAAI,CAAC,KAAK,KAAK,MAAM,EAAE;UACzD,OAAO,GAAG,CAAC,OAAO,CAAC,CAAC;SACrB;QACD,IAAI,OAAO,EAAE;;UAEX,OAAO,SAAS,CAAC,YAAY,CAAC,gBAAgB,EAAE;WAC/C,IAAI,CAAC,SAAS,OAAO,EAAE;YACtB,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;cACnC,OAAO,CAAC,CAAC,IAAI,KAAK,YAAY,CAAC;aAChC,CAAC,CAAC;YACH,IAAI,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;cACjC,OAAO,OAAO,CAAC,IAAI,CAAC,SAAS,KAAK,EAAE;gBAClC,OAAO,CAAC,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;eACpD,CAAC,CAAC;aACJ,CAAC,CAAC;YACH,IAAI,CAAC,GAAG,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;cAC5D,GAAG,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;aACnC;YACD,IAAI,GAAG,EAAE;cACP,WAAW,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,QAAQ,CAAC;wDACrB,CAAC,KAAK,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC;aACjE;YACD,WAAW,CAAC,KAAK,GAAG,oBAAoB,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAC5DD,SAAO,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;YAClD,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC;WAC1B,CAAC,CAAC;SACJ;OACF;MACD,WAAW,CAAC,KAAK,GAAG,oBAAoB,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;KAC7D;IACDA,SAAO,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;IAClD,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC;GAC1B,CAAC;;EAEF,IAAI,UAAU,GAAG,SAAS,CAAC,EAAE;IAC3B,OAAO;MACL,IAAI,EAAE;QACJ,qBAAqB,EAAE,iBAAiB;QACxC,iBAAiB,EAAE,kBAAkB;QACrC,oBAAoB,EAAE,eAAe;QACrC,2BAA2B,EAAE,sBAAsB;QACnD,eAAe,EAAE,kBAAkB;QACnC,8BAA8B,EAAE,kBAAkB;QAClD,uBAAuB,EAAE,kBAAkB;OAC5C,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI;MACnB,OAAO,EAAE,CAAC,CAAC,OAAO;MAClB,UAAU,EAAE,CAAC,CAAC,cAAc;MAC5B,QAAQ,EAAE,WAAW;QACnB,OAAO,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC;OAC1D;KACF,CAAC;GACH,CAAC;;EAEF,IAAI,aAAa,GAAG,SAAS,WAAW,EAAE,SAAS,EAAE,OAAO,EAAE;IAC5D,gBAAgB,CAAC,WAAW,EAAE,SAAS,CAAC,EAAE;MACxC,SAAS,CAAC,kBAAkB,CAAC,CAAC,EAAE,SAAS,EAAE,SAAS,CAAC,EAAE;QACrD,IAAI,OAAO,EAAE;UACX,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;SACxB;OACF,CAAC,CAAC;KACJ,CAAC,CAAC;GACJ,CAAC;;EAEF,SAAS,CAAC,YAAY,GAAG,aAAa,CAAC;;;EAGvC,IAAI,oBAAoB,GAAG,SAAS,WAAW,EAAE;IAC/C,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;MAC3C,SAAS,CAAC,YAAY,CAAC,WAAW,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;KACtD,CAAC,CAAC;GACJ,CAAC;;EAEF,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;IAC3B,SAAS,CAAC,YAAY,GAAG;MACvB,YAAY,EAAE,oBAAoB;MAClC,gBAAgB,EAAE,WAAW;QAC3B,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE;UACnC,IAAI,KAAK,GAAG,CAAC,KAAK,EAAE,YAAY,EAAE,KAAK,EAAE,YAAY,CAAC,CAAC;UACvD,OAAO,MAAM,CAAC,gBAAgB,CAAC,UAAU,CAAC,SAAS,OAAO,EAAE;YAC1D,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,MAAM,EAAE;cACnC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,KAAK;gBACzB,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC;gBACxB,QAAQ,EAAE,MAAM,CAAC,EAAE;gBACnB,OAAO,EAAE,EAAE,CAAC,CAAC;aAChB,CAAC,CAAC,CAAC;WACL,CAAC,CAAC;SACJ,CAAC,CAAC;OACJ;MACD,uBAAuB,EAAE,WAAW;QAClC,OAAO;UACL,QAAQ,EAAE,IAAI,EAAE,gBAAgB,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI;UACxD,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI;SAC3C,CAAC;OACH;KACF,CAAC;GACH;;;;EAID,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,YAAY,EAAE;IACxC,SAAS,CAAC,YAAY,CAAC,YAAY,GAAG,SAAS,WAAW,EAAE;MAC1D,OAAO,oBAAoB,CAAC,WAAW,CAAC,CAAC;KAC1C,CAAC;GACH,MAAM;;;;IAIL,IAAI,gBAAgB,GAAG,SAAS,CAAC,YAAY,CAAC,YAAY;QACtD,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;IACjC,SAAS,CAAC,YAAY,CAAC,YAAY,GAAG,SAAS,EAAE,EAAE;MACjD,OAAO,gBAAgB,CAAC,EAAE,EAAE,SAAS,CAAC,EAAE;QACtC,OAAO,gBAAgB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,MAAM,EAAE;UAC/C,IAAI,CAAC,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,MAAM;cAC1C,CAAC,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,MAAM,EAAE;YAC9C,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;cACzC,KAAK,CAAC,IAAI,EAAE,CAAC;aACd,CAAC,CAAC;YACH,MAAM,IAAI,YAAY,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;WAC7C;UACD,OAAO,MAAM,CAAC;SACf,EAAE,SAAS,CAAC,EAAE;UACb,OAAO,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;SACtC,CAAC,CAAC;OACJ,CAAC,CAAC;KACJ,CAAC;GACH;;;;EAID,IAAI,OAAO,SAAS,CAAC,YAAY,CAAC,gBAAgB,KAAK,WAAW,EAAE;IAClE,SAAS,CAAC,YAAY,CAAC,gBAAgB,GAAG,WAAW;MACnDA,SAAO,CAAC,6CAA6C,CAAC,CAAC;KACxD,CAAC;GACH;EACD,IAAI,OAAO,SAAS,CAAC,YAAY,CAAC,mBAAmB,KAAK,WAAW,EAAE;IACrE,SAAS,CAAC,YAAY,CAAC,mBAAmB,GAAG,WAAW;MACtDA,SAAO,CAAC,gDAAgD,CAAC,CAAC;KAC3D,CAAC;GACH;CACF;;ACpOD,IAAI,OAAO,GAAGC,OAAK,CAAC,GAAG,CAAC;;AAExB,IAAI,UAAU,GAAG;EACf,eAAe,EAAE,SAAS,MAAM,EAAE;IAChC,MAAM,CAAC,WAAW,GAAG,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,iBAAiB,CAAC;GACrE;;EAED,WAAW,EAAE,SAAS,MAAM,EAAE;IAC5B,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,iBAAiB,IAAI,EAAE,SAAS;QACrE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;MACvC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,CAAC,SAAS,EAAE,SAAS,EAAE;QACnE,GAAG,EAAE,WAAW;UACd,OAAO,IAAI,CAAC,QAAQ,CAAC;SACtB;QACD,GAAG,EAAE,SAAS,CAAC,EAAE;UACf,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;WAClD;UACD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;SACnD;OACF,CAAC,CAAC;MACH,IAAI,wBAAwB;UACxB,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,oBAAoB,CAAC;MAC5D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,oBAAoB,GAAG,WAAW;QACnE,IAAI,EAAE,GAAG,IAAI,CAAC;QACd,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;UACpB,EAAE,CAAC,YAAY,GAAG,SAAS,CAAC,EAAE;;;YAG5B,CAAC,CAAC,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;cACjD,IAAI,QAAQ,CAAC;cACb,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAY,EAAE;gBACnD,QAAQ,GAAG,EAAE,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;kBAC5C,OAAO,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,CAAC,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC;iBAC9C,CAAC,CAAC;eACJ,MAAM;gBACL,QAAQ,GAAG,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;eAC9B;;cAED,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;cAC/B,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC,KAAK,CAAC;cACvB,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;cAC1B,KAAK,CAAC,WAAW,GAAG,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;cACzC,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;cAC3B,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;aACzB,CAAC,CAAC;YACH,CAAC,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;cAC3C,IAAI,QAAQ,CAAC;cACb,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAY,EAAE;gBACnD,QAAQ,GAAG,EAAE,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;kBAC5C,OAAO,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,CAAC,EAAE,KAAK,KAAK,CAAC,EAAE,CAAC;iBAC3C,CAAC,CAAC;eACJ,MAAM;gBACL,QAAQ,GAAG,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;eAC3B;cACD,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;cAC/B,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;cACpB,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;cAC1B,KAAK,CAAC,WAAW,GAAG,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;cACzC,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;cAC3B,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;aACzB,CAAC,CAAC;WACJ,CAAC;UACF,EAAE,CAAC,gBAAgB,CAAC,WAAW,EAAE,EAAE,CAAC,YAAY,CAAC,CAAC;SACnD;QACD,OAAO,wBAAwB,CAAC,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;OACtD,CAAC;KACH;GACF;;EAED,sBAAsB,EAAE,SAAS,MAAM,EAAE;;IAEvC,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,iBAAiB;QACtD,EAAE,YAAY,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC;QACrD,kBAAkB,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,EAAE;MAC5D,IAAI,kBAAkB,GAAG,SAAS,EAAE,EAAE,KAAK,EAAE;QAC3C,OAAO;UACL,KAAK,EAAE,KAAK;UACZ,IAAI,IAAI,GAAG;YACT,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;cAC5B,IAAI,KAAK,CAAC,IAAI,KAAK,OAAO,EAAE;gBAC1B,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;eACzC,MAAM;gBACL,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;eACnB;aACF;YACD,OAAO,IAAI,CAAC,KAAK,CAAC;WACnB;UACD,GAAG,EAAE,EAAE;SACR,CAAC;OACH,CAAC;;;MAGF,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,UAAU,EAAE;QAClD,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,UAAU,GAAG,WAAW;UACzD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,IAAI,EAAE,CAAC;UACpC,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;SAC9B,CAAC;QACF,IAAI,YAAY,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,CAAC;QAC/D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,GAAG,SAAS,KAAK,EAAE,MAAM,EAAE;UACpE,IAAI,EAAE,GAAG,IAAI,CAAC;UACd,IAAI,MAAM,GAAG,YAAY,CAAC,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;UAC/C,IAAI,CAAC,MAAM,EAAE;YACX,MAAM,GAAG,kBAAkB,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;YACvC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;WAC1B;UACD,OAAO,MAAM,CAAC;SACf,CAAC;;QAEF,IAAI,eAAe,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,WAAW,CAAC;QACrE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,WAAW,GAAG,SAAS,MAAM,EAAE;UAChE,IAAI,EAAE,GAAG,IAAI,CAAC;UACd,eAAe,CAAC,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;UACrC,IAAI,GAAG,GAAG,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;UACtC,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE;YACd,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;WAC5B;SACF,CAAC;OACH;MACD,IAAI,aAAa,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,SAAS,CAAC;MACjE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,SAAS,GAAG,SAAS,MAAM,EAAE;QAC9D,IAAI,EAAE,GAAG,IAAI,CAAC;QACd,EAAE,CAAC,QAAQ,GAAG,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC;QAChC,aAAa,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;QAClC,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;UACzC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC;SACjD,CAAC,CAAC;OACJ,CAAC;;MAEF,IAAI,gBAAgB,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAY,CAAC;MACvE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAY,GAAG,SAAS,MAAM,EAAE;QACjE,IAAI,EAAE,GAAG,IAAI,CAAC;QACd,EAAE,CAAC,QAAQ,GAAG,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC;QAChC,gBAAgB,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;;QAErC,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;UACzC,IAAI,MAAM,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;YACxC,OAAO,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC;WAC1B,CAAC,CAAC;UACH,IAAI,MAAM,EAAE;YACV,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;WACpD;SACF,CAAC,CAAC;OACJ,CAAC;KACH,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,iBAAiB;eACtD,YAAY,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS;eAClD,kBAAkB,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS;eACxD,MAAM,CAAC,YAAY;eACnB,EAAE,MAAM,IAAI,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,EAAE;MACrD,IAAI,cAAc,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,UAAU,CAAC;MACnE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,UAAU,GAAG,WAAW;QACzD,IAAI,EAAE,GAAG,IAAI,CAAC;QACd,IAAI,OAAO,GAAG,cAAc,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;QAC3C,OAAO,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;UAC/B,MAAM,CAAC,GAAG,GAAG,EAAE,CAAC;SACjB,CAAC,CAAC;QACH,OAAO,OAAO,CAAC;OAChB,CAAC;;MAEF,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,YAAY,CAAC,SAAS,EAAE,MAAM,EAAE;QAC3D,GAAG,EAAE,WAAW;UACd,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;YAC5B,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,OAAO,EAAE;cAC/B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aACpD,MAAM;cACL,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;aACnB;WACF;UACD,OAAO,IAAI,CAAC,KAAK,CAAC;SACnB;OACF,CAAC,CAAC;KACJ;GACF;;EAED,gBAAgB,EAAE,SAAS,MAAM,EAAE;IACjC,IAAI,GAAG,GAAG,MAAM,IAAI,MAAM,CAAC,GAAG,CAAC;;IAE/B,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;MAC9B,IAAI,MAAM,CAAC,gBAAgB;QACzB,EAAE,WAAW,IAAI,MAAM,CAAC,gBAAgB,CAAC,SAAS,CAAC,EAAE;;QAErD,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,WAAW,EAAE;UACpE,GAAG,EAAE,WAAW;YACd,OAAO,IAAI,CAAC,UAAU,CAAC;WACxB;UACD,GAAG,EAAE,SAAS,MAAM,EAAE;YACpB,IAAI,IAAI,GAAG,IAAI,CAAC;;YAEhB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;YACzB,IAAI,IAAI,CAAC,GAAG,EAAE;cACZ,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aAC/B;;YAED,IAAI,CAAC,MAAM,EAAE;cACX,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;cACd,OAAO,SAAS,CAAC;aAClB;YACD,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;;;YAGvC,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,WAAW;cAC7C,IAAI,IAAI,CAAC,GAAG,EAAE;gBACZ,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;eAC/B;cACD,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;aACxC,CAAC,CAAC;YACH,MAAM,CAAC,gBAAgB,CAAC,aAAa,EAAE,WAAW;cAChD,IAAI,IAAI,CAAC,GAAG,EAAE;gBACZ,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;eAC/B;cACD,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;aACxC,CAAC,CAAC;WACJ;SACF,CAAC,CAAC;OACJ;KACF;GACF;;EAED,uBAAuB,EAAE,SAAS,MAAM,EAAE;IACxC,IAAI,cAAc,GAAGA,OAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;;IAEjD,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ;QAC3C,cAAc,CAAC,OAAO,IAAI,EAAE,EAAE;MAChC,OAAO;KACR;;;;IAID,IAAI,mBAAmB,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS;SACvD,eAAe,CAAC;IACrB,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,eAAe,GAAG,WAAW;MAC9D,IAAI,IAAI,GAAG,IAAI,CAAC;MAChB,IAAI,aAAa,GAAG,mBAAmB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;MACpD,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,IAAI,EAAE,CAAC;MAClD,OAAO,aAAa,CAAC,GAAG,CAAC,SAAS,MAAM,EAAE;QACxC,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;OACxC,CAAC,CAAC;KACJ,CAAC;;IAEF,IAAI,aAAa,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,SAAS,CAAC;IACjE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,SAAS,GAAG,SAAS,MAAM,EAAE;MAC9D,IAAI,EAAE,GAAG,IAAI,CAAC;MACd,EAAE,CAAC,QAAQ,GAAG,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC;MAChC,EAAE,CAAC,eAAe,GAAG,EAAE,CAAC,eAAe,IAAI,EAAE,CAAC;;MAE9C,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;QACzC,IAAI,aAAa,GAAG,EAAE,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;UACnD,OAAO,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC;SAC1B,CAAC,CAAC;QACH,IAAI,aAAa,EAAE;UACjB,MAAM,IAAI,YAAY,CAAC,uBAAuB;cAC1C,oBAAoB,CAAC,CAAC;SAC3B;OACF,CAAC,CAAC;;;MAGH,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;QAClC,IAAI,SAAS,GAAG,IAAI,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC;QAC3D,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC;QACnC,EAAE,CAAC,eAAe,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC;QAC1C,MAAM,GAAG,SAAS,CAAC;OACpB;MACD,aAAa,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;KACnC,CAAC;;IAEF,IAAI,gBAAgB,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAY,CAAC;IACvE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAY,GAAG,SAAS,MAAM,EAAE;MACjE,IAAI,EAAE,GAAG,IAAI,CAAC;MACd,EAAE,CAAC,QAAQ,GAAG,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC;MAChC,EAAE,CAAC,eAAe,GAAG,EAAE,CAAC,eAAe,IAAI,EAAE,CAAC;;MAE9C,gBAAgB,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,MAAM,EAAE,CAAC,CAAC;MACjE,OAAO,EAAE,CAAC,eAAe,EAAE,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC;UAC7C,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,MAAM,CAAC,EAAE,EAAE,CAAC;MAC5C,OAAO,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;KAC/B,CAAC;;IAEF,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,GAAG,SAAS,KAAK,EAAE,MAAM,EAAE;MACpE,IAAI,EAAE,GAAG,IAAI,CAAC;MACd,IAAI,EAAE,CAAC,cAAc,KAAK,QAAQ,EAAE;QAClC,MAAM,IAAI,YAAY;UACpB,wDAAwD;UACxD,mBAAmB,CAAC,CAAC;OACxB;MACD,IAAI,OAAO,GAAG,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;MAC1C,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC;UACpB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;YACvC,OAAO,CAAC,KAAK,KAAK,CAAC;WACpB,CAAC,EAAE;;;QAGN,MAAM,IAAI,YAAY;UACpB,0DAA0D;UAC1D,uDAAuD;UACvD,mBAAmB,CAAC,CAAC;OACxB;;MAED,IAAI,aAAa,GAAG,EAAE,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;QACnD,OAAO,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC;OAC1B,CAAC,CAAC;MACH,IAAI,aAAa,EAAE;QACjB,MAAM,IAAI,YAAY,CAAC,uBAAuB;YAC1C,oBAAoB,CAAC,CAAC;OAC3B;;MAED,EAAE,CAAC,QAAQ,GAAG,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC;MAChC,EAAE,CAAC,eAAe,GAAG,EAAE,CAAC,eAAe,IAAI,EAAE,CAAC;MAC9C,IAAI,SAAS,GAAG,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;MACvC,IAAI,SAAS,EAAE;;;;;QAKb,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;;;QAG1B,OAAO,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,WAAW;UAChC,EAAE,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC;SAClD,CAAC,CAAC;OACJ,MAAM;QACL,IAAI,SAAS,GAAG,IAAI,MAAM,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;QAChD,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC;QACnC,EAAE,CAAC,eAAe,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC;QAC1C,EAAE,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;OACzB;MACD,OAAO,EAAE,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;QACtC,OAAO,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC;OAC1B,CAAC,CAAC;KACJ,CAAC;;;;IAIF,SAAS,uBAAuB,CAAC,EAAE,EAAE,WAAW,EAAE;MAChD,IAAI,GAAG,GAAG,WAAW,CAAC,GAAG,CAAC;MAC1B,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,UAAU,EAAE;QACjE,IAAI,cAAc,GAAG,EAAE,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;QACpD,IAAI,cAAc,GAAG,EAAE,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;QACpD,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,cAAc,CAAC,EAAE,EAAE,GAAG,CAAC;YAChD,cAAc,CAAC,EAAE,CAAC,CAAC;OACxB,CAAC,CAAC;MACH,OAAO,IAAI,qBAAqB,CAAC;QAC/B,IAAI,EAAE,WAAW,CAAC,IAAI;QACtB,GAAG,EAAE,GAAG;OACT,CAAC,CAAC;KACJ;IACD,SAAS,uBAAuB,CAAC,EAAE,EAAE,WAAW,EAAE;MAChD,IAAI,GAAG,GAAG,WAAW,CAAC,GAAG,CAAC;MAC1B,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,UAAU,EAAE;QACjE,IAAI,cAAc,GAAG,EAAE,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;QACpD,IAAI,cAAc,GAAG,EAAE,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;QACpD,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,cAAc,CAAC,EAAE,EAAE,GAAG,CAAC;YAChD,cAAc,CAAC,EAAE,CAAC,CAAC;OACxB,CAAC,CAAC;MACH,OAAO,IAAI,qBAAqB,CAAC;QAC/B,IAAI,EAAE,WAAW,CAAC,IAAI;QACtB,GAAG,EAAE,GAAG;OACT,CAAC,CAAC;KACJ;IACD,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;MACvD,IAAI,YAAY,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;MAC9D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,WAAW;QACtD,IAAI,EAAE,GAAG,IAAI,CAAC;QACd,IAAI,IAAI,GAAG,SAAS,CAAC;QACrB,IAAI,YAAY,GAAG,SAAS,CAAC,MAAM;YAC/B,OAAO,SAAS,CAAC,CAAC,CAAC,KAAK,UAAU,CAAC;QACvC,IAAI,YAAY,EAAE;UAChB,OAAO,YAAY,CAAC,KAAK,CAAC,EAAE,EAAE;YAC5B,SAAS,WAAW,EAAE;cACpB,IAAI,IAAI,GAAG,uBAAuB,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;cACpD,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;aAC7B;YACD,SAAS,GAAG,EAAE;cACZ,IAAI,IAAI,CAAC,CAAC,CAAC,EAAE;gBACX,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;eAC1B;aACF,EAAE,SAAS,CAAC,CAAC,CAAC;WAChB,CAAC,CAAC;SACJ;QACD,OAAO,YAAY,CAAC,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC;SACvC,IAAI,CAAC,SAAS,WAAW,EAAE;UAC1B,OAAO,uBAAuB,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;SACjD,CAAC,CAAC;OACJ,CAAC;KACH,CAAC,CAAC;;IAEH,IAAI,uBAAuB;QACvB,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,mBAAmB,CAAC;IAC3D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,mBAAmB,GAAG,WAAW;MAClE,IAAI,EAAE,GAAG,IAAI,CAAC;MACd,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;QAC3C,OAAO,uBAAuB,CAAC,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;OACrD;MACD,SAAS,CAAC,CAAC,CAAC,GAAG,uBAAuB,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;MACzD,OAAO,uBAAuB,CAAC,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;KACrD,CAAC;;;;IAIF,IAAI,oBAAoB,GAAG,MAAM,CAAC,wBAAwB;QACtD,MAAM,CAAC,iBAAiB,CAAC,SAAS,EAAE,kBAAkB,CAAC,CAAC;IAC5D,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,CAAC,SAAS;QACpD,kBAAkB,EAAE;UAClB,GAAG,EAAE,WAAW;YACd,IAAI,EAAE,GAAG,IAAI,CAAC;YACd,IAAI,WAAW,GAAG,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACvD,IAAI,WAAW,CAAC,IAAI,KAAK,EAAE,EAAE;cAC3B,OAAO,WAAW,CAAC;aACpB;YACD,OAAO,uBAAuB,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;WACjD;SACF,CAAC,CAAC;;IAEP,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,WAAW,GAAG,SAAS,MAAM,EAAE;MAChE,IAAI,EAAE,GAAG,IAAI,CAAC;MACd,IAAI,EAAE,CAAC,cAAc,KAAK,QAAQ,EAAE;QAClC,MAAM,IAAI,YAAY;UACpB,wDAAwD;UACxD,mBAAmB,CAAC,CAAC;OACxB;;;MAGD,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE;QACf,MAAM,IAAI,YAAY,CAAC,8CAA8C;YACjE,4CAA4C,EAAE,WAAW,CAAC,CAAC;OAChE;MACD,IAAI,OAAO,GAAG,MAAM,CAAC,GAAG,KAAK,EAAE,CAAC;MAChC,IAAI,CAAC,OAAO,EAAE;QACZ,MAAM,IAAI,YAAY,CAAC,4CAA4C;YAC/D,oBAAoB,CAAC,CAAC;OAC3B;;;MAGD,EAAE,CAAC,QAAQ,GAAG,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC;MAChC,IAAI,MAAM,CAAC;MACX,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,SAAS,QAAQ,EAAE;QAClD,IAAI,QAAQ,GAAG,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,SAAS,KAAK,EAAE;UACpE,OAAO,MAAM,CAAC,KAAK,KAAK,KAAK,CAAC;SAC/B,CAAC,CAAC;QACH,IAAI,QAAQ,EAAE;UACZ,MAAM,GAAG,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;SAChC;OACF,CAAC,CAAC;;MAEH,IAAI,MAAM,EAAE;QACV,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC,MAAM,KAAK,CAAC,EAAE;;;UAGnC,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;SAChD,MAAM;;UAEL,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;SAClC;QACD,EAAE,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC;OAClD;KACF,CAAC;GACH;;EAED,kBAAkB,EAAE,SAAS,MAAM,EAAE;IACnC,IAAI,cAAc,GAAGA,OAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;;;IAGjD,IAAI,CAAC,MAAM,CAAC,iBAAiB,EAAE;MAC7B,MAAM,CAAC,iBAAiB,GAAG,SAAS,QAAQ,EAAE,aAAa,EAAE;;;;QAI3D,OAAO,CAAC,gBAAgB,CAAC,CAAC;QAC1B,IAAI,QAAQ,IAAI,QAAQ,CAAC,kBAAkB,EAAE;UAC3C,QAAQ,CAAC,aAAa,GAAG,QAAQ,CAAC,kBAAkB,CAAC;SACtD;;QAED,OAAO,IAAI,MAAM,CAAC,uBAAuB,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;OACpE,CAAC;MACF,MAAM,CAAC,iBAAiB,CAAC,SAAS;UAC9B,MAAM,CAAC,uBAAuB,CAAC,SAAS,CAAC;;MAE7C,IAAI,MAAM,CAAC,uBAAuB,CAAC,mBAAmB,EAAE;QACtD,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,EAAE,qBAAqB,EAAE;UACrE,GAAG,EAAE,WAAW;YACd,OAAO,MAAM,CAAC,uBAAuB,CAAC,mBAAmB,CAAC;WAC3D;SACF,CAAC,CAAC;OACJ;KACF,MAAM;;MAEL,IAAI,kBAAkB,GAAG,MAAM,CAAC,iBAAiB,CAAC;MAClD,MAAM,CAAC,iBAAiB,GAAG,SAAS,QAAQ,EAAE,aAAa,EAAE;QAC3D,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;UACnC,IAAI,aAAa,GAAG,EAAE,CAAC;UACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACnD,IAAI,MAAM,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACpC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC;gBAC9B,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;cAChCA,OAAK,CAAC,UAAU,CAAC,kBAAkB,EAAE,mBAAmB,CAAC,CAAC;cAC1D,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;cAC5C,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC;cACzB,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aAC5B,MAAM;cACL,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;aAC5C;WACF;UACD,QAAQ,CAAC,UAAU,GAAG,aAAa,CAAC;SACrC;QACD,OAAO,IAAI,kBAAkB,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;OACxD,CAAC;MACF,MAAM,CAAC,iBAAiB,CAAC,SAAS,GAAG,kBAAkB,CAAC,SAAS,CAAC;;MAElE,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,EAAE,qBAAqB,EAAE;QACrE,GAAG,EAAE,WAAW;UACd,OAAO,kBAAkB,CAAC,mBAAmB,CAAC;SAC/C;OACF,CAAC,CAAC;KACJ;;IAED,IAAI,YAAY,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,CAAC;IAC/D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,GAAG,SAAS,QAAQ;QAC3D,eAAe,EAAE,aAAa,EAAE;MAClC,IAAI,IAAI,GAAG,IAAI,CAAC;MAChB,IAAI,IAAI,GAAG,SAAS,CAAC;;;;MAIrB,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;QAC1D,OAAO,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;OAC5C;;;;MAID,IAAI,YAAY,CAAC,MAAM,KAAK,CAAC,KAAK,SAAS,CAAC,MAAM,KAAK,CAAC;UACpD,OAAO,SAAS,CAAC,CAAC,CAAC,KAAK,UAAU,CAAC,EAAE;QACvC,OAAO,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;OACrC;;MAED,IAAI,eAAe,GAAG,SAAS,QAAQ,EAAE;QACvC,IAAI,cAAc,GAAG,EAAE,CAAC;QACxB,IAAI,OAAO,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC;QAChC,OAAO,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;UAC/B,IAAI,aAAa,GAAG;YAClB,EAAE,EAAE,MAAM,CAAC,EAAE;YACb,SAAS,EAAE,MAAM,CAAC,SAAS;YAC3B,IAAI,EAAE;cACJ,cAAc,EAAE,iBAAiB;cACjC,eAAe,EAAE,kBAAkB;aACpC,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,IAAI;WAC9B,CAAC;UACF,MAAM,CAAC,KAAK,EAAE,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE;YACpC,aAAa,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;WACzC,CAAC,CAAC;UACH,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC;SAClD,CAAC,CAAC;;QAEH,OAAO,cAAc,CAAC;OACvB,CAAC;;;MAGF,IAAI,YAAY,GAAG,SAAS,KAAK,EAAE;QACjC,OAAO,IAAI,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,SAAS,GAAG,EAAE;UAClD,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;SAC1B,CAAC,CAAC,CAAC;OACL,CAAC;;MAEF,IAAI,SAAS,CAAC,MAAM,IAAI,CAAC,EAAE;QACzB,IAAI,uBAAuB,GAAG,SAAS,QAAQ,EAAE;UAC/C,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;SAClD,CAAC;;QAEF,OAAO,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,uBAAuB;UACtD,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;OAClB;;;MAGD,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;QAC3C,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE;UACvB,SAAS,QAAQ,EAAE;YACjB,OAAO,CAAC,YAAY,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;WAClD,EAAE,MAAM,CAAC,CAAC,CAAC;OACf,CAAC,CAAC,IAAI,CAAC,eAAe,EAAE,aAAa,CAAC,CAAC;KACzC,CAAC;;;IAGF,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,EAAE;MAC/B,CAAC,qBAAqB,EAAE,sBAAsB,EAAE,iBAAiB,CAAC;WAC7D,OAAO,CAAC,SAAS,MAAM,EAAE;YACxB,IAAI,YAAY,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAC9D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,WAAW;cACtD,IAAI,IAAI,GAAG,SAAS,CAAC;cACrB,IAAI,IAAI,GAAG,IAAI,CAAC;cAChB,IAAI,OAAO,GAAG,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;gBAClD,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;eACtD,CAAC,CAAC;cACH,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnB,OAAO,OAAO,CAAC;eAChB;cACD,OAAO,OAAO,CAAC,IAAI,CAAC,WAAW;gBAC7B,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;eACzB;cACD,SAAS,GAAG,EAAE;gBACZ,IAAI,IAAI,CAAC,MAAM,IAAI,CAAC,EAAE;kBACpB,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;iBAC5B;eACF,CAAC,CAAC;aACJ,CAAC;WACH,CAAC,CAAC;KACR;;;;IAID,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,EAAE;MAC/B,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;QACvD,IAAI,YAAY,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAC9D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,WAAW;UACtD,IAAI,IAAI,GAAG,IAAI,CAAC;UAChB,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,KAAK,SAAS,CAAC,MAAM,KAAK,CAAC;cAC/C,OAAO,SAAS,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC,EAAE;YACrC,IAAI,IAAI,GAAG,SAAS,CAAC,MAAM,KAAK,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC;YAC7D,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;cAC3C,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;aACnD,CAAC,CAAC;WACJ;UACD,OAAO,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SAC5C,CAAC;OACH,CAAC,CAAC;KACJ;;;IAGD,CAAC,qBAAqB,EAAE,sBAAsB,EAAE,iBAAiB,CAAC;SAC7D,OAAO,CAAC,SAAS,MAAM,EAAE;UACxB,IAAI,YAAY,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;UAC9D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,WAAW;YACtD,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM,KAAK,iBAAiB;gBAC7C,MAAM,CAAC,eAAe;gBACtB,MAAM,CAAC,qBAAqB,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YAChD,OAAO,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;WAC5C,CAAC;SACH,CAAC,CAAC;;;IAGP,IAAI,qBAAqB;QACrB,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,eAAe,CAAC;IACvD,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,eAAe,GAAG,WAAW;MAC9D,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;QACjB,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;UAChB,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAC1B;QACD,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;OAC1B;MACD,OAAO,qBAAqB,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KACrD,CAAC;GACH;CACF,CAAC;;;;AAIF,eAAc,GAAG;EACf,eAAe,EAAE,UAAU,CAAC,eAAe;EAC3C,WAAW,EAAE,UAAU,CAAC,WAAW;EACnC,uBAAuB,EAAE,UAAU,CAAC,uBAAuB;EAC3D,sBAAsB,EAAE,UAAU,CAAC,sBAAsB;EACzD,gBAAgB,EAAE,UAAU,CAAC,gBAAgB;EAC7C,kBAAkB,EAAE,UAAU,CAAC,kBAAkB;EACjD,gBAAgB,EAAEC,YAAyB;CAC5C;;;;AC/pBD,AAGA,IAAI,QAAQ,GAAG,EAAE,CAAC;;;;AAIlB,QAAQ,CAAC,kBAAkB,GAAG,WAAW;EACvC,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;CACjD,CAAC;;;AAGF,QAAQ,CAAC,UAAU,GAAG,QAAQ,CAAC,kBAAkB,EAAE,CAAC;;;AAGpD,QAAQ,CAAC,UAAU,GAAG,SAAS,IAAI,EAAE;EACnC,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,SAAS,IAAI,EAAE;IAChD,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC;GACpB,CAAC,CAAC;CACJ,CAAC;;AAEF,QAAQ,CAAC,aAAa,GAAG,SAAS,IAAI,EAAE;EACtC,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;EAC/B,OAAO,KAAK,CAAC,GAAG,CAAC,SAAS,IAAI,EAAE,KAAK,EAAE;IACrC,OAAO,CAAC,KAAK,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,EAAE,IAAI,EAAE,GAAG,MAAM,CAAC;GACzD,CAAC,CAAC;CACJ,CAAC;;;AAGF,QAAQ,CAAC,WAAW,GAAG,SAAS,IAAI,EAAE,MAAM,EAAE;EAC5C,OAAO,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,SAAS,IAAI,EAAE;IACrD,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;GACnC,CAAC,CAAC;CACJ,CAAC;;;;;AAKF,QAAQ,CAAC,cAAc,GAAG,SAAS,IAAI,EAAE;EACvC,IAAI,KAAK,CAAC;;EAEV,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;IACtC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;GACvC,MAAM;IACL,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;GACvC;;EAED,IAAI,SAAS,GAAG;IACd,UAAU,EAAE,KAAK,CAAC,CAAC,CAAC;IACpB,SAAS,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IACjC,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE;IAChC,QAAQ,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAChC,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC;IACZ,IAAI,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;;IAE5B,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC;GACf,CAAC;;EAEF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;IACxC,QAAQ,KAAK,CAAC,CAAC,CAAC;MACd,KAAK,OAAO;QACV,SAAS,CAAC,cAAc,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACxC,MAAM;MACR,KAAK,OAAO;QACV,SAAS,CAAC,WAAW,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QACnD,MAAM;MACR,KAAK,SAAS;QACZ,SAAS,CAAC,OAAO,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACjC,MAAM;MACR,KAAK,OAAO;QACV,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAC/B,SAAS,CAAC,gBAAgB,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAC1C,MAAM;MACR;QACE,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACnC,MAAM;KACT;GACF;EACD,OAAO,SAAS,CAAC;CAClB,CAAC;;;AAGF,QAAQ,CAAC,cAAc,GAAG,SAAS,SAAS,EAAE;EAC5C,IAAI,GAAG,GAAG,EAAE,CAAC;EACb,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;EAC/B,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;EAC9B,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;EAC3C,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;EAC7B,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;EACvB,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;;EAEzB,IAAI,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC;EAC1B,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAChB,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACf,IAAI,IAAI,KAAK,MAAM,IAAI,SAAS,CAAC,cAAc;MAC3C,SAAS,CAAC,WAAW,EAAE;IACzB,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAClB,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;IACnC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAClB,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;GACjC;EACD,IAAI,SAAS,CAAC,OAAO,IAAI,SAAS,CAAC,QAAQ,CAAC,WAAW,EAAE,KAAK,KAAK,EAAE;IACnE,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACpB,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;GAC7B;EACD,IAAI,SAAS,CAAC,KAAK,EAAE;IACnB,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAClB,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;GAC3B;EACD,OAAO,YAAY,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;CACrC,CAAC;;;;AAIF,QAAQ,CAAC,eAAe,GAAG,SAAS,IAAI,EAAE;EACxC,OAAO,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EACnC;;;;AAID,QAAQ,CAAC,WAAW,GAAG,SAAS,IAAI,EAAE;EACpC,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EACtC,IAAI,MAAM,GAAG;IACX,WAAW,EAAE,QAAQ,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,EAAE,CAAC;GACzC,CAAC;;EAEF,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;;EAE5B,MAAM,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;EACvB,MAAM,CAAC,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;;EAE1C,MAAM,CAAC,WAAW,GAAG,KAAK,CAAC,MAAM,KAAK,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC;EACrE,OAAO,MAAM,CAAC;CACf,CAAC;;;;AAIF,QAAQ,CAAC,WAAW,GAAG,SAAS,KAAK,EAAE;EACrC,IAAI,EAAE,GAAG,KAAK,CAAC,WAAW,CAAC;EAC3B,IAAI,KAAK,CAAC,oBAAoB,KAAK,SAAS,EAAE;IAC5C,EAAE,GAAG,KAAK,CAAC,oBAAoB,CAAC;GACjC;EACD,OAAO,WAAW,GAAG,EAAE,GAAG,GAAG,GAAG,KAAK,CAAC,IAAI,GAAG,GAAG,GAAG,KAAK,CAAC,SAAS;OAC7D,KAAK,CAAC,WAAW,KAAK,CAAC,GAAG,GAAG,GAAG,KAAK,CAAC,WAAW,GAAG,EAAE,CAAC,GAAG,MAAM,CAAC;CACvE,CAAC;;;;;AAKF,QAAQ,CAAC,WAAW,GAAG,SAAS,IAAI,EAAE;EACpC,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EACtC,OAAO;IACL,EAAE,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAC1B,SAAS,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,UAAU;IAC1E,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC;GACd,CAAC;CACH,CAAC;;;;AAIF,QAAQ,CAAC,WAAW,GAAG,SAAS,eAAe,EAAE;EAC/C,OAAO,WAAW,IAAI,eAAe,CAAC,EAAE,IAAI,eAAe,CAAC,WAAW,CAAC;OACnE,eAAe,CAAC,SAAS,IAAI,eAAe,CAAC,SAAS,KAAK,UAAU;YAChE,GAAG,GAAG,eAAe,CAAC,SAAS;YAC/B,EAAE,CAAC;MACT,GAAG,GAAG,eAAe,CAAC,GAAG,GAAG,MAAM,CAAC;CACxC,CAAC;;;;;AAKF,QAAQ,CAAC,SAAS,GAAG,SAAS,IAAI,EAAE;EAClC,IAAI,MAAM,GAAG,EAAE,CAAC;EAChB,IAAI,EAAE,CAAC;EACP,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EAC1D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;IACrC,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAChC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;GAC9B;EACD,OAAO,MAAM,CAAC;CACf,CAAC;;;AAGF,QAAQ,CAAC,SAAS,GAAG,SAAS,KAAK,EAAE;EACnC,IAAI,IAAI,GAAG,EAAE,CAAC;EACd,IAAI,EAAE,GAAG,KAAK,CAAC,WAAW,CAAC;EAC3B,IAAI,KAAK,CAAC,oBAAoB,KAAK,SAAS,EAAE;IAC5C,EAAE,GAAG,KAAK,CAAC,oBAAoB,CAAC;GACjC;EACD,IAAI,KAAK,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,MAAM,EAAE;IAC5D,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;MACpD,MAAM,CAAC,IAAI,CAAC,KAAK,GAAG,GAAG,GAAG,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;KACpD,CAAC,CAAC;IACH,IAAI,IAAI,SAAS,GAAG,EAAE,GAAG,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;GAC1D;EACD,OAAO,IAAI,CAAC;CACb,CAAC;;;;AAIF,QAAQ,CAAC,WAAW,GAAG,SAAS,IAAI,EAAE;EACpC,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EAC1D,OAAO;IACL,IAAI,EAAE,KAAK,CAAC,KAAK,EAAE;IACnB,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC;GAC3B,CAAC;CACH,CAAC;;AAEF,QAAQ,CAAC,WAAW,GAAG,SAAS,KAAK,EAAE;EACrC,IAAI,KAAK,GAAG,EAAE,CAAC;EACf,IAAI,EAAE,GAAG,KAAK,CAAC,WAAW,CAAC;EAC3B,IAAI,KAAK,CAAC,oBAAoB,KAAK,SAAS,EAAE;IAC5C,EAAE,GAAG,KAAK,CAAC,oBAAoB,CAAC;GACjC;EACD,IAAI,KAAK,CAAC,YAAY,IAAI,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE;;IAEnD,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,EAAE,EAAE;MACtC,KAAK,IAAI,YAAY,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,CAAC,IAAI;OACzC,EAAE,CAAC,SAAS,IAAI,EAAE,CAAC,SAAS,CAAC,MAAM,GAAG,GAAG,GAAG,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC;UAC3D,MAAM,CAAC;KACZ,CAAC,CAAC;GACJ;EACD,OAAO,KAAK,CAAC;CACd,CAAC;;;;AAIF,QAAQ,CAAC,cAAc,GAAG,SAAS,IAAI,EAAE;EACvC,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;EAC3B,IAAI,KAAK,GAAG;IACV,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;GAC3C,CAAC;EACF,IAAI,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;EAClC,IAAI,KAAK,GAAG,CAAC,CAAC,EAAE;IACd,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;IACtD,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;GACtC,MAAM;IACL,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;GACvC;EACD,OAAO,KAAK,CAAC;CACd,CAAC;;;;AAIF,QAAQ,CAAC,MAAM,GAAG,SAAS,YAAY,EAAE;EACvC,IAAI,GAAG,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;EAC1D,IAAI,GAAG,EAAE;IACP,OAAO,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;GACtB;EACF;;AAED,QAAQ,CAAC,gBAAgB,GAAG,SAAS,IAAI,EAAE;EACzC,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EACvC,OAAO;IACL,SAAS,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE;IACjC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC;GAChB,CAAC;CACH,CAAC;;;;;AAKF,QAAQ,CAAC,iBAAiB,GAAG,SAAS,YAAY,EAAE,WAAW,EAAE;EAC/D,IAAI,KAAK,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,GAAG,WAAW;MACvD,gBAAgB,CAAC,CAAC;;;EAGtB,OAAO;IACL,IAAI,EAAE,MAAM;IACZ,YAAY,EAAE,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,gBAAgB,CAAC;GACnD,CAAC;CACH,CAAC;;;AAGF,QAAQ,CAAC,mBAAmB,GAAG,SAAS,MAAM,EAAE,SAAS,EAAE;EACzD,IAAI,GAAG,GAAG,UAAU,GAAG,SAAS,GAAG,MAAM,CAAC;EAC1C,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,EAAE,EAAE;IACvC,GAAG,IAAI,gBAAgB,GAAG,EAAE,CAAC,SAAS,GAAG,GAAG,GAAG,EAAE,CAAC,KAAK,GAAG,MAAM,CAAC;GAClE,CAAC,CAAC;EACH,OAAO,GAAG,CAAC;CACZ,CAAC;;;;AAIF,QAAQ,CAAC,gBAAgB,GAAG,SAAS,YAAY,EAAE,WAAW,EAAE;EAC9D,IAAI,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;;EAE9C,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC;EACvD,IAAI,aAAa,GAAG;IAClB,gBAAgB,EAAE,KAAK,CAAC,MAAM,CAAC,SAAS,IAAI,EAAE;MAC5C,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;KAC3C,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC;IAChB,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,SAAS,IAAI,EAAE;MACpC,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;KACzC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC;GACjB,CAAC;EACF,OAAO,aAAa,CAAC;CACtB,CAAC;;;AAGF,QAAQ,CAAC,kBAAkB,GAAG,SAAS,MAAM,EAAE;EAC7C,OAAO,cAAc,GAAG,MAAM,CAAC,gBAAgB,GAAG,MAAM;MACpD,YAAY,GAAG,MAAM,CAAC,QAAQ,GAAG,MAAM,CAAC;CAC7C,CAAC;;;AAGF,QAAQ,CAAC,kBAAkB,GAAG,SAAS,YAAY,EAAE;EACnD,IAAI,WAAW,GAAG;IAChB,MAAM,EAAE,EAAE;IACV,gBAAgB,EAAE,EAAE;IACpB,aAAa,EAAE,EAAE;IACjB,IAAI,EAAE,EAAE;GACT,CAAC;EACF,IAAI,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;EAC9C,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EAChC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;IACrC,IAAI,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IAClB,IAAI,UAAU,GAAG,QAAQ,CAAC,WAAW;QACjC,YAAY,EAAE,WAAW,GAAG,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7C,IAAI,UAAU,EAAE;MACd,IAAI,KAAK,GAAG,QAAQ,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;MAC7C,IAAI,KAAK,GAAG,QAAQ,CAAC,WAAW;UAC5B,YAAY,EAAE,SAAS,GAAG,EAAE,GAAG,GAAG,CAAC,CAAC;;MAExC,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC,MAAM,GAAG,QAAQ,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;MACpE,KAAK,CAAC,YAAY,GAAG,QAAQ,CAAC,WAAW;UACrC,YAAY,EAAE,YAAY,GAAG,EAAE,GAAG,GAAG,CAAC;SACvC,GAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;MAC7B,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;MAE/B,QAAQ,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE;QAC9B,KAAK,KAAK,CAAC;QACX,KAAK,QAAQ;UACX,WAAW,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;UACzD,MAAM;QACR;UACE,MAAM;OACT;KACF;GACF;EACD,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE;IACrE,WAAW,CAAC,gBAAgB,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC;GAC/D,CAAC,CAAC;;EAEH,OAAO,WAAW,CAAC;CACpB,CAAC;;;;AAIF,QAAQ,CAAC,mBAAmB,GAAG,SAAS,IAAI,EAAE,IAAI,EAAE;EAClD,IAAI,GAAG,GAAG,EAAE,CAAC;;;EAGb,GAAG,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,CAAC;EACzB,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC;EAC1C,GAAG,IAAI,qBAAqB,CAAC;EAC7B,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,SAAS,KAAK,EAAE;IACrC,IAAI,KAAK,CAAC,oBAAoB,KAAK,SAAS,EAAE;MAC5C,OAAO,KAAK,CAAC,oBAAoB,CAAC;KACnC;IACD,OAAO,KAAK,CAAC,WAAW,CAAC;GAC1B,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;;EAEtB,GAAG,IAAI,sBAAsB,CAAC;EAC9B,GAAG,IAAI,6BAA6B,CAAC;;;EAGrC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;IAClC,GAAG,IAAI,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;IACnC,GAAG,IAAI,QAAQ,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACjC,GAAG,IAAI,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;GACpC,CAAC,CAAC;EACH,IAAI,QAAQ,GAAG,CAAC,CAAC;EACjB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;IAClC,IAAI,KAAK,CAAC,QAAQ,GAAG,QAAQ,EAAE;MAC7B,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;KAC3B;GACF,CAAC,CAAC;EACH,IAAI,QAAQ,GAAG,CAAC,EAAE;IAChB,GAAG,IAAI,aAAa,GAAG,QAAQ,GAAG,MAAM,CAAC;GAC1C;EACD,GAAG,IAAI,gBAAgB,CAAC;;EAExB,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,SAAS,SAAS,EAAE;IAChD,GAAG,IAAI,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;GACxC,CAAC,CAAC;;EAEH,OAAO,GAAG,CAAC;CACZ,CAAC;;;;AAIF,QAAQ,CAAC,0BAA0B,GAAG,SAAS,YAAY,EAAE;EAC3D,IAAI,kBAAkB,GAAG,EAAE,CAAC;EAC5B,IAAI,WAAW,GAAG,QAAQ,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;EAC5D,IAAI,MAAM,GAAG,WAAW,CAAC,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;EAC7D,IAAI,SAAS,GAAG,WAAW,CAAC,aAAa,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;;;EAGnE,IAAI,KAAK,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,SAAS,CAAC;GACxD,GAAG,CAAC,SAAS,IAAI,EAAE;IAClB,OAAO,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;GACtC,CAAC;GACD,MAAM,CAAC,SAAS,KAAK,EAAE;IACtB,OAAO,KAAK,CAAC,SAAS,KAAK,OAAO,CAAC;GACpC,CAAC,CAAC;EACH,IAAI,WAAW,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACpD,IAAI,aAAa,CAAC;;EAElB,IAAI,KAAK,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,kBAAkB,CAAC;GACjE,GAAG,CAAC,SAAS,IAAI,EAAE;IAClB,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC5B,KAAK,CAAC,KAAK,EAAE,CAAC;IACd,OAAO,KAAK,CAAC,GAAG,CAAC,SAAS,IAAI,EAAE;MAC9B,OAAO,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;KAC3B,CAAC,CAAC;GACJ,CAAC,CAAC;EACH,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,WAAW,EAAE;IAC1E,aAAa,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;GAC7B;;EAED,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;IACzC,IAAI,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE,KAAK,KAAK,IAAI,KAAK,CAAC,UAAU,CAAC,GAAG,EAAE;MAC9D,IAAI,QAAQ,GAAG;QACb,IAAI,EAAE,WAAW;QACjB,gBAAgB,EAAE,QAAQ,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,EAAE,EAAE,CAAC;QACpD,GAAG,EAAE;UACH,IAAI,EAAE,aAAa;SACpB;OACF,CAAC;MACF,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;MAClC,IAAI,MAAM,EAAE;QACV,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;QAChD,QAAQ,CAAC,GAAG,GAAG;UACb,IAAI,EAAE,aAAa;UACnB,SAAS,EAAE,SAAS,GAAG,YAAY,GAAG,KAAK;SAC5C,CAAC;QACF,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;OACnC;KACF;GACF,CAAC,CAAC;EACH,IAAI,kBAAkB,CAAC,MAAM,KAAK,CAAC,IAAI,WAAW,EAAE;IAClD,kBAAkB,CAAC,IAAI,CAAC;MACtB,IAAI,EAAE,WAAW;KAClB,CAAC,CAAC;GACJ;;;EAGD,IAAI,SAAS,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;EACzD,IAAI,SAAS,CAAC,MAAM,EAAE;IACpB,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;MACzC,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;KAClD,MAAM,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;;MAE9C,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,IAAI,GAAG,IAAI;aACvD,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;KACrB,MAAM;MACL,SAAS,GAAG,SAAS,CAAC;KACvB;IACD,kBAAkB,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;MAC1C,MAAM,CAAC,UAAU,GAAG,SAAS,CAAC;KAC/B,CAAC,CAAC;GACJ;EACD,OAAO,kBAAkB,CAAC;CAC3B,CAAC;;;AAGF,QAAQ,CAAC,mBAAmB,GAAG,SAAS,YAAY,EAAE;EACpD,IAAI,cAAc,GAAG,EAAE,CAAC;;EAExB,AAGA,IAAI,UAAU,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,SAAS,CAAC;OACzD,GAAG,CAAC,SAAS,IAAI,EAAE;QAClB,OAAO,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;OACtC,CAAC;OACD,MAAM,CAAC,SAAS,GAAG,EAAE;QACpB,OAAO,GAAG,CAAC,SAAS,KAAK,OAAO,CAAC;OAClC,CAAC,CAAC,CAAC,CAAC,CAAC;EACV,IAAI,UAAU,EAAE;IACd,cAAc,CAAC,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;IACxC,cAAc,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC;GACvC;;;;EAID,IAAI,KAAK,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC;EAC/D,cAAc,CAAC,WAAW,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;EAC9C,cAAc,CAAC,QAAQ,GAAG,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC;;;;EAI7C,IAAI,GAAG,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,YAAY,CAAC,CAAC;EAC3D,cAAc,CAAC,GAAG,GAAG,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC;;EAEpC,OAAO,cAAc,CAAC;CACvB,CAAC;;;;AAIF,QAAQ,CAAC,SAAS,GAAG,SAAS,YAAY,EAAE;EAC1C,IAAI,KAAK,CAAC;EACV,IAAI,IAAI,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;EACzD,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;IACrB,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACrC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;GAC5C;EACD,IAAI,KAAK,GAAG,QAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,SAAS,CAAC;GACxD,GAAG,CAAC,SAAS,IAAI,EAAE;IAClB,OAAO,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;GACtC,CAAC;GACD,MAAM,CAAC,SAAS,KAAK,EAAE;IACtB,OAAO,KAAK,CAAC,SAAS,KAAK,MAAM,CAAC;GACnC,CAAC,CAAC;EACH,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;IACpB,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAClC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;GAC5C;CACF,CAAC;;;;;;AAMF,QAAQ,CAAC,iBAAiB,GAAG,WAAW;EACtC,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;CAC/C,CAAC;;;;;;AAMF,QAAQ,CAAC,uBAAuB,GAAG,SAAS,MAAM,EAAE,OAAO,EAAE;EAC3D,IAAI,SAAS,CAAC;EACd,IAAI,OAAO,GAAG,OAAO,KAAK,SAAS,GAAG,OAAO,GAAG,CAAC,CAAC;EAClD,IAAI,MAAM,EAAE;IACV,SAAS,GAAG,MAAM,CAAC;GACpB,MAAM;IACL,SAAS,GAAG,QAAQ,CAAC,iBAAiB,EAAE,CAAC;GAC1C;;EAED,OAAO,SAAS;MACZ,sBAAsB,GAAG,SAAS,GAAG,GAAG,GAAG,OAAO,GAAG,uBAAuB;MAC5E,SAAS;MACT,WAAW,CAAC;CACjB,CAAC;;AAEF,QAAQ,CAAC,iBAAiB,GAAG,SAAS,WAAW,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE;EACrE,IAAI,GAAG,GAAG,QAAQ,CAAC,mBAAmB,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;;;EAG/D,GAAG,IAAI,QAAQ,CAAC,kBAAkB;MAC9B,WAAW,CAAC,WAAW,CAAC,kBAAkB,EAAE,CAAC,CAAC;;;EAGlD,GAAG,IAAI,QAAQ,CAAC,mBAAmB;MAC/B,WAAW,CAAC,aAAa,CAAC,kBAAkB,EAAE;MAC9C,IAAI,KAAK,OAAO,GAAG,SAAS,GAAG,QAAQ,CAAC,CAAC;;EAE7C,GAAG,IAAI,QAAQ,GAAG,WAAW,CAAC,GAAG,GAAG,MAAM,CAAC;;EAE3C,IAAI,WAAW,CAAC,SAAS,EAAE;IACzB,GAAG,IAAI,IAAI,GAAG,WAAW,CAAC,SAAS,GAAG,MAAM,CAAC;GAC9C,MAAM,IAAI,WAAW,CAAC,SAAS,IAAI,WAAW,CAAC,WAAW,EAAE;IAC3D,GAAG,IAAI,gBAAgB,CAAC;GACzB,MAAM,IAAI,WAAW,CAAC,SAAS,EAAE;IAChC,GAAG,IAAI,gBAAgB,CAAC;GACzB,MAAM,IAAI,WAAW,CAAC,WAAW,EAAE;IAClC,GAAG,IAAI,gBAAgB,CAAC;GACzB,MAAM;IACL,GAAG,IAAI,gBAAgB,CAAC;GACzB;;EAED,IAAI,WAAW,CAAC,SAAS,EAAE;;IAEzB,IAAI,IAAI,GAAG,OAAO,GAAG,MAAM,CAAC,EAAE,GAAG,GAAG;QAChC,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE,GAAG,MAAM,CAAC;IAC5C,GAAG,IAAI,IAAI,GAAG,IAAI,CAAC;;;IAGnB,GAAG,IAAI,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI;QACzD,GAAG,GAAG,IAAI,CAAC;IACf,IAAI,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;MAC7C,GAAG,IAAI,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI;UAC7D,GAAG,GAAG,IAAI,CAAC;MACf,GAAG,IAAI,mBAAmB;UACtB,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG;UAChD,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI;UAC9C,MAAM,CAAC;KACZ;GACF;;EAED,GAAG,IAAI,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI;MACzD,SAAS,GAAG,QAAQ,CAAC,UAAU,GAAG,MAAM,CAAC;EAC7C,IAAI,WAAW,CAAC,SAAS,IAAI,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;IACtE,GAAG,IAAI,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI;QAC7D,SAAS,GAAG,QAAQ,CAAC,UAAU,GAAG,MAAM,CAAC;GAC9C;EACD,OAAO,GAAG,CAAC;CACZ,CAAC;;;AAGF,QAAQ,CAAC,YAAY,GAAG,SAAS,YAAY,EAAE,WAAW,EAAE;;EAE1D,IAAI,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;EAC9C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;IACrC,QAAQ,KAAK,CAAC,CAAC,CAAC;MACd,KAAK,YAAY,CAAC;MAClB,KAAK,YAAY,CAAC;MAClB,KAAK,YAAY,CAAC;MAClB,KAAK,YAAY;QACf,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;MAC5B,QAAQ;;KAET;GACF;EACD,IAAI,WAAW,EAAE;IACf,OAAO,QAAQ,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;GAC3C;EACD,OAAO,UAAU,CAAC;CACnB,CAAC;;AAEF,QAAQ,CAAC,OAAO,GAAG,SAAS,YAAY,EAAE;EACxC,IAAI,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;EAC9C,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EAChC,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;CAC3B,CAAC;;AAEF,QAAQ,CAAC,UAAU,GAAG,SAAS,YAAY,EAAE;EAC3C,OAAO,YAAY,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC;CAC9C,CAAC;;AAEF,QAAQ,CAAC,UAAU,GAAG,SAAS,YAAY,EAAE;EAC3C,IAAI,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;EAC9C,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EAChC,OAAO;IACL,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;IACxB,IAAI,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAC5B,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC;IAClB,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC;GAC9B,CAAC;CACH,CAAC;;;AAGF,AAAgC;EAC9B,cAAc,GAAG,QAAQ,CAAC;CAC3B;;;AC7nBD,SAAS,iBAAiB,CAAC,WAAW,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE;EACpE,IAAIC,MAAG,GAAGC,GAAQ,CAAC,mBAAmB,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;;;EAG/DD,MAAG,IAAIC,GAAQ,CAAC,kBAAkB;MAC9B,WAAW,CAAC,WAAW,CAAC,kBAAkB,EAAE,CAAC,CAAC;;;EAGlDD,MAAG,IAAIC,GAAQ,CAAC,mBAAmB;MAC/B,WAAW,CAAC,aAAa,CAAC,kBAAkB,EAAE;MAC9C,IAAI,KAAK,OAAO,GAAG,SAAS,GAAG,QAAQ,IAAI,QAAQ,CAAC,CAAC;;EAEzDD,MAAG,IAAI,QAAQ,GAAG,WAAW,CAAC,GAAG,GAAG,MAAM,CAAC;;EAE3C,IAAI,WAAW,CAAC,SAAS,IAAI,WAAW,CAAC,WAAW,EAAE;IACpDA,MAAG,IAAI,gBAAgB,CAAC;GACzB,MAAM,IAAI,WAAW,CAAC,SAAS,EAAE;IAChCA,MAAG,IAAI,gBAAgB,CAAC;GACzB,MAAM,IAAI,WAAW,CAAC,WAAW,EAAE;IAClCA,MAAG,IAAI,gBAAgB,CAAC;GACzB,MAAM;IACLA,MAAG,IAAI,gBAAgB,CAAC;GACzB;;EAED,IAAI,WAAW,CAAC,SAAS,EAAE;;IAEzB,IAAI,IAAI,GAAG,OAAO,GAAG,MAAM,CAAC,EAAE,GAAG,GAAG;QAChC,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE,GAAG,MAAM,CAAC;IAC5CA,MAAG,IAAI,IAAI,GAAG,IAAI,CAAC;;;IAGnBA,MAAG,IAAI,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI;QACzD,GAAG,GAAG,IAAI,CAAC;IACf,IAAI,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;MAC7CA,MAAG,IAAI,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI;UAC7D,GAAG,GAAG,IAAI,CAAC;MACfA,MAAG,IAAI,mBAAmB;UACtB,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG;UAChD,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI;UAC9C,MAAM,CAAC;KACZ;GACF;;EAEDA,MAAG,IAAI,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI;MACzD,SAAS,GAAGC,GAAQ,CAAC,UAAU,GAAG,MAAM,CAAC;EAC7C,IAAI,WAAW,CAAC,SAAS,IAAI,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;IACtED,MAAG,IAAI,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI;QAC7D,SAAS,GAAGC,GAAQ,CAAC,UAAU,GAAG,MAAM,CAAC;GAC9C;EACD,OAAOD,MAAG,CAAC;CACZ;;;;;;;AAOD,SAAS,gBAAgB,CAAC,UAAU,EAAE,WAAW,EAAE;EACjD,IAAI,OAAO,GAAG,KAAK,CAAC;EACpB,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;EACpD,OAAO,UAAU,CAAC,MAAM,CAAC,SAAS,MAAM,EAAE;IACxC,IAAI,MAAM,KAAK,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,GAAG,CAAC,EAAE;MACzC,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,GAAG,CAAC;MACrC,IAAI,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;QAC9B,OAAO,CAAC,IAAI,CAAC,mDAAmD,CAAC,CAAC;OACnE;MACD,IAAI,QAAQ,GAAG,OAAO,IAAI,KAAK,QAAQ,CAAC;MACxC,IAAI,QAAQ,EAAE;QACZ,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC;OACf;MACD,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,EAAE;QAC/B,IAAI,SAAS,GAAG,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC;YACtC,GAAG,CAAC,OAAO,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;YACnC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YAC5B,CAAC,OAAO,CAAC;;QAEb,IAAI,SAAS,EAAE;UACb,OAAO,GAAG,IAAI,CAAC;UACf,OAAO,IAAI,CAAC;SACb;QACD,OAAO,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,WAAW,IAAI,KAAK;YACrD,GAAG,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC;OAC1C,CAAC,CAAC;;MAEH,OAAO,MAAM,CAAC,GAAG,CAAC;MAClB,MAAM,CAAC,IAAI,GAAG,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;MACxC,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;KACtB;GACF,CAAC,CAAC;CACJ;;;AAGD,SAAS,qBAAqB,CAAC,iBAAiB,EAAE,kBAAkB,EAAE;EACpE,IAAI,kBAAkB,GAAG;IACvB,MAAM,EAAE,EAAE;IACV,gBAAgB,EAAE,EAAE;IACpB,aAAa,EAAE,EAAE;GAClB,CAAC;;EAEF,IAAI,sBAAsB,GAAG,SAAS,EAAE,EAAE,MAAM,EAAE;IAChD,EAAE,GAAG,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IACtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;MACtC,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,KAAK,EAAE;UAC5B,MAAM,CAAC,CAAC,CAAC,CAAC,oBAAoB,KAAK,EAAE,EAAE;QACzC,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC;OAClB;KACF;GACF,CAAC;;EAEF,IAAI,oBAAoB,GAAG,SAAS,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE;IAChE,IAAI,MAAM,GAAG,sBAAsB,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;IAClE,IAAI,MAAM,GAAG,sBAAsB,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;IAClE,OAAO,MAAM,IAAI,MAAM;QACnB,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,KAAK,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;GAC7D,CAAC;;EAEF,iBAAiB,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;IAChD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,kBAAkB,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;MACzD,IAAI,MAAM,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;MAC1C,IAAI,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,KAAK,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE;UACvD,MAAM,CAAC,SAAS,KAAK,MAAM,CAAC,SAAS,EAAE;QACzC,IAAI,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,KAAK,KAAK;YACnC,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,UAAU,CAAC,GAAG,EAAE;;;UAG9C,IAAI,CAAC,oBAAoB,CAAC,MAAM,EAAE,MAAM;cACpC,iBAAiB,CAAC,MAAM,EAAE,kBAAkB,CAAC,MAAM,CAAC,EAAE;YACxD,SAAS;WACV;SACF;QACD,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;;QAE5C,MAAM,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,WAAW;YAC5C,MAAM,CAAC,WAAW,CAAC,CAAC;;QAExB,kBAAkB,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;;;QAGvC,MAAM,CAAC,YAAY,GAAG,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE;UAC5D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACnD,IAAI,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,EAAE,CAAC,IAAI;gBACvC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,SAAS,KAAK,EAAE,CAAC,SAAS,EAAE;cACrD,OAAO,IAAI,CAAC;aACb;WACF;UACD,OAAO,KAAK,CAAC;SACd,CAAC,CAAC;;;QAGH,MAAM;OACP;KACF;GACF,CAAC,CAAC;;EAEH,iBAAiB,CAAC,gBAAgB,CAAC,OAAO,CAAC,SAAS,gBAAgB,EAAE;IACpE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,kBAAkB,CAAC,gBAAgB,CAAC,MAAM;SACzD,CAAC,EAAE,EAAE;MACR,IAAI,gBAAgB,GAAG,kBAAkB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;MAC9D,IAAI,gBAAgB,CAAC,GAAG,KAAK,gBAAgB,CAAC,GAAG,EAAE;QACjD,kBAAkB,CAAC,gBAAgB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAC3D,MAAM;OACP;KACF;GACF,CAAC,CAAC;;;EAGH,OAAO,kBAAkB,CAAC;CAC3B;;;AAGD,SAAS,+BAA+B,CAAC,MAAM,EAAE,IAAI,EAAE,cAAc,EAAE;EACrE,OAAO;IACL,KAAK,EAAE;MACL,mBAAmB,EAAE,CAAC,QAAQ,EAAE,kBAAkB,CAAC;MACnD,oBAAoB,EAAE,CAAC,QAAQ,EAAE,mBAAmB,CAAC;KACtD;IACD,MAAM,EAAE;MACN,mBAAmB,EAAE,CAAC,mBAAmB,EAAE,qBAAqB,CAAC;MACjE,oBAAoB,EAAE,CAAC,kBAAkB,EAAE,sBAAsB,CAAC;KACnE;GACF,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC;CAChD;;AAED,SAAS,iBAAiB,CAAC,YAAY,EAAE,SAAS,EAAE;;;EAGlD,IAAI,YAAY,GAAG,YAAY,CAAC,mBAAmB,EAAE;OAChD,IAAI,CAAC,SAAS,eAAe,EAAE;QAC9B,OAAO,SAAS,CAAC,UAAU,KAAK,eAAe,CAAC,UAAU;YACtD,SAAS,CAAC,EAAE,KAAK,eAAe,CAAC,EAAE;YACnC,SAAS,CAAC,IAAI,KAAK,eAAe,CAAC,IAAI;YACvC,SAAS,CAAC,QAAQ,KAAK,eAAe,CAAC,QAAQ;YAC/C,SAAS,CAAC,QAAQ,KAAK,eAAe,CAAC,QAAQ;YAC/C,SAAS,CAAC,IAAI,KAAK,eAAe,CAAC,IAAI,CAAC;OAC7C,CAAC,CAAC;EACP,IAAI,CAAC,YAAY,EAAE;IACjB,YAAY,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;GAC5C;EACD,OAAO,CAAC,YAAY,CAAC;CACtB;;;;;;AAMD,SAAS,4BAA4B,CAAC,KAAK,EAAE,MAAM,EAAE;EACnD,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;EACvB,IAAI,CAAC,GAAG,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;EAC9B,CAAC,CAAC,KAAK,GAAG,KAAK,CAAC;EAChB,MAAM,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;CACzB;;AAED,SAAS,iCAAiC,CAAC,KAAK,EAAE,MAAM,EAAE;EACxD,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;EAC1B,IAAI,CAAC,GAAG,IAAI,KAAK,CAAC,aAAa,CAAC,CAAC;EACjC,CAAC,CAAC,KAAK,GAAG,KAAK,CAAC;EAChB,MAAM,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;CACzB;;AAED,qBAAc,GAAG,SAAS,MAAM,EAAE,WAAW,EAAE;EAC7C,IAAI,iBAAiB,GAAG,SAAS,MAAM,EAAE;IACvC,IAAI,IAAI,GAAG,IAAI,CAAC;;IAEhB,IAAI,YAAY,GAAG,QAAQ,CAAC,sBAAsB,EAAE,CAAC;IACrD,CAAC,kBAAkB,EAAE,qBAAqB,EAAE,eAAe,CAAC;SACvD,OAAO,CAAC,SAAS,MAAM,EAAE;UACxB,IAAI,CAAC,MAAM,CAAC,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SACxD,CAAC,CAAC;;IAEP,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IAC3B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IACxB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IACpB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IAC3B,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;IACnC,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC;IACvC,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;IACtC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;IAChC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;IAC1B,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;;IAEpC,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;;IAE7B,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;IACvB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;;IAExB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;IAC7B,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;;IAE9B,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;IAC/B,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;IAChC,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;;IAE/B,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,EAAE,CAAC,CAAC,CAAC;;IAElD,IAAI,CAAC,WAAW,GAAG,MAAM,CAAC,YAAY,KAAK,YAAY,CAAC;IACxD,IAAI,MAAM,CAAC,aAAa,KAAK,WAAW,EAAE;MACxC,IAAI,CAAC,GAAG,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;MAClE,CAAC,CAAC,IAAI,GAAG,mBAAmB,CAAC;MAC7B,MAAM,CAAC,EAAE;KACV,MAAM,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE;MAChC,MAAM,CAAC,aAAa,GAAG,SAAS,CAAC;KAClC;;IAED,QAAQ,MAAM,CAAC,kBAAkB;MAC/B,KAAK,KAAK,CAAC;MACX,KAAK,OAAO;QACV,MAAM;MACR;QACE,MAAM,CAAC,kBAAkB,GAAG,KAAK,CAAC;QAClC,MAAM;KACT;;IAED,QAAQ,MAAM,CAAC,YAAY;MACzB,KAAK,UAAU,CAAC;MAChB,KAAK,YAAY,CAAC;MAClB,KAAK,YAAY;QACf,MAAM;MACR;QACE,MAAM,CAAC,YAAY,GAAG,UAAU,CAAC;QACjC,MAAM;KACT;;IAED,MAAM,CAAC,UAAU,GAAG,gBAAgB,CAAC,MAAM,CAAC,UAAU,IAAI,EAAE,EAAE,WAAW,CAAC,CAAC;;IAE3E,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;IACxB,IAAI,MAAM,CAAC,oBAAoB,EAAE;MAC/B,KAAK,IAAI,CAAC,GAAG,MAAM,CAAC,oBAAoB,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;QACpD,IAAI,CAAC,aAAa,GAAG,IAAI,MAAM,CAAC,cAAc,CAAC;UAC7C,UAAU,EAAE,MAAM,CAAC,UAAU;UAC7B,YAAY,EAAE,MAAM,CAAC,kBAAkB;SACxC,CAAC,CAAC;OACJ;KACF,MAAM;MACL,MAAM,CAAC,oBAAoB,GAAG,CAAC,CAAC;KACjC;;IAED,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;;;;IAItB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;;IAEvB,IAAI,CAAC,aAAa,GAAGC,GAAQ,CAAC,iBAAiB,EAAE,CAAC;IAClD,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC;;IAE5B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;GAC5B,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,yBAAyB,GAAG,WAAW;IACjE,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;IACjD,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAC1B,IAAI,OAAO,IAAI,CAAC,yBAAyB,KAAK,UAAU,EAAE;MACxD,IAAI,CAAC,yBAAyB,CAAC,KAAK,CAAC,CAAC;KACvC;GACF,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,gBAAgB,GAAG,WAAW;IACxD,OAAO,IAAI,CAAC,OAAO,CAAC;GACrB,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,eAAe,GAAG,WAAW;IACvD,OAAO,IAAI,CAAC,YAAY,CAAC;GAC1B,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,gBAAgB,GAAG,WAAW;IACxD,OAAO,IAAI,CAAC,aAAa,CAAC;GAC3B,CAAC;;;;EAIF,iBAAiB,CAAC,SAAS,CAAC,kBAAkB,GAAG,SAAS,IAAI,EAAE;IAC9D,IAAI,kBAAkB,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC;IACtD,IAAI,WAAW,GAAG;MAChB,KAAK,EAAE,IAAI;MACX,WAAW,EAAE,IAAI;MACjB,YAAY,EAAE,IAAI;MAClB,aAAa,EAAE,IAAI;MACnB,iBAAiB,EAAE,IAAI;MACvB,kBAAkB,EAAE,IAAI;MACxB,SAAS,EAAE,IAAI;MACf,WAAW,EAAE,IAAI;MACjB,IAAI,EAAE,IAAI;MACV,GAAG,EAAE,IAAI;MACT,sBAAsB,EAAE,IAAI;MAC5B,sBAAsB,EAAE,IAAI;MAC5B,MAAM,EAAE,IAAI;MACZ,4BAA4B,EAAE,EAAE;MAChC,WAAW,EAAE,IAAI;KAClB,CAAC;IACF,IAAI,IAAI,CAAC,WAAW,IAAI,kBAAkB,EAAE;MAC1C,WAAW,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC;MAC7D,WAAW,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC;KAChE,MAAM;MACL,IAAI,UAAU,GAAG,IAAI,CAAC,2BAA2B,EAAE,CAAC;MACpD,WAAW,CAAC,YAAY,GAAG,UAAU,CAAC,YAAY,CAAC;MACnD,WAAW,CAAC,aAAa,GAAG,UAAU,CAAC,aAAa,CAAC;KACtD;IACD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IACpC,OAAO,WAAW,CAAC;GACpB,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,QAAQ,GAAG,SAAS,KAAK,EAAE,MAAM,EAAE;IAC7D,IAAI,WAAW,CAAC;IAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;MACjD,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK;UAC3B,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI,EAAE;QAC5C,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;OACpC;KACF;IACD,IAAI,CAAC,WAAW,EAAE;MAChB,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;KACnD;;IAED,IAAI,CAAC,2BAA2B,EAAE,CAAC;;IAEnC,IAAI,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;MAC5C,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;KAChC;;IAED,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC;IAC1B,WAAW,CAAC,MAAM,GAAG,MAAM,CAAC;IAC5B,WAAW,CAAC,SAAS,GAAG,IAAI,MAAM,CAAC,YAAY,CAAC,KAAK;QACjD,WAAW,CAAC,aAAa,CAAC,CAAC;IAC/B,OAAO,WAAW,CAAC,SAAS,CAAC;GAC9B,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,SAAS,GAAG,SAAS,MAAM,EAAE;IACvD,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,WAAW,IAAI,KAAK,EAAE;MACxB,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;QACzC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;OAC9B,CAAC,CAAC;KACJ,MAAM;;;;MAIL,IAAI,YAAY,GAAG,MAAM,CAAC,KAAK,EAAE,CAAC;MAClC,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE,GAAG,EAAE;QAC9C,IAAI,WAAW,GAAG,YAAY,CAAC,SAAS,EAAE,CAAC,GAAG,CAAC,CAAC;QAChD,KAAK,CAAC,gBAAgB,CAAC,SAAS,EAAE,SAAS,KAAK,EAAE;UAChD,WAAW,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;SACrC,CAAC,CAAC;OACJ,CAAC,CAAC;MACH,YAAY,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;QAC/C,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;OACpC,CAAC,CAAC;KACJ;GACF,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,WAAW,GAAG,SAAS,MAAM,EAAE;IACzD,IAAI,EAAE,MAAM,YAAY,MAAM,CAAC,YAAY,CAAC,EAAE;MAC5C,MAAM,IAAI,SAAS,CAAC,8CAA8C;UAC9D,4CAA4C,CAAC,CAAC;KACnD;;IAED,IAAI,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;MACnD,OAAO,CAAC,CAAC,SAAS,KAAK,MAAM,CAAC;KAC/B,CAAC,CAAC;;IAEH,IAAI,CAAC,WAAW,EAAE;MAChB,IAAI,GAAG,GAAG,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;MAClE,GAAG,CAAC,IAAI,GAAG,oBAAoB,CAAC;MAChC,MAAM,GAAG,CAAC;KACX;IACD,IAAI,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC;;IAEhC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;IAC7B,WAAW,CAAC,SAAS,GAAG,IAAI,CAAC;IAC7B,WAAW,CAAC,KAAK,GAAG,IAAI,CAAC;IACzB,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC;;;IAG1B,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;MACnD,OAAO,CAAC,CAAC,MAAM,CAAC;KACjB,CAAC,CAAC;IACH,IAAI,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QACnC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE;MAC1C,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;KAChE;;IAED,IAAI,CAAC,2BAA2B,EAAE,CAAC;GACpC,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,YAAY,GAAG,SAAS,MAAM,EAAE;IAC1D,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;MACzC,IAAI,MAAM,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;QAC9C,OAAO,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC;OAC1B,CAAC,CAAC;MACH,IAAI,MAAM,EAAE;QACV,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;OAC1B;KACF,CAAC,CAAC;GACJ,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,UAAU,GAAG,WAAW;IAClD,OAAO,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,SAAS,WAAW,EAAE;MACpD,OAAO,CAAC,CAAC,WAAW,CAAC,SAAS,CAAC;KAChC,CAAC;KACD,GAAG,CAAC,SAAS,WAAW,EAAE;MACzB,OAAO,WAAW,CAAC,SAAS,CAAC;KAC9B,CAAC,CAAC;GACJ,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,YAAY,GAAG,WAAW;IACpD,OAAO,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,SAAS,WAAW,EAAE;MACpD,OAAO,CAAC,CAAC,WAAW,CAAC,WAAW,CAAC;KAClC,CAAC;KACD,GAAG,CAAC,SAAS,WAAW,EAAE;MACzB,OAAO,WAAW,CAAC,WAAW,CAAC;KAChC,CAAC,CAAC;GACJ,CAAC;;;EAGF,iBAAiB,CAAC,SAAS,CAAC,kBAAkB,GAAG,SAAS,aAAa;MACnE,WAAW,EAAE;IACf,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,WAAW,IAAI,aAAa,GAAG,CAAC,EAAE;MACpC,OAAO,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;KACzC,MAAM,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE;MACpC,OAAO,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;KACnC;IACD,IAAI,WAAW,GAAG,IAAI,MAAM,CAAC,cAAc,CAAC;MAC1C,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,UAAU;MACnC,YAAY,EAAE,IAAI,CAAC,OAAO,CAAC,kBAAkB;KAC9C,CAAC,CAAC;IACH,MAAM,CAAC,cAAc,CAAC,WAAW,EAAE,OAAO;QACtC,CAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC;KACjC,CAAC;;IAEF,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,UAAU,GAAG,EAAE,CAAC;IACjD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,gBAAgB,GAAG,SAAS,KAAK,EAAE;MAClE,IAAI,GAAG,GAAG,CAAC,KAAK,CAAC,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;;;MAGxE,WAAW,CAAC,KAAK,GAAG,GAAG,GAAG,WAAW,GAAG,WAAW,CAAC;MACpD,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,UAAU,KAAK,IAAI,EAAE;QACxD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;OACnE;KACF,CAAC;IACF,WAAW,CAAC,gBAAgB,CAAC,gBAAgB;MAC3C,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,gBAAgB,CAAC,CAAC;IACrD,OAAO,WAAW,CAAC;GACpB,CAAC;;;EAGF,iBAAiB,CAAC,SAAS,CAAC,OAAO,GAAG,SAAS,GAAG,EAAE,aAAa,EAAE;IACjE,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,WAAW,CAAC;IAC/D,IAAI,WAAW,CAAC,gBAAgB,EAAE;MAChC,OAAO;KACR;IACD,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,UAAU,CAAC;IAC7D,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC;IACnD,WAAW,CAAC,mBAAmB,CAAC,gBAAgB;MAC9C,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,gBAAgB,CAAC,CAAC;IACrD,WAAW,CAAC,gBAAgB,GAAG,SAAS,GAAG,EAAE;MAC3C,IAAI,IAAI,CAAC,WAAW,IAAI,aAAa,GAAG,CAAC,EAAE;;;;QAIzC,OAAO;OACR;MACD,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,cAAc,CAAC,CAAC;MACtC,KAAK,CAAC,SAAS,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,aAAa,EAAE,aAAa,CAAC,CAAC;;MAE9D,IAAI,IAAI,GAAG,GAAG,CAAC,SAAS,CAAC;;MAEzB,IAAI,GAAG,GAAG,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;MAClD,IAAI,GAAG,EAAE;;;QAGP,IAAI,WAAW,CAAC,KAAK,KAAK,KAAK,IAAI,WAAW,CAAC,KAAK,KAAK,WAAW,EAAE;UACpE,WAAW,CAAC,KAAK,GAAG,WAAW,CAAC;SACjC;OACF,MAAM;QACL,IAAI,WAAW,CAAC,KAAK,KAAK,KAAK,EAAE;UAC/B,WAAW,CAAC,KAAK,GAAG,WAAW,CAAC;SACjC;;QAED,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACnB,KAAK,CAAC,SAAS,CAAC,SAAS,GAAGA,GAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;OAC3D;;;MAGD,IAAI,QAAQ,GAAGA,GAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;MACjE,IAAI,CAAC,GAAG,EAAE;QACR,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,aAAa,GAAG,CAAC,CAAC;YACvC,IAAI,GAAG,KAAK,CAAC,SAAS,CAAC,SAAS,GAAG,MAAM,CAAC;OAC/C,MAAM;QACL,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,aAAa,GAAG,CAAC,CAAC;YACvC,yBAAyB,CAAC;OAC/B;MACD,IAAI,CAAC,gBAAgB,CAAC,GAAG,GAAG,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;MAC9C,IAAI,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,SAAS,WAAW,EAAE;QAC3D,OAAO,WAAW,CAAC,WAAW;YAC1B,WAAW,CAAC,WAAW,CAAC,KAAK,KAAK,WAAW,CAAC;OACnD,CAAC,CAAC;;MAEH,IAAI,IAAI,CAAC,iBAAiB,KAAK,WAAW,EAAE;QAC1C,IAAI,CAAC,iBAAiB,GAAG,WAAW,CAAC;QACrC,IAAI,CAAC,yBAAyB,EAAE,CAAC;OAClC;;;;MAID,IAAI,CAAC,GAAG,EAAE;QACR,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC1B,IAAI,OAAO,IAAI,CAAC,cAAc,KAAK,UAAU,EAAE;UAC7C,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;SAC5B;OACF;MACD,IAAI,QAAQ,EAAE;QACZ,IAAI,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;QAC9C,IAAI,OAAO,IAAI,CAAC,cAAc,KAAK,UAAU,EAAE;UAC7C,IAAI,CAAC,cAAc,CAAC,IAAI,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;SAChD;QACD,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC;QACpC,IAAI,CAAC,yBAAyB,EAAE,CAAC;OAClC;KACF,CAAC;;;IAGF,MAAM,CAAC,UAAU,CAAC,WAAW;MAC3B,UAAU,CAAC,OAAO,CAAC,SAAS,SAAS,EAAE;QACrC,IAAI,CAAC,GAAG,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC;QACvC,CAAC,CAAC,SAAS,GAAG,SAAS,CAAC;QACxB,WAAW,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;OACjC,CAAC,CAAC;KACJ,EAAE,CAAC,CAAC,CAAC;GACP,CAAC;;;EAGF,iBAAiB,CAAC,SAAS,CAAC,2BAA2B,GAAG,WAAW;IACnE,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,YAAY,GAAG,IAAI,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IACpD,YAAY,CAAC,gBAAgB,GAAG,WAAW;MACzC,IAAI,CAAC,sBAAsB,EAAE,CAAC;KAC/B,CAAC;;IAEF,IAAI,aAAa,GAAG,IAAI,MAAM,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;IAC9D,aAAa,CAAC,iBAAiB,GAAG,WAAW;MAC3C,IAAI,CAAC,sBAAsB,EAAE,CAAC;KAC/B,CAAC;IACF,aAAa,CAAC,OAAO,GAAG,WAAW;;MAEjC,MAAM,CAAC,cAAc,CAAC,aAAa,EAAE,OAAO;UACxC,CAAC,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC;MACvC,IAAI,CAAC,sBAAsB,EAAE,CAAC;KAC/B,CAAC;;IAEF,OAAO;MACL,YAAY,EAAE,YAAY;MAC1B,aAAa,EAAE,aAAa;KAC7B,CAAC;GACH,CAAC;;;;EAIF,iBAAiB,CAAC,SAAS,CAAC,4BAA4B,GAAG;MACvD,aAAa,EAAE;IACjB,IAAI,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,WAAW,CAAC;IAC/D,IAAI,WAAW,EAAE;MACf,OAAO,WAAW,CAAC,gBAAgB,CAAC;MACpC,OAAO,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,WAAW,CAAC;KACrD;IACD,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC;IACjE,IAAI,YAAY,EAAE;MAChB,OAAO,YAAY,CAAC,gBAAgB,CAAC;MACrC,OAAO,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC;KACtD;IACD,IAAI,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,aAAa,CAAC;IACnE,IAAI,aAAa,EAAE;MACjB,OAAO,aAAa,CAAC,iBAAiB,CAAC;MACvC,OAAO,aAAa,CAAC,OAAO,CAAC;MAC7B,OAAO,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,aAAa,CAAC;KACvD;GACF,CAAC;;;EAGF,iBAAiB,CAAC,SAAS,CAAC,WAAW,GAAG,SAAS,WAAW;MAC1D,IAAI,EAAE,IAAI,EAAE;IACd,IAAI,MAAM,GAAG,qBAAqB,CAAC,WAAW,CAAC,iBAAiB;QAC5D,WAAW,CAAC,kBAAkB,CAAC,CAAC;IACpC,IAAI,IAAI,IAAI,WAAW,CAAC,SAAS,EAAE;MACjC,MAAM,CAAC,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC;MACtD,MAAM,CAAC,IAAI,GAAG;QACZ,KAAK,EAAEA,GAAQ,CAAC,UAAU;QAC1B,QAAQ,EAAE,WAAW,CAAC,cAAc,CAAC,QAAQ;OAC9C,CAAC;MACF,IAAI,WAAW,CAAC,sBAAsB,CAAC,MAAM,EAAE;QAC7C,MAAM,CAAC,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;OAC/D;MACD,WAAW,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;KACpC;IACD,IAAI,IAAI,IAAI,WAAW,CAAC,WAAW,IAAI,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;;MAE/D,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO;aACzB,WAAW,CAAC,sBAAsB;aAClC,WAAW,GAAG,KAAK,EAAE;QAC1B,WAAW,CAAC,sBAAsB,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;UACrD,OAAO,CAAC,CAAC,GAAG,CAAC;SACd,CAAC,CAAC;OACJ;MACD,IAAI,WAAW,CAAC,sBAAsB,CAAC,MAAM,EAAE;QAC7C,MAAM,CAAC,SAAS,GAAG,WAAW,CAAC,sBAAsB,CAAC;OACvD;MACD,MAAM,CAAC,IAAI,GAAG;QACZ,QAAQ,EAAE,WAAW,CAAC,cAAc,CAAC,QAAQ;OAC9C,CAAC;MACF,IAAI,WAAW,CAAC,cAAc,CAAC,KAAK,EAAE;QACpC,MAAM,CAAC,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC,cAAc,CAAC,KAAK,CAAC;OACtD;MACD,IAAI,WAAW,CAAC,sBAAsB,CAAC,MAAM,EAAE;QAC7C,MAAM,CAAC,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;OAC/D;MACD,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;KACzC;GACF,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,mBAAmB,GAAG,SAAS,WAAW,EAAE;IACtE,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,IAAI,GAAG,SAAS,CAAC;;IAErB,IAAI,CAAC,+BAA+B,CAAC,qBAAqB;QACtD,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,EAAE;MAC1C,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;QAC3C,IAAI,CAAC,GAAG,IAAI,KAAK,CAAC,oBAAoB,GAAG,WAAW,CAAC,IAAI;YACrD,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC;QACxC,CAAC,CAAC,IAAI,GAAG,mBAAmB,CAAC;QAC7B,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;UACpD,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;SAC1B;QACD,MAAM,CAAC,CAAC,CAAC,CAAC;OACX,CAAC,CAAC;KACJ;;IAED,IAAI,QAAQ,CAAC;IACb,IAAI,WAAW,CAAC;IAChB,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO,EAAE;;;MAGhC,QAAQ,GAAGA,GAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;MACnD,WAAW,GAAG,QAAQ,CAAC,KAAK,EAAE,CAAC;MAC/B,QAAQ,CAAC,OAAO,CAAC,SAAS,YAAY,EAAE,aAAa,EAAE;QACrD,IAAI,IAAI,GAAGA,GAAQ,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;QACrD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,iBAAiB,GAAG,IAAI,CAAC;OAC3D,CAAC,CAAC;;MAEH,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE,aAAa,EAAE;QAC7D,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,GAAG,EAAE,aAAa,CAAC,CAAC;OAC9C,CAAC,CAAC;KACJ,MAAM,IAAI,WAAW,CAAC,IAAI,KAAK,QAAQ,EAAE;MACxC,QAAQ,GAAGA,GAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;MAC9D,WAAW,GAAG,QAAQ,CAAC,KAAK,EAAE,CAAC;MAC/B,IAAI,SAAS,GAAGA,GAAQ,CAAC,WAAW,CAAC,WAAW;UAC5C,YAAY,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;MAC7B,QAAQ,CAAC,OAAO,CAAC,SAAS,YAAY,EAAE,aAAa,EAAE;QACrD,IAAI,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;QACnD,IAAI,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;QAC1C,IAAI,YAAY,GAAG,WAAW,CAAC,YAAY,CAAC;QAC5C,IAAI,aAAa,GAAG,WAAW,CAAC,aAAa,CAAC;QAC9C,IAAI,iBAAiB,GAAG,WAAW,CAAC,iBAAiB,CAAC;QACtD,IAAI,kBAAkB,GAAG,WAAW,CAAC,kBAAkB,CAAC;;;QAGxD,IAAI,QAAQ,GAAGA,GAAQ,CAAC,UAAU,CAAC,YAAY,CAAC;YAC5C,CAACA,GAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,eAAe,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;;QAEtE,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE;UAC3C,IAAI,mBAAmB,GAAGA,GAAQ,CAAC,gBAAgB;cAC/C,YAAY,EAAE,WAAW,CAAC,CAAC;UAC/B,IAAI,oBAAoB,GAAGA,GAAQ,CAAC,iBAAiB;cACjD,YAAY,EAAE,WAAW,CAAC,CAAC;UAC/B,IAAI,SAAS,EAAE;YACb,oBAAoB,CAAC,IAAI,GAAG,QAAQ,CAAC;WACtC;;UAED,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,aAAa,KAAK,CAAC,EAAE;YAC5C,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,GAAG,EAAE,aAAa,CAAC,CAAC;YAC7C,IAAI,YAAY,CAAC,KAAK,KAAK,KAAK,EAAE;cAChC,YAAY,CAAC,KAAK,CAAC,WAAW,EAAE,mBAAmB;kBAC/C,SAAS,GAAG,aAAa,GAAG,YAAY,CAAC,CAAC;aAC/C;YACD,IAAI,aAAa,CAAC,KAAK,KAAK,KAAK,EAAE;cACjC,aAAa,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC;aAC3C;WACF;;;UAGD,IAAI,MAAM,GAAG,qBAAqB,CAAC,iBAAiB;cAChD,kBAAkB,CAAC,CAAC;;;;UAIxB,IAAI,CAAC,WAAW,CAAC,WAAW;cACxB,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC;cACxB,KAAK,CAAC,CAAC;SACZ;OACF,CAAC,CAAC;KACJ;;IAED,IAAI,CAAC,gBAAgB,GAAG;MACtB,IAAI,EAAE,WAAW,CAAC,IAAI;MACtB,GAAG,EAAE,WAAW,CAAC,GAAG;KACrB,CAAC;IACF,QAAQ,WAAW,CAAC,IAAI;MACtB,KAAK,OAAO;QACV,IAAI,CAAC,qBAAqB,CAAC,kBAAkB,CAAC,CAAC;QAC/C,MAAM;MACR,KAAK,QAAQ;QACX,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC;QACrC,MAAM;MACR;QACE,MAAM,IAAI,SAAS,CAAC,oBAAoB,GAAG,WAAW,CAAC,IAAI;YACvD,GAAG,CAAC,CAAC;KACZ;;;;;IAKD,IAAI,EAAE,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,SAAS,CAAC,CAAC,CAAC,KAAK,UAAU;QAC/D,SAAS,CAAC,CAAC,CAAC,CAAC;IACjB,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE;MACnC,IAAI,EAAE,EAAE;QACN,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;OAChB;MACD,OAAO,EAAE,CAAC;KACX,CAAC,CAAC;GACJ,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,oBAAoB,GAAG,SAAS,WAAW,EAAE;IACvE,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,IAAI,GAAG,SAAS,CAAC;;IAErB,IAAI,CAAC,+BAA+B,CAAC,sBAAsB;QACvD,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,EAAE;MAC1C,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;QAC3C,IAAI,CAAC,GAAG,IAAI,KAAK,CAAC,qBAAqB,GAAG,WAAW,CAAC,IAAI;YACtD,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC;QACxC,CAAC,CAAC,IAAI,GAAG,mBAAmB,CAAC;QAC7B,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;UACpD,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;SAC1B;QACD,MAAM,CAAC,CAAC,CAAC,CAAC;OACX,CAAC,CAAC;KACJ;;IAED,IAAI,OAAO,GAAG,EAAE,CAAC;IACjB,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;MAC1C,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC;KAC7B,CAAC,CAAC;IACH,IAAI,YAAY,GAAG,EAAE,CAAC;IACtB,IAAI,QAAQ,GAAGA,GAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;IACvD,IAAI,WAAW,GAAG,QAAQ,CAAC,KAAK,EAAE,CAAC;IACnC,IAAI,SAAS,GAAGA,GAAQ,CAAC,WAAW,CAAC,WAAW;QAC5C,YAAY,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;IAC7B,IAAI,WAAW,GAAGA,GAAQ,CAAC,WAAW,CAAC,WAAW;QAC9C,iBAAiB,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;IAClC,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;IAC/B,IAAI,UAAU,GAAGA,GAAQ,CAAC,WAAW,CAAC,WAAW;QAC7C,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;IACzB,IAAI,UAAU,EAAE;MACd,IAAI,CAAC,uBAAuB,GAAG,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC;WAC1D,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;KAC9B,MAAM;MACL,IAAI,CAAC,uBAAuB,GAAG,KAAK,CAAC;KACtC;;IAED,QAAQ,CAAC,OAAO,CAAC,SAAS,YAAY,EAAE,aAAa,EAAE;MACrD,IAAI,KAAK,GAAGA,GAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;MAC9C,IAAI,IAAI,GAAGA,GAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;;MAE1C,IAAI,QAAQ,GAAGA,GAAQ,CAAC,UAAU,CAAC,YAAY,CAAC;UAC5C,CAACA,GAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,eAAe,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;MACtE,IAAI,QAAQ,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;;MAEhD,IAAI,SAAS,GAAGA,GAAQ,CAAC,YAAY,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;MACjE,IAAI,UAAU,GAAGA,GAAQ,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;;MAElD,IAAI,GAAG,GAAGA,GAAQ,CAAC,MAAM,CAAC,YAAY,CAAC,IAAIA,GAAQ,CAAC,kBAAkB,EAAE,CAAC;;;MAGzE,IAAI,IAAI,KAAK,aAAa,IAAI,QAAQ,KAAK,WAAW,EAAE;QACtD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,GAAG;UACjC,GAAG,EAAE,GAAG;UACR,aAAa,EAAE,IAAI;SACpB,CAAC;QACF,OAAO;OACR;;MAED,IAAI,WAAW,CAAC;MAChB,IAAI,WAAW,CAAC;MAChB,IAAI,YAAY,CAAC;MACjB,IAAI,aAAa,CAAC;MAClB,IAAI,WAAW,CAAC;MAChB,IAAI,sBAAsB,CAAC;MAC3B,IAAI,sBAAsB,CAAC;MAC3B,IAAI,iBAAiB,CAAC;;MAEtB,IAAI,KAAK,CAAC;;MAEV,IAAI,kBAAkB,GAAGA,GAAQ,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;MACnE,IAAI,mBAAmB,CAAC;MACxB,IAAI,oBAAoB,CAAC;MACzB,IAAI,CAAC,QAAQ,EAAE;QACb,mBAAmB,GAAGA,GAAQ,CAAC,gBAAgB,CAAC,YAAY;YACxD,WAAW,CAAC,CAAC;QACjB,oBAAoB,GAAGA,GAAQ,CAAC,iBAAiB,CAAC,YAAY;YAC1D,WAAW,CAAC,CAAC;QACjB,oBAAoB,CAAC,IAAI,GAAG,QAAQ,CAAC;OACtC;MACD,sBAAsB;UAClBA,GAAQ,CAAC,0BAA0B,CAAC,YAAY,CAAC,CAAC;;MAEtD,IAAI,cAAc,GAAGA,GAAQ,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC;;MAEhE,IAAI,UAAU,GAAGA,GAAQ,CAAC,WAAW,CAAC,YAAY;UAC9C,qBAAqB,EAAE,WAAW,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;MACnD,IAAI,KAAK,GAAGA,GAAQ,CAAC,WAAW,CAAC,YAAY,EAAE,cAAc,CAAC;WACzD,GAAG,CAAC,SAAS,IAAI,EAAE;YAClB,OAAOA,GAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;WACtC,CAAC;WACD,MAAM,CAAC,SAAS,IAAI,EAAE;YACrB,OAAO,IAAI,CAAC,SAAS,KAAK,CAAC,CAAC;WAC7B,CAAC,CAAC;;;MAGP,IAAI,CAAC,WAAW,CAAC,IAAI,KAAK,OAAO,IAAI,WAAW,CAAC,IAAI,KAAK,QAAQ;UAC9D,CAAC,QAAQ,IAAI,WAAW,IAAI,aAAa,GAAG,CAAC;UAC7C,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,EAAE;QACpC,IAAI,CAAC,4BAA4B,CAAC,aAAa,CAAC,CAAC;QACjD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,WAAW;YACxC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;QACrC,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,YAAY;YACzC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC;QACtC,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,aAAa;YAC1C,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC;QACvC,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,SAAS,EAAE;UAC9C,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,SAAS,CAAC,YAAY;cACnD,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC;SACzC;QACD,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,WAAW,EAAE;UAChD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,WAAW,CAAC,YAAY;cACrD,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC;SACzC;OACF;MACD,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO,IAAI,CAAC,QAAQ,EAAE;QAC7C,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC;YAC1C,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC;QAClC,WAAW,CAAC,GAAG,GAAG,GAAG,CAAC;;QAEtB,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE;UAC5B,WAAW,CAAC,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,aAAa;cAC3D,WAAW,CAAC,CAAC;SAClB;;QAED,IAAI,KAAK,CAAC,MAAM,IAAI,WAAW,CAAC,YAAY,CAAC,KAAK,KAAK,KAAK,EAAE;UAC5D,IAAI,UAAU,KAAK,CAAC,WAAW,IAAI,aAAa,KAAK,CAAC,CAAC,EAAE;YACvD,WAAW,CAAC,YAAY,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;WACrD,MAAM;YACL,KAAK,CAAC,OAAO,CAAC,SAAS,SAAS,EAAE;cAChC,iBAAiB,CAAC,WAAW,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;aACxD,CAAC,CAAC;WACJ;SACF;;QAED,iBAAiB,GAAG,MAAM,CAAC,cAAc,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;;;;QAIhE,IAAI,WAAW,GAAG,KAAK,EAAE;UACvB,iBAAiB,CAAC,MAAM,GAAG,iBAAiB,CAAC,MAAM,CAAC,MAAM;cACtD,SAAS,KAAK,EAAE;gBACd,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC;eAC7B,CAAC,CAAC;SACR;;QAED,sBAAsB,GAAG,WAAW,CAAC,sBAAsB,IAAI,CAAC;UAC9D,IAAI,EAAE,CAAC,CAAC,GAAG,aAAa,GAAG,CAAC,IAAI,IAAI;SACrC,CAAC,CAAC;;;QAGH,IAAI,UAAU,GAAG,KAAK,CAAC;QACvB,IAAI,SAAS,KAAK,UAAU,IAAI,SAAS,KAAK,UAAU,EAAE;UACxD,UAAU,GAAG,CAAC,WAAW,CAAC,WAAW,CAAC;UACtC,WAAW,GAAG,WAAW,CAAC,WAAW;cACjC,IAAI,MAAM,CAAC,cAAc,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;;UAE/D,IAAI,UAAU,EAAE;YACd,IAAI,MAAM,CAAC;YACX,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;;YAE1B,IAAI,UAAU,EAAE;cACd,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;gBAC/B,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC,WAAW,EAAE,CAAC;gBACtD,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE;kBACtD,GAAG,EAAE,WAAW;oBACd,OAAO,UAAU,CAAC,MAAM,CAAC;mBAC1B;iBACF,CAAC,CAAC;eACJ;cACD,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,EAAE;gBACjC,GAAG,EAAE,WAAW;kBACd,OAAO,UAAU,CAAC,KAAK,CAAC;iBACzB;eACF,CAAC,CAAC;cACH,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;aACrC,MAAM;cACL,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;gBACpB,OAAO,CAAC,OAAO,GAAG,IAAI,MAAM,CAAC,WAAW,EAAE,CAAC;eAC5C;cACD,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC;aAC1B;YACD,4BAA4B,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAC5C,YAAY,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC,CAAC;YAChD,WAAW,CAAC,4BAA4B,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;WACvD;SACF,MAAM,IAAI,WAAW,CAAC,WAAW,IAAI,WAAW,CAAC,WAAW,CAAC,KAAK,EAAE;UACnE,WAAW,CAAC,4BAA4B,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;YAC3D,IAAI,WAAW,GAAG,CAAC,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;cAC/C,OAAO,CAAC,CAAC,EAAE,KAAK,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC;aAClD,CAAC,CAAC;YACH,IAAI,WAAW,EAAE;cACf,iCAAiC,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;aACnD;WACF,CAAC,CAAC;UACH,WAAW,CAAC,4BAA4B,GAAG,EAAE,CAAC;SAC/C;;QAED,WAAW,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;QAClD,WAAW,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;QACpD,WAAW,CAAC,WAAW,GAAG,WAAW,CAAC;QACtC,WAAW,CAAC,cAAc,GAAG,cAAc,CAAC;QAC5C,WAAW,CAAC,sBAAsB,GAAG,sBAAsB,CAAC;QAC5D,WAAW,CAAC,sBAAsB,GAAG,sBAAsB,CAAC;;;;QAI5D,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC;YAC7C,KAAK;YACL,UAAU,CAAC,CAAC;OACjB,MAAM,IAAI,WAAW,CAAC,IAAI,KAAK,QAAQ,IAAI,CAAC,QAAQ,EAAE;QACrD,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;QAC/C,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;QACtC,YAAY,GAAG,WAAW,CAAC,YAAY,CAAC;QACxC,aAAa,GAAG,WAAW,CAAC,aAAa,CAAC;QAC1C,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;QACtC,sBAAsB,GAAG,WAAW,CAAC,sBAAsB,CAAC;QAC5D,iBAAiB,GAAG,WAAW,CAAC,iBAAiB,CAAC;;QAElD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,sBAAsB;YACnD,sBAAsB,CAAC;QAC3B,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,kBAAkB;YAC/C,kBAAkB,CAAC;QACvB,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,cAAc,GAAG,cAAc,CAAC;;QAEjE,IAAI,KAAK,CAAC,MAAM,IAAI,YAAY,CAAC,KAAK,KAAK,KAAK,EAAE;UAChD,IAAI,CAAC,SAAS,IAAI,UAAU;eACvB,CAAC,WAAW,IAAI,aAAa,KAAK,CAAC,CAAC,EAAE;YACzC,YAAY,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;WACzC,MAAM;YACL,KAAK,CAAC,OAAO,CAAC,SAAS,SAAS,EAAE;cAChC,iBAAiB,CAAC,WAAW,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;aACxD,CAAC,CAAC;WACJ;SACF;;QAED,IAAI,CAAC,WAAW,IAAI,aAAa,KAAK,CAAC,EAAE;UACvC,IAAI,YAAY,CAAC,KAAK,KAAK,KAAK,EAAE;YAChC,YAAY,CAAC,KAAK,CAAC,WAAW,EAAE,mBAAmB;gBAC/C,aAAa,CAAC,CAAC;WACpB;UACD,IAAI,aAAa,CAAC,KAAK,KAAK,KAAK,EAAE;YACjC,aAAa,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC;WAC3C;SACF;;QAED,IAAI,CAAC,WAAW,CAAC,WAAW;YACxB,SAAS,KAAK,UAAU,IAAI,SAAS,KAAK,UAAU;YACpD,SAAS,KAAK,UAAU,IAAI,SAAS,KAAK,UAAU,CAAC,CAAC;;;QAG1D,IAAI,WAAW;aACV,SAAS,KAAK,UAAU,IAAI,SAAS,KAAK,UAAU,CAAC,EAAE;UAC1D,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;UAC1B,IAAI,UAAU,EAAE;YACd,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;cAC/B,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC,WAAW,EAAE,CAAC;aACvD;YACD,4BAA4B,CAAC,KAAK,EAAE,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;YAChE,YAAY,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,WAAW,EAAE,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;WACrE,MAAM;YACL,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;cACpB,OAAO,CAAC,OAAO,GAAG,IAAI,MAAM,CAAC,WAAW,EAAE,CAAC;aAC5C;YACD,4BAA4B,CAAC,KAAK,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;YACrD,YAAY,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,WAAW,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;WAC1D;SACF,MAAM;;UAEL,OAAO,WAAW,CAAC,WAAW,CAAC;SAChC;OACF;KACF,CAAC,CAAC;;IAEH,IAAI,IAAI,CAAC,SAAS,KAAK,SAAS,EAAE;MAChC,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC,IAAI,KAAK,OAAO,GAAG,QAAQ,GAAG,SAAS,CAAC;KACtE;;IAED,IAAI,CAAC,iBAAiB,GAAG;MACvB,IAAI,EAAE,WAAW,CAAC,IAAI;MACtB,GAAG,EAAE,WAAW,CAAC,GAAG;KACrB,CAAC;IACF,QAAQ,WAAW,CAAC,IAAI;MACtB,KAAK,OAAO;QACV,IAAI,CAAC,qBAAqB,CAAC,mBAAmB,CAAC,CAAC;QAChD,MAAM;MACR,KAAK,QAAQ;QACX,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC;QACrC,MAAM;MACR;QACE,MAAM,IAAI,SAAS,CAAC,oBAAoB,GAAG,WAAW,CAAC,IAAI;YACvD,GAAG,CAAC,CAAC;KACZ;IACD,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE;MACzC,IAAI,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;MAC1B,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC,MAAM,EAAE;QAC7B,IAAI,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;UAC7C,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;UAChC,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,WAAW,CAAC,CAAC;UACnC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;UACtB,MAAM,CAAC,UAAU,CAAC,WAAW;YAC3B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC1B,IAAI,OAAO,IAAI,CAAC,WAAW,KAAK,UAAU,EAAE;cAC1C,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;aACzB;WACF,CAAC,CAAC;SACJ;;QAED,YAAY,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE;UAClC,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;UACpB,IAAI,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;UACvB,IAAI,MAAM,CAAC,EAAE,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;YAC5B,OAAO;WACR;UACD,IAAI,UAAU,GAAG,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;UACpC,UAAU,CAAC,KAAK,GAAG,KAAK,CAAC;UACzB,UAAU,CAAC,QAAQ,GAAG,QAAQ,CAAC;UAC/B,UAAU,CAAC,WAAW,GAAG,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;UAC9C,UAAU,CAAC,OAAO,GAAG,CAAC,MAAM,CAAC,CAAC;UAC9B,MAAM,CAAC,UAAU,CAAC,WAAW;YAC3B,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;YAC/B,IAAI,OAAO,IAAI,CAAC,OAAO,KAAK,UAAU,EAAE;cACtC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;aAC1B;WACF,CAAC,CAAC;SACJ,CAAC,CAAC;OACJ;KACF,CAAC,CAAC;;;;IAIH,MAAM,CAAC,UAAU,CAAC,WAAW;MAC3B,IAAI,EAAE,IAAI,IAAI,IAAI,CAAC,YAAY,CAAC,EAAE;QAChC,OAAO;OACR;MACD,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE;QAC9C,IAAI,WAAW,CAAC,YAAY;YACxB,WAAW,CAAC,YAAY,CAAC,KAAK,KAAK,KAAK;YACxC,WAAW,CAAC,YAAY,CAAC,mBAAmB,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE;UAC7D,OAAO,CAAC,IAAI,CAAC,mDAAmD;cAC5D,mCAAmC,CAAC,CAAC;UACzC,WAAW,CAAC,YAAY,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;SACjD;OACF,CAAC,CAAC;KACJ,EAAE,IAAI,CAAC,CAAC;;IAET,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE;MACnC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;QACpD,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;OACrB;MACD,OAAO,EAAE,CAAC;KACX,CAAC,CAAC;GACJ,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,KAAK,GAAG,WAAW;IAC7C,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE;;;;;;MAM9C,IAAI,WAAW,CAAC,YAAY,EAAE;QAC5B,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;OACjC;MACD,IAAI,WAAW,CAAC,aAAa,EAAE;QAC7B,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC;OAClC;MACD,IAAI,WAAW,CAAC,SAAS,EAAE;QACzB,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;OAC9B;MACD,IAAI,WAAW,CAAC,WAAW,EAAE;QAC3B,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;OAChC;KACF,CAAC,CAAC;;IAEH,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC;GACtC,CAAC;;;EAGF,iBAAiB,CAAC,SAAS,CAAC,qBAAqB,GAAG,SAAS,QAAQ,EAAE;IACrE,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;IAC/B,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;IAC9C,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAC1B,IAAI,OAAO,IAAI,CAAC,sBAAsB,KAAK,UAAU,EAAE;MACrD,IAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,CAAC;KACpC;GACF,CAAC;;;EAGF,iBAAiB,CAAC,SAAS,CAAC,2BAA2B,GAAG,WAAW;IACnE,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,IAAI,CAAC,cAAc,KAAK,QAAQ,IAAI,IAAI,CAAC,eAAe,KAAK,IAAI,EAAE;MACrE,OAAO;KACR;IACD,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;IAC5B,MAAM,CAAC,UAAU,CAAC,WAAW;MAC3B,IAAI,IAAI,CAAC,eAAe,KAAK,KAAK,EAAE;QAClC,OAAO;OACR;MACD,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;MAC7B,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC;MAC3C,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;MAC1B,IAAI,OAAO,IAAI,CAAC,mBAAmB,KAAK,UAAU,EAAE;QAClD,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;OACjC;KACF,EAAE,CAAC,CAAC,CAAC;GACP,CAAC;;;EAGF,iBAAiB,CAAC,SAAS,CAAC,sBAAsB,GAAG,WAAW;IAC9D,IAAI,QAAQ,CAAC;IACb,IAAI,MAAM,GAAG;MACX,KAAK,EAAE,CAAC;MACR,MAAM,EAAE,CAAC;MACT,UAAU,EAAE,CAAC;MACb,QAAQ,EAAE,CAAC;MACX,SAAS,EAAE,CAAC;MACZ,SAAS,EAAE,CAAC;MACZ,YAAY,EAAE,CAAC;MACf,MAAM,EAAE,CAAC;KACV,CAAC;IACF,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE;MAC9C,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,CAAC;MACzC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE,CAAC;KAC3C,CAAC,CAAC;;IAEH,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,SAAS,CAAC;;IAErC,QAAQ,GAAG,KAAK,CAAC;IACjB,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;MACrB,QAAQ,GAAG,QAAQ,CAAC;KACrB,MAAM,IAAI,MAAM,CAAC,UAAU,GAAG,CAAC,IAAI,MAAM,CAAC,QAAQ,GAAG,CAAC,EAAE;MACvD,QAAQ,GAAG,YAAY,CAAC;KACzB,MAAM,IAAI,MAAM,CAAC,YAAY,GAAG,CAAC,EAAE;MAClC,QAAQ,GAAG,cAAc,CAAC;KAC3B,MAAM,IAAI,MAAM,CAAC,GAAG,GAAG,CAAC,EAAE;MACzB,QAAQ,GAAG,KAAK,CAAC;KAClB,MAAM,IAAI,MAAM,CAAC,SAAS,GAAG,CAAC,IAAI,MAAM,CAAC,SAAS,GAAG,CAAC,EAAE;MACvD,QAAQ,GAAG,WAAW,CAAC;KACxB;;IAED,IAAI,QAAQ,KAAK,IAAI,CAAC,kBAAkB,EAAE;MACxC,IAAI,CAAC,kBAAkB,GAAG,QAAQ,CAAC;MACnC,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC;MAClD,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;MAC1B,IAAI,OAAO,IAAI,CAAC,0BAA0B,KAAK,UAAU,EAAE;QACzD,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC,CAAC;OACxC;KACF;GACF,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,WAAW,GAAG,WAAW;IACnD,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,IAAI,GAAG,SAAS,CAAC;;IAErB,IAAI,YAAY,CAAC;IACjB,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,IAAI,OAAO,SAAS,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;MAChE,YAAY,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;KAC7B,MAAM,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;MACjC,YAAY,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;KAC7B;;IAED,IAAI,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;MACxD,OAAO,CAAC,CAAC,IAAI,KAAK,OAAO,CAAC;KAC3B,CAAC,CAAC,MAAM,CAAC;IACV,IAAI,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;MACxD,OAAO,CAAC,CAAC,IAAI,KAAK,OAAO,CAAC;KAC3B,CAAC,CAAC,MAAM,CAAC;;;IAGV,IAAI,YAAY,EAAE;;MAEhB,IAAI,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,QAAQ,EAAE;QACnD,MAAM,IAAI,SAAS;YACf,sDAAsD,CAAC,CAAC;OAC7D;MACD,IAAI,YAAY,CAAC,mBAAmB,KAAK,SAAS,EAAE;QAClD,IAAI,YAAY,CAAC,mBAAmB,KAAK,IAAI,EAAE;UAC7C,cAAc,GAAG,CAAC,CAAC;SACpB,MAAM,IAAI,YAAY,CAAC,mBAAmB,KAAK,KAAK,EAAE;UACrD,cAAc,GAAG,CAAC,CAAC;SACpB,MAAM;UACL,cAAc,GAAG,YAAY,CAAC,mBAAmB,CAAC;SACnD;OACF;MACD,IAAI,YAAY,CAAC,mBAAmB,KAAK,SAAS,EAAE;QAClD,IAAI,YAAY,CAAC,mBAAmB,KAAK,IAAI,EAAE;UAC7C,cAAc,GAAG,CAAC,CAAC;SACpB,MAAM,IAAI,YAAY,CAAC,mBAAmB,KAAK,KAAK,EAAE;UACrD,cAAc,GAAG,CAAC,CAAC;SACpB,MAAM;UACL,cAAc,GAAG,YAAY,CAAC,mBAAmB,CAAC;SACnD;OACF;KACF;;IAED,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE;MAC9C,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO,EAAE;QAChC,cAAc,EAAE,CAAC;QACjB,IAAI,cAAc,GAAG,CAAC,EAAE;UACtB,WAAW,CAAC,WAAW,GAAG,KAAK,CAAC;SACjC;OACF,MAAM,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO,EAAE;QACvC,cAAc,EAAE,CAAC;QACjB,IAAI,cAAc,GAAG,CAAC,EAAE;UACtB,WAAW,CAAC,WAAW,GAAG,KAAK,CAAC;SACjC;OACF;KACF,CAAC,CAAC;;;IAGH,OAAO,cAAc,GAAG,CAAC,IAAI,cAAc,GAAG,CAAC,EAAE;MAC/C,IAAI,cAAc,GAAG,CAAC,EAAE;QACtB,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;QACjC,cAAc,EAAE,CAAC;OAClB;MACD,IAAI,cAAc,GAAG,CAAC,EAAE;QACtB,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;QACjC,cAAc,EAAE,CAAC;OAClB;KACF;;IAED,IAAID,MAAG,GAAGC,GAAQ,CAAC,uBAAuB,CAAC,IAAI,CAAC,aAAa;QACzD,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;IAC/B,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE,aAAa,EAAE;;;MAG7D,IAAI,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;MAC9B,IAAI,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;MAC5B,IAAI,GAAG,GAAGA,GAAQ,CAAC,kBAAkB,EAAE,CAAC;MACxC,WAAW,CAAC,GAAG,GAAG,GAAG,CAAC;;MAEtB,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE;QAC5B,WAAW,CAAC,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,aAAa;YAC3D,IAAI,CAAC,WAAW,CAAC,CAAC;OACvB;;MAED,IAAI,iBAAiB,GAAG,MAAM,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;;;MAGlE,IAAI,WAAW,GAAG,KAAK,EAAE;QACvB,iBAAiB,CAAC,MAAM,GAAG,iBAAiB,CAAC,MAAM,CAAC,MAAM;YACtD,SAAS,KAAK,EAAE;cACd,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC;aAC7B,CAAC,CAAC;OACR;MACD,iBAAiB,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;;;QAG/C,IAAI,KAAK,CAAC,IAAI,KAAK,MAAM;YACrB,KAAK,CAAC,UAAU,CAAC,yBAAyB,CAAC,KAAK,SAAS,EAAE;UAC7D,KAAK,CAAC,UAAU,CAAC,yBAAyB,CAAC,GAAG,GAAG,CAAC;SACnD;OACF,CAAC,CAAC;;;MAGH,IAAI,sBAAsB,GAAG,WAAW,CAAC,sBAAsB,IAAI,CAAC;QAClE,IAAI,EAAE,CAAC,CAAC,GAAG,aAAa,GAAG,CAAC,IAAI,IAAI;OACrC,CAAC,CAAC;MACH,IAAI,KAAK,EAAE;;QAET,IAAI,WAAW,IAAI,KAAK,IAAI,IAAI,KAAK,OAAO;YACxC,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;UAClC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;YAC9B,IAAI,EAAE,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC;WACzC,CAAC;SACH;OACF;;MAED,IAAI,WAAW,CAAC,WAAW,EAAE;QAC3B,WAAW,CAAC,WAAW,GAAG,IAAI,MAAM,CAAC,cAAc;YAC/C,WAAW,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;OACtC;;MAED,WAAW,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;MAClD,WAAW,CAAC,sBAAsB,GAAG,sBAAsB,CAAC;KAC7D,CAAC,CAAC;;;IAGH,IAAI,IAAI,CAAC,OAAO,CAAC,YAAY,KAAK,YAAY,EAAE;MAC9CD,MAAG,IAAI,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;QAC3D,OAAO,CAAC,CAAC,GAAG,CAAC;OACd,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;KACvB;IACDA,MAAG,IAAI,2BAA2B,CAAC;;IAEnC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE,aAAa,EAAE;MAC7DA,MAAG,IAAI,iBAAiB,CAAC,WAAW,EAAE,WAAW,CAAC,iBAAiB;UAC/D,OAAO,EAAE,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;MACjDA,MAAG,IAAI,kBAAkB,CAAC;;MAE1B,IAAI,WAAW,CAAC,WAAW,IAAI,IAAI,CAAC,iBAAiB,KAAK,KAAK;WAC1D,aAAa,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE;QAC9C,WAAW,CAAC,WAAW,CAAC,kBAAkB,EAAE,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE;UAClE,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;UACnBA,MAAG,IAAI,IAAI,GAAGC,GAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;SACtD,CAAC,CAAC;;QAEH,IAAI,WAAW,CAAC,WAAW,CAAC,KAAK,KAAK,WAAW,EAAE;UACjDD,MAAG,IAAI,yBAAyB,CAAC;SAClC;OACF;KACF,CAAC,CAAC;;IAEH,IAAI,IAAI,GAAG,IAAI,MAAM,CAAC,qBAAqB,CAAC;MAC1C,IAAI,EAAE,OAAO;MACb,GAAG,EAAEA,MAAG;KACT,CAAC,CAAC;IACH,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE;MACnC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;QACpD,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QAC5B,OAAO,EAAE,CAAC;QACV,OAAO;OACR;MACD,OAAO,CAAC,IAAI,CAAC,CAAC;KACf,CAAC,CAAC;GACJ,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,YAAY,GAAG,WAAW;IACpD,IAAI,IAAI,GAAG,IAAI,CAAC;IAChB,IAAI,IAAI,GAAG,SAAS,CAAC;;IAErB,IAAIA,MAAG,GAAGC,GAAQ,CAAC,uBAAuB,CAAC,IAAI,CAAC,aAAa;QACzD,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;IAC/B,IAAI,IAAI,CAAC,WAAW,EAAE;MACpBD,MAAG,IAAI,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;QAC3D,OAAO,CAAC,CAAC,GAAG,CAAC;OACd,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;KACvB;IACD,IAAI,oBAAoB,GAAGC,GAAQ,CAAC,aAAa;QAC7C,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;IAC3C,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE,aAAa,EAAE;MAC7D,IAAI,aAAa,GAAG,CAAC,GAAG,oBAAoB,EAAE;QAC5C,OAAO;OACR;MACD,IAAI,WAAW,CAAC,aAAa,EAAE;QAC7BD,MAAG,IAAI,oCAAoC;YACvC,sBAAsB;YACtB,QAAQ,GAAG,WAAW,CAAC,GAAG,GAAG,MAAM,CAAC;QACxC,OAAO;OACR;;;MAGD,IAAI,WAAW,CAAC,MAAM,EAAE;QACtB,IAAI,UAAU,CAAC;QACf,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO,EAAE;UAChC,UAAU,GAAG,WAAW,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,CAAC;SACrD,MAAM,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO,EAAE;UACvC,UAAU,GAAG,WAAW,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,CAAC;SACrD;QACD,IAAI,UAAU,EAAE;;UAEd,IAAI,WAAW,IAAI,KAAK,IAAI,WAAW,CAAC,IAAI,KAAK,OAAO;cACpD,CAAC,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;YAC9C,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;cAC1C,IAAI,EAAE,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC;aACrD,CAAC;WACH;SACF;OACF;;;MAGD,IAAI,kBAAkB,GAAG,qBAAqB;UAC1C,WAAW,CAAC,iBAAiB;UAC7B,WAAW,CAAC,kBAAkB,CAAC,CAAC;;MAEpC,IAAI,MAAM,GAAG,kBAAkB,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;QACxD,OAAO,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,KAAK,KAAK,CAAC;OACvC,CAAC,CAAC,MAAM,CAAC;MACV,IAAI,CAAC,MAAM,IAAI,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;QACxD,OAAO,WAAW,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;OAClD;;MAEDA,MAAG,IAAI,iBAAiB,CAAC,WAAW,EAAE,kBAAkB;UACpD,QAAQ,EAAE,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;MAClD,IAAI,WAAW,CAAC,cAAc;UAC1B,WAAW,CAAC,cAAc,CAAC,WAAW,EAAE;QAC1CA,MAAG,IAAI,kBAAkB,CAAC;OAC3B;KACF,CAAC,CAAC;;IAEH,IAAI,IAAI,GAAG,IAAI,MAAM,CAAC,qBAAqB,CAAC;MAC1C,IAAI,EAAE,QAAQ;MACd,GAAG,EAAEA,MAAG;KACT,CAAC,CAAC;IACH,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE;MACnC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;QACpD,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QAC5B,OAAO,EAAE,CAAC;QACV,OAAO;OACR;MACD,OAAO,CAAC,IAAI,CAAC,CAAC;KACf,CAAC,CAAC;GACJ,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,eAAe,GAAG,SAAS,SAAS,EAAE;IAChE,IAAI,GAAG,CAAC;IACR,IAAI,QAAQ,CAAC;IACb,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,SAAS,KAAK,EAAE,EAAE;MAC5C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACjD,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE;UACtC,SAAS;SACV;QACD,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;QACzD,QAAQ,GAAGC,GAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;QAC9D,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,yBAAyB,CAAC;QAC7C,IAAI,CAAC,iBAAiB,CAAC,GAAG,GAAG,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC/C,IAAI,IAAI,CAAC,WAAW,EAAE;UACpB,MAAM;SACP;OACF;KACF,MAAM,IAAI,EAAE,SAAS,CAAC,aAAa,KAAK,SAAS,IAAI,SAAS,CAAC,MAAM,CAAC,EAAE;MACvE,MAAM,IAAI,SAAS,CAAC,kCAAkC,CAAC,CAAC;KACzD,MAAM,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;MAClC,GAAG,GAAG,IAAI,KAAK,CAAC,oCAAoC;UAChD,sBAAsB,CAAC,CAAC;MAC5B,GAAG,CAAC,IAAI,GAAG,mBAAmB,CAAC;KAChC,MAAM;MACL,IAAI,aAAa,GAAG,SAAS,CAAC,aAAa,CAAC;MAC5C,IAAI,SAAS,CAAC,MAAM,EAAE;QACpB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;UACjD,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,SAAS,CAAC,MAAM,EAAE;YACjD,aAAa,GAAG,CAAC,CAAC;YAClB,MAAM;WACP;SACF;OACF;MACD,IAAI,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;MACnD,IAAI,WAAW,EAAE;QACf,IAAI,WAAW,CAAC,aAAa,EAAE;UAC7B,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;SAC1B;QACD,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,MAAM,GAAG,CAAC;YAClDA,GAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC;;QAEtD,IAAI,IAAI,CAAC,QAAQ,KAAK,KAAK,KAAK,IAAI,CAAC,IAAI,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,KAAK,CAAC,CAAC,EAAE;UACnE,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;SAC1B;;QAED,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,KAAK,CAAC,EAAE;UAC1C,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;SAC1B;;;QAGD,IAAI,aAAa,KAAK,CAAC,KAAK,aAAa,GAAG,CAAC;YACzC,WAAW,CAAC,YAAY,KAAK,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,EAAE;UACnE,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,YAAY,EAAE,IAAI,CAAC,EAAE;YACtD,GAAG,GAAG,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;YAC7C,GAAG,CAAC,IAAI,GAAG,gBAAgB,CAAC;WAC7B;SACF;;QAED,IAAI,CAAC,GAAG,EAAE;;UAER,IAAI,eAAe,GAAG,SAAS,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;UACjD,IAAI,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;YACvC,eAAe,GAAG,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;WAC7C;UACD,QAAQ,GAAGA,GAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;UAC9D,QAAQ,CAAC,aAAa,GAAG,CAAC,CAAC,IAAI,IAAI;eAC9B,IAAI,CAAC,IAAI,GAAG,eAAe,GAAG,mBAAmB,CAAC;gBACjD,MAAM,CAAC;UACb,IAAI,CAAC,iBAAiB,CAAC,GAAG,GAAG,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SAChD;OACF,MAAM;QACL,GAAG,GAAG,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;QAC7C,GAAG,CAAC,IAAI,GAAG,gBAAgB,CAAC;OAC7B;KACF;IACD,IAAI,IAAI,GAAG,SAAS,CAAC;IACrB,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;MAC3C,IAAI,GAAG,EAAE;QACP,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;UACpD,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;SAC5B;QACD,MAAM,CAAC,GAAG,CAAC,CAAC;OACb,MAAM;QACL,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;UACpD,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SACrB;QACD,OAAO,EAAE,CAAC;OACX;KACF,CAAC,CAAC;GACJ,CAAC;;EAEF,iBAAiB,CAAC,SAAS,CAAC,QAAQ,GAAG,WAAW;IAChD,IAAI,QAAQ,GAAG,EAAE,CAAC;IAClB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,WAAW,EAAE;MAC9C,CAAC,WAAW,EAAE,aAAa,EAAE,aAAa,EAAE,cAAc;UACtD,eAAe,CAAC,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;YACxC,IAAI,WAAW,CAAC,MAAM,CAAC,EAAE;cACvB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;aAC/C;WACF,CAAC,CAAC;KACR,CAAC,CAAC;IACH,IAAI,EAAE,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,SAAS,CAAC,CAAC,CAAC,KAAK,UAAU;QAC/D,SAAS,CAAC,CAAC,CAAC,CAAC;IACjB,IAAI,YAAY,GAAG,SAAS,IAAI,EAAE;MAChC,OAAO;QACL,UAAU,EAAE,aAAa;QACzB,WAAW,EAAE,cAAc;QAC3B,aAAa,EAAE,gBAAgB;QAC/B,cAAc,EAAE,iBAAiB;QACjC,eAAe,EAAE,kBAAkB;OACpC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC;KAC3B,CAAC;IACF,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE;;MAEnC,IAAI,OAAO,GAAG,IAAI,GAAG,EAAE,CAAC;MACxB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,SAAS,GAAG,EAAE;QACvC,GAAG,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;UAC3B,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,EAAE;YACvC,MAAM,CAAC,EAAE,CAAC,CAAC,IAAI,GAAG,YAAY,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;YAC3C,OAAO,CAAC,GAAG,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;WAC7B,CAAC,CAAC;SACJ,CAAC,CAAC;QACH,IAAI,EAAE,EAAE;UACN,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;SACzB;QACD,OAAO,CAAC,OAAO,CAAC,CAAC;OAClB,CAAC,CAAC;KACJ,CAAC,CAAC;GACJ,CAAC;EACF,OAAO,iBAAiB,CAAC;CAC1B;;AC5lDD;;;;;;;;AAQA;AAGA,kBAAc,GAAG,SAAS,MAAM,EAAE;EAChC,IAAI,SAAS,GAAG,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC;;EAE3C,IAAI,UAAU,GAAG,SAAS,CAAC,EAAE;IAC3B,OAAO;MACL,IAAI,EAAE,CAAC,qBAAqB,EAAE,iBAAiB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI;MAClE,OAAO,EAAE,CAAC,CAAC,OAAO;MAClB,UAAU,EAAE,CAAC,CAAC,UAAU;MACxB,QAAQ,EAAE,WAAW;QACnB,OAAO,IAAI,CAAC,IAAI,CAAC;OAClB;KACF,CAAC;GACH,CAAC;;;EAGF,IAAI,gBAAgB,GAAG,SAAS,CAAC,YAAY,CAAC,YAAY;MACtD,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;EACjC,SAAS,CAAC,YAAY,CAAC,YAAY,GAAG,SAAS,CAAC,EAAE;IAChD,OAAO,gBAAgB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE;MAC3C,OAAO,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;KACtC,CAAC,CAAC;GACJ,CAAC;CACH;;ACpBD,aAAc,GAAG;EACf,gBAAgB,EAAEF,cAAyB;EAC3C,kBAAkB,EAAE,SAAS,MAAM,EAAE;IACnC,IAAI,cAAc,GAAGD,OAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;;IAEjD,IAAI,MAAM,CAAC,cAAc,EAAE;;;MAGzB,IAAI,CAAC,MAAM,CAAC,eAAe,EAAE;QAC3B,MAAM,CAAC,eAAe,GAAG,SAAS,IAAI,EAAE;UACtC,OAAO,IAAI,CAAC;SACb,CAAC;OACH;;;;MAID,IAAI,CAAC,MAAM,CAAC,qBAAqB,EAAE;QACjC,MAAM,CAAC,qBAAqB,GAAG,SAAS,IAAI,EAAE;UAC5C,OAAO,IAAI,CAAC;SACb,CAAC;OACH;;;;MAID,IAAI,cAAc,CAAC,OAAO,GAAG,KAAK,EAAE;QAClC,IAAI,cAAc,GAAG,MAAM,CAAC,wBAAwB;YAChD,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;QAClD,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,SAAS,EAAE;UAClE,GAAG,EAAE,SAAS,KAAK,EAAE;YACnB,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;YACrC,IAAI,EAAE,GAAG,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC;YAC9B,EAAE,CAAC,OAAO,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;WACxB;SACF,CAAC,CAAC;OACJ;KACF;;;;IAID,IAAI,MAAM,CAAC,YAAY,IAAI,EAAE,MAAM,IAAI,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,EAAE;MACrE,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,YAAY,CAAC,SAAS,EAAE,MAAM,EAAE;QAC3D,GAAG,EAAE,WAAW;UACd,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;YAC5B,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,OAAO,EAAE;cAC/B,IAAI,CAAC,KAAK,GAAG,IAAI,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;aAC7C,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,OAAO,EAAE;cACtC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;aACnB;WACF;UACD,OAAO,IAAI,CAAC,KAAK,CAAC;SACnB;OACF,CAAC,CAAC;KACJ;;IAED,MAAM,CAAC,iBAAiB;QACpBI,iBAAqB,CAAC,MAAM,EAAE,cAAc,CAAC,OAAO,CAAC,CAAC;GAC3D;EACD,gBAAgB,EAAE,SAAS,MAAM,EAAE;;IAEjC,IAAI,MAAM,CAAC,YAAY;QACnB,EAAE,cAAc,IAAI,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,EAAE;MACtD,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,YAAY;UACtC,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,QAAQ,CAAC;KAC5C;GACF;CACF;;ACpED,IAAIL,SAAO,GAAGC,OAAK,CAAC,GAAG,CAAC;;;AAGxB,kBAAc,GAAG,SAAS,MAAM,EAAE;EAChC,IAAI,cAAc,GAAGA,OAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;EACjD,IAAI,SAAS,GAAG,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC;EAC3C,IAAI,gBAAgB,GAAG,MAAM,IAAI,MAAM,CAAC,gBAAgB,CAAC;;EAEzD,IAAI,UAAU,GAAG,SAAS,CAAC,EAAE;IAC3B,OAAO;MACL,IAAI,EAAE;QACJ,aAAa,EAAE,kBAAkB;QACjC,iBAAiB,EAAE,WAAW;QAC9B,qBAAqB,EAAE,iBAAiB;QACxC,aAAa,EAAE,iBAAiB;OACjC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI;MACnB,OAAO,EAAE;QACP,4BAA4B,EAAE,oCAAoC;QAClE,oDAAoD;OACrD,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,OAAO;MACzB,UAAU,EAAE,CAAC,CAAC,UAAU;MACxB,QAAQ,EAAE,WAAW;QACnB,OAAO,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC;OAC1D;KACF,CAAC;GACH,CAAC;;;EAGF,IAAI,aAAa,GAAG,SAAS,WAAW,EAAE,SAAS,EAAE,OAAO,EAAE;IAC5D,IAAI,kBAAkB,GAAG,SAAS,CAAC,EAAE;MACnC,IAAI,OAAO,CAAC,KAAK,QAAQ,IAAI,CAAC,CAAC,OAAO,EAAE;QACtC,OAAO,CAAC,CAAC;OACV;MACD,IAAI,OAAO,GAAG,EAAE,CAAC;MACjB,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE;QACnC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,UAAU,IAAI,GAAG,KAAK,aAAa,EAAE;UACpE,OAAO;SACR;QACD,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,KAAK,QAAQ;YACxC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAC7B,IAAI,CAAC,CAAC,GAAG,KAAK,SAAS;YACnB,CAAC,CAAC,GAAG,KAAK,SAAS,IAAI,CAAC,CAAC,KAAK,KAAK,SAAS,EAAE;UAChD,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACnB;QACD,IAAI,CAAC,CAAC,KAAK,KAAK,SAAS,EAAE;UACzB,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,QAAQ,EAAE;YAC/B,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC;WAC1B,MAAM;YACL,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;WAClB;UACD,OAAO,CAAC,CAAC,KAAK,CAAC;SAChB;QACD,IAAI,CAAC,CAAC,KAAK,KAAK,SAAS,EAAE;UACzB,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC,QAAQ,IAAI,EAAE,CAAC;UAC9B,IAAI,EAAE,GAAG,EAAE,CAAC;UACZ,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,QAAQ,EAAE;YAC/B,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC,KAAK,EAAE,GAAG,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;WACxC,MAAM;YACL,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;WACnB;UACD,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;UACpB,OAAO,CAAC,CAAC,KAAK,CAAC;UACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;YAC1B,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC;WACf;SACF;OACF,CAAC,CAAC;MACH,IAAI,OAAO,CAAC,MAAM,EAAE;QAClB,CAAC,CAAC,OAAO,GAAG,OAAO,CAAC;OACrB;MACD,OAAO,CAAC,CAAC;KACV,CAAC;IACF,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;IACtD,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,EAAE;MAC/BD,SAAO,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;MAChD,IAAI,WAAW,CAAC,KAAK,EAAE;QACrB,WAAW,CAAC,KAAK,GAAG,kBAAkB,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;OAC3D;MACD,IAAI,WAAW,CAAC,KAAK,EAAE;QACrB,WAAW,CAAC,KAAK,GAAG,kBAAkB,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;OAC3D;MACDA,SAAO,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;KACjD;IACD,OAAO,SAAS,CAAC,eAAe,CAAC,WAAW,EAAE,SAAS,EAAE,SAAS,CAAC,EAAE;MACnE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;KACxB,CAAC,CAAC;GACJ,CAAC;;;EAGF,IAAI,oBAAoB,GAAG,SAAS,WAAW,EAAE;IAC/C,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;MAC3C,aAAa,CAAC,WAAW,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;KAC7C,CAAC,CAAC;GACJ,CAAC;;;EAGF,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;IAC3B,SAAS,CAAC,YAAY,GAAG,CAAC,YAAY,EAAE,oBAAoB;MAC1D,gBAAgB,EAAE,WAAW,GAAG;MAChC,mBAAmB,EAAE,WAAW,GAAG;KACpC,CAAC;GACH;EACD,SAAS,CAAC,YAAY,CAAC,gBAAgB;MACnC,SAAS,CAAC,YAAY,CAAC,gBAAgB,IAAI,WAAW;QACpD,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE;UACnC,IAAI,KAAK,GAAG;YACV,CAAC,IAAI,EAAE,YAAY,EAAE,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,CAAC;YACjE,CAAC,IAAI,EAAE,YAAY,EAAE,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,CAAC;WAClE,CAAC;UACF,OAAO,CAAC,KAAK,CAAC,CAAC;SAChB,CAAC,CAAC;OACJ,CAAC;;EAEN,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,EAAE;;IAE/B,IAAI,mBAAmB;QACnB,SAAS,CAAC,YAAY,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;IACzE,SAAS,CAAC,YAAY,CAAC,gBAAgB,GAAG,WAAW;MACnD,OAAO,mBAAmB,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE;QACvD,IAAI,CAAC,CAAC,IAAI,KAAK,eAAe,EAAE;UAC9B,OAAO,EAAE,CAAC;SACX;QACD,MAAM,CAAC,CAAC;OACT,CAAC,CAAC;KACJ,CAAC;GACH;EACD,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,EAAE;IAC/B,IAAI,gBAAgB,GAAG,SAAS,CAAC,YAAY,CAAC,YAAY;QACtD,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;IACjC,SAAS,CAAC,YAAY,CAAC,YAAY,GAAG,SAAS,CAAC,EAAE;MAChD,OAAO,gBAAgB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,MAAM,EAAE;;QAE/C,IAAI,CAAC,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,MAAM;YAC1C,CAAC,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,MAAM,EAAE;UAC9C,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;YACzC,KAAK,CAAC,IAAI,EAAE,CAAC;WACd,CAAC,CAAC;UACH,MAAM,IAAI,YAAY,CAAC,mCAAmC;iCACnC,eAAe,CAAC,CAAC;SACzC;QACD,OAAO,MAAM,CAAC;OACf,EAAE,SAAS,CAAC,EAAE;QACb,OAAO,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;OACtC,CAAC,CAAC;KACJ,CAAC;GACH;EACD,IAAI,EAAE,cAAc,CAAC,OAAO,GAAG,EAAE;MAC7B,iBAAiB,IAAI,SAAS,CAAC,YAAY,CAAC,uBAAuB,EAAE,CAAC,EAAE;IAC1E,IAAI,KAAK,GAAG,SAAS,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE;MAC9B,IAAI,CAAC,IAAI,GAAG,IAAI,EAAE,CAAC,IAAI,GAAG,CAAC,EAAE;QAC3B,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;QAChB,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC;OACf;KACF,CAAC;;IAEF,IAAI,kBAAkB,GAAG,SAAS,CAAC,YAAY,CAAC,YAAY;QACxD,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;IACjC,SAAS,CAAC,YAAY,CAAC,YAAY,GAAG,SAAS,CAAC,EAAE;MAChD,IAAI,OAAO,CAAC,KAAK,QAAQ,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,QAAQ,EAAE;QACxD,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;QAClC,KAAK,CAAC,CAAC,CAAC,KAAK,EAAE,iBAAiB,EAAE,oBAAoB,CAAC,CAAC;QACxD,KAAK,CAAC,CAAC,CAAC,KAAK,EAAE,kBAAkB,EAAE,qBAAqB,CAAC,CAAC;OAC3D;MACD,OAAO,kBAAkB,CAAC,CAAC,CAAC,CAAC;KAC9B,CAAC;;IAEF,IAAI,gBAAgB,IAAI,gBAAgB,CAAC,SAAS,CAAC,WAAW,EAAE;MAC9D,IAAI,iBAAiB,GAAG,gBAAgB,CAAC,SAAS,CAAC,WAAW,CAAC;MAC/D,gBAAgB,CAAC,SAAS,CAAC,WAAW,GAAG,WAAW;QAClD,IAAI,GAAG,GAAG,iBAAiB,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;QACnD,KAAK,CAAC,GAAG,EAAE,oBAAoB,EAAE,iBAAiB,CAAC,CAAC;QACpD,KAAK,CAAC,GAAG,EAAE,qBAAqB,EAAE,kBAAkB,CAAC,CAAC;QACtD,OAAO,GAAG,CAAC;OACZ,CAAC;KACH;;IAED,IAAI,gBAAgB,IAAI,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,EAAE;MACnE,IAAI,sBAAsB,GAAG,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC;MACzE,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,GAAG,SAAS,CAAC,EAAE;QACxD,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,IAAI,OAAO,CAAC,KAAK,QAAQ,EAAE;UAClD,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;UAClC,KAAK,CAAC,CAAC,EAAE,iBAAiB,EAAE,oBAAoB,CAAC,CAAC;UAClD,KAAK,CAAC,CAAC,EAAE,kBAAkB,EAAE,qBAAqB,CAAC,CAAC;SACrD;QACD,OAAO,sBAAsB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;OAChD,CAAC;KACH;GACF;EACD,SAAS,CAAC,YAAY,GAAG,SAAS,WAAW,EAAE,SAAS,EAAE,OAAO,EAAE;IACjE,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,EAAE;MAC/B,OAAO,aAAa,CAAC,WAAW,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;KACvD;;IAEDC,OAAK,CAAC,UAAU,CAAC,wBAAwB;QACrC,qCAAqC,CAAC,CAAC;IAC3C,SAAS,CAAC,YAAY,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;GAC3E,CAAC;CACH;;ACpMD,IAAI,WAAW,GAAG;EAChB,WAAW,EAAE,SAAS,MAAM,EAAE;IAC5B,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,iBAAiB,IAAI,EAAE,SAAS;QACrE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;MACvC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,CAAC,SAAS,EAAE,SAAS,EAAE;QACnE,GAAG,EAAE,WAAW;UACd,OAAO,IAAI,CAAC,QAAQ,CAAC;SACtB;QACD,GAAG,EAAE,SAAS,CAAC,EAAE;UACf,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YACjD,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;WAC1D;UACD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;UAClD,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC,EAAE;YACjE,CAAC,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;cAC3C,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;cAC/B,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;cACpB,KAAK,CAAC,QAAQ,GAAG,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;cAChC,KAAK,CAAC,WAAW,GAAG,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;cAC/C,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;cAC3B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;aAC3B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;WACf,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SACf;OACF,CAAC,CAAC;KACJ;IACD,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,aAAa;SACjD,UAAU,IAAI,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC;QAC9C,EAAE,aAAa,IAAI,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,EAAE;MACtD,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,aAAa,CAAC,SAAS,EAAE,aAAa,EAAE;QACnE,GAAG,EAAE,WAAW;UACd,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;SAClC;OACF,CAAC,CAAC;KACJ;GACF;;EAED,gBAAgB,EAAE,SAAS,MAAM,EAAE;;IAEjC,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;MAC9B,IAAI,MAAM,CAAC,gBAAgB;QACzB,EAAE,WAAW,IAAI,MAAM,CAAC,gBAAgB,CAAC,SAAS,CAAC,EAAE;;QAErD,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,WAAW,EAAE;UACpE,GAAG,EAAE,WAAW;YACd,OAAO,IAAI,CAAC,YAAY,CAAC;WAC1B;UACD,GAAG,EAAE,SAAS,MAAM,EAAE;YACpB,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC;WAC5B;SACF,CAAC,CAAC;OACJ;KACF;GACF;;EAED,kBAAkB,EAAE,SAAS,MAAM,EAAE;IACnC,IAAI,cAAc,GAAGA,OAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;;IAEjD,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,EAAE,MAAM,CAAC,iBAAiB;QACxD,MAAM,CAAC,oBAAoB,CAAC,EAAE;MAChC,OAAO;KACR;;IAED,IAAI,CAAC,MAAM,CAAC,iBAAiB,EAAE;MAC7B,MAAM,CAAC,iBAAiB,GAAG,SAAS,QAAQ,EAAE,aAAa,EAAE;QAC3D,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,EAAE;;;UAG/B,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;YACnC,IAAI,aAAa,GAAG,EAAE,CAAC;YACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;cACnD,IAAI,MAAM,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;cACpC,IAAI,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBACjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;kBAC3C,IAAI,SAAS,GAAG;oBACd,GAAG,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;mBACpB,CAAC;kBACF,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;oBACxC,SAAS,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;oBACrC,SAAS,CAAC,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;mBAC1C;kBACD,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;iBAC/B;eACF,MAAM;gBACL,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;eAC5C;aACF;YACD,QAAQ,CAAC,UAAU,GAAG,aAAa,CAAC;WACrC;SACF;QACD,OAAO,IAAI,MAAM,CAAC,oBAAoB,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;OACjE,CAAC;MACF,MAAM,CAAC,iBAAiB,CAAC,SAAS;UAC9B,MAAM,CAAC,oBAAoB,CAAC,SAAS,CAAC;;;MAG1C,IAAI,MAAM,CAAC,oBAAoB,CAAC,mBAAmB,EAAE;QACnD,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,EAAE,qBAAqB,EAAE;UACrE,GAAG,EAAE,WAAW;YACd,OAAO,MAAM,CAAC,oBAAoB,CAAC,mBAAmB,CAAC;WACxD;SACF,CAAC,CAAC;OACJ;;MAED,MAAM,CAAC,qBAAqB,GAAG,MAAM,CAAC,wBAAwB,CAAC;MAC/D,MAAM,CAAC,eAAe,GAAG,MAAM,CAAC,kBAAkB,CAAC;KACpD;;;IAGD,CAAC,qBAAqB,EAAE,sBAAsB,EAAE,iBAAiB,CAAC;SAC7D,OAAO,CAAC,SAAS,MAAM,EAAE;UACxB,IAAI,YAAY,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;UAC9D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,WAAW;YACtD,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM,KAAK,iBAAiB;gBAC7C,MAAM,CAAC,eAAe;gBACtB,MAAM,CAAC,qBAAqB,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YAChD,OAAO,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;WAC5C,CAAC;SACH,CAAC,CAAC;;;IAGP,IAAI,qBAAqB;QACrB,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,eAAe,CAAC;IACvD,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,eAAe,GAAG,WAAW;MAC9D,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;QACjB,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;UAChB,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAC1B;QACD,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;OAC1B;MACD,OAAO,qBAAqB,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KACrD,CAAC;;;IAGF,IAAI,YAAY,GAAG,SAAS,KAAK,EAAE;MACjC,IAAI,GAAG,GAAG,IAAI,GAAG,EAAE,CAAC;MACpB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE;QACvC,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;QACzB,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;OACvB,CAAC,CAAC;MACH,OAAO,GAAG,CAAC;KACZ,CAAC;;IAEF,IAAI,gBAAgB,GAAG;MACrB,UAAU,EAAE,aAAa;MACzB,WAAW,EAAE,cAAc;MAC3B,aAAa,EAAE,gBAAgB;MAC/B,cAAc,EAAE,iBAAiB;MACjC,eAAe,EAAE,kBAAkB;KACpC,CAAC;;IAEF,IAAI,cAAc,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,CAAC;IACjE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,GAAG;MAC5C,QAAQ;MACR,MAAM;MACN,KAAK;MACL;MACA,OAAO,cAAc,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,QAAQ,IAAI,IAAI,CAAC,CAAC;SAClD,IAAI,CAAC,SAAS,KAAK,EAAE;UACpB,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,EAAE;YAC/B,KAAK,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC;WAC7B;UACD,IAAI,cAAc,CAAC,OAAO,GAAG,EAAE,IAAI,CAAC,MAAM,EAAE;;;YAG1C,IAAI;cACF,KAAK,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE;gBAC3B,IAAI,CAAC,IAAI,GAAG,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC;eACtD,CAAC,CAAC;aACJ,CAAC,OAAO,CAAC,EAAE;cACV,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,EAAE;gBAC1B,MAAM,CAAC,CAAC;eACT;;cAED,KAAK,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC,EAAE;gBAC9B,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,EAAE;kBACnC,IAAI,EAAE,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI;iBAC/C,CAAC,CAAC,CAAC;eACL,CAAC,CAAC;aACJ;WACF;UACD,OAAO,KAAK,CAAC;SACd,CAAC;SACD,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;KACxB,CAAC;GACH;;EAED,gBAAgB,EAAE,SAAS,MAAM,EAAE;IACjC,IAAI,cAAc,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,EAAE;MACxD,OAAO;KACR;IACD,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAY,GAAG,SAAS,MAAM,EAAE;MACjE,IAAI,EAAE,GAAG,IAAI,CAAC;MACdA,OAAK,CAAC,UAAU,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC;MAChD,IAAI,CAAC,UAAU,EAAE,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;QACzC,IAAI,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE;UACnE,EAAE,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;SACxB;OACF,CAAC,CAAC;KACJ,CAAC;GACH;CACF,CAAC;;;AAGF,gBAAc,GAAG;EACf,WAAW,EAAE,WAAW,CAAC,WAAW;EACpC,gBAAgB,EAAE,WAAW,CAAC,gBAAgB;EAC9C,kBAAkB,EAAE,WAAW,CAAC,kBAAkB;EAClD,gBAAgB,EAAE,WAAW,CAAC,gBAAgB;EAC9C,gBAAgB,EAAEC,cAAyB;CAC5C;;ACrND,IAAI,UAAU,GAAG;;;;;;;EAOf,mBAAmB,EAAE,SAAS,MAAM,EAAE;IACpC,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,CAAC,MAAM,CAAC,iBAAiB,EAAE;MAC3D,OAAO;KACR;IACD,IAAI,EAAE,iBAAiB,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;MAC9D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,eAAe,GAAG,WAAW;QAC9D,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;UACvB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;SACzB;QACD,OAAO,IAAI,CAAC,aAAa,CAAC;OAC3B,CAAC;KACH;IACD,IAAI,EAAE,eAAe,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;MAC5D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,aAAa,GAAG,SAAS,EAAE,EAAE;QAC9D,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,IAAI,IAAI,CAAC,aAAa,EAAE;UACtB,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;YAC1C,IAAI,MAAM,CAAC,EAAE,KAAK,EAAE,EAAE;cACpB,MAAM,GAAG,MAAM,CAAC;aACjB;WACF,CAAC,CAAC;SACJ;QACD,IAAI,IAAI,CAAC,cAAc,EAAE;UACvB,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;YAC3C,IAAI,MAAM,CAAC,EAAE,KAAK,EAAE,EAAE;cACpB,MAAM,GAAG,MAAM,CAAC;aACjB;WACF,CAAC,CAAC;SACJ;QACD,OAAO,MAAM,CAAC;OACf,CAAC;KACH;IACD,IAAI,EAAE,WAAW,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;MACxD,IAAI,SAAS,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,CAAC;MAC5D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,SAAS,GAAG,SAAS,MAAM,EAAE;QAC9D,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;UACvB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;SACzB;QACD,IAAI,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;UAC7C,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACjC;QACD,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,MAAM,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;UACzC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;SACrC,CAAC,CAAC;OACJ,CAAC;;MAEF,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,QAAQ,GAAG,SAAS,KAAK,EAAE,MAAM,EAAE;QACpE,IAAI,MAAM,EAAE;UACV,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,IAAI,CAAC,aAAa,GAAG,CAAC,MAAM,CAAC,CAAC;WAC/B,MAAM,IAAI,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;YACpD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;WACjC;SACF;QACD,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;OACrC,CAAC;KACH;IACD,IAAI,EAAE,cAAc,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;MAC3D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAY,GAAG,SAAS,MAAM,EAAE;QACjE,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;UACvB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;SACzB;QACD,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAC/C,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;UAChB,OAAO;SACR;QACD,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACpC,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAI,MAAM,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;QAChC,IAAI,CAAC,UAAU,EAAE,CAAC,OAAO,CAAC,SAAS,MAAM,EAAE;UACzC,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE;YACvC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;WAC1B;SACF,CAAC,CAAC;OACJ,CAAC;KACH;GACF;EACD,oBAAoB,EAAE,SAAS,MAAM,EAAE;IACrC,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,CAAC,MAAM,CAAC,iBAAiB,EAAE;MAC3D,OAAO;KACR;IACD,IAAI,EAAE,kBAAkB,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;MAC/D,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,gBAAgB,GAAG,WAAW;QAC/D,OAAO,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;OACvD,CAAC;KACH;IACD,IAAI,EAAE,aAAa,IAAI,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;MAC1D,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,CAAC,SAAS,EAAE,aAAa,EAAE;QACvE,GAAG,EAAE,WAAW;UACd,OAAO,IAAI,CAAC,YAAY,CAAC;SAC1B;QACD,GAAG,EAAE,SAAS,CAAC,EAAE;UACf,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;YACzD,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;WAC1D;UACD,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC;UAC1D,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC,EAAE;YACjE,IAAI,MAAM,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YAC1B,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;cACxB,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;aAC1B;YACD,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;cAC5C,OAAO;aACR;YACD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACjC,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,WAAW,CAAC,CAAC;YACnC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YAC5B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;WAC3B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SACf;OACF,CAAC,CAAC;KACJ;GACF;EACD,gBAAgB,EAAE,SAAS,MAAM,EAAE;IACjC,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,CAAC,MAAM,CAAC,iBAAiB,EAAE;MAC3D,OAAO;KACR;IACD,IAAI,SAAS,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC;IACnD,IAAI,WAAW,GAAG,SAAS,CAAC,WAAW,CAAC;IACxC,IAAI,YAAY,GAAG,SAAS,CAAC,YAAY,CAAC;IAC1C,IAAI,mBAAmB,GAAG,SAAS,CAAC,mBAAmB,CAAC;IACxD,IAAI,oBAAoB,GAAG,SAAS,CAAC,oBAAoB,CAAC;IAC1D,IAAI,eAAe,GAAG,SAAS,CAAC,eAAe,CAAC;;IAEhD,SAAS,CAAC,WAAW,GAAG,SAAS,eAAe,EAAE,eAAe,EAAE;MACjE,IAAI,OAAO,GAAG,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;MACpE,IAAI,OAAO,GAAG,WAAW,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;MACjD,IAAI,CAAC,eAAe,EAAE;QACpB,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,IAAI,CAAC,eAAe,EAAE,eAAe,CAAC,CAAC;MAC/C,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;KAC1B,CAAC;;IAEF,SAAS,CAAC,YAAY,GAAG,SAAS,eAAe,EAAE,eAAe,EAAE;MAClE,IAAI,OAAO,GAAG,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;MACpE,IAAI,OAAO,GAAG,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;MAClD,IAAI,CAAC,eAAe,EAAE;QACpB,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,IAAI,CAAC,eAAe,EAAE,eAAe,CAAC,CAAC;MAC/C,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;KAC1B,CAAC;;IAEF,IAAI,YAAY,GAAG,SAAS,WAAW,EAAE,eAAe,EAAE,eAAe,EAAE;MACzE,IAAI,OAAO,GAAG,mBAAmB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;MAC7D,IAAI,CAAC,eAAe,EAAE;QACpB,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,IAAI,CAAC,eAAe,EAAE,eAAe,CAAC,CAAC;MAC/C,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;KAC1B,CAAC;IACF,SAAS,CAAC,mBAAmB,GAAG,YAAY,CAAC;;IAE7C,YAAY,GAAG,SAAS,WAAW,EAAE,eAAe,EAAE,eAAe,EAAE;MACrE,IAAI,OAAO,GAAG,oBAAoB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;MAC9D,IAAI,CAAC,eAAe,EAAE;QACpB,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,IAAI,CAAC,eAAe,EAAE,eAAe,CAAC,CAAC;MAC/C,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;KAC1B,CAAC;IACF,SAAS,CAAC,oBAAoB,GAAG,YAAY,CAAC;;IAE9C,YAAY,GAAG,SAAS,SAAS,EAAE,eAAe,EAAE,eAAe,EAAE;MACnE,IAAI,OAAO,GAAG,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC;MACvD,IAAI,CAAC,eAAe,EAAE;QACpB,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,IAAI,CAAC,eAAe,EAAE,eAAe,CAAC,CAAC;MAC/C,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;KAC1B,CAAC;IACF,SAAS,CAAC,eAAe,GAAG,YAAY,CAAC;GAC1C;EACD,gBAAgB,EAAE,SAAS,MAAM,EAAE;IACjC,IAAI,SAAS,GAAG,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC;;IAE3C,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;MAC3B,IAAI,SAAS,CAAC,kBAAkB,EAAE;QAChC,SAAS,CAAC,YAAY,GAAG,SAAS,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;OACvE,MAAM,IAAI,SAAS,CAAC,YAAY;UAC7B,SAAS,CAAC,YAAY,CAAC,YAAY,EAAE;QACvC,SAAS,CAAC,YAAY,GAAG,SAAS,WAAW,EAAE,EAAE,EAAE,KAAK,EAAE;UACxD,SAAS,CAAC,YAAY,CAAC,YAAY,CAAC,WAAW,CAAC;WAC/C,IAAI,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;SAClB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;OACnB;KACF;GACF;EACD,oBAAoB,EAAE,SAAS,MAAM,EAAE;;IAErC,IAAI,kBAAkB,GAAG,MAAM,CAAC,iBAAiB,CAAC;IAClD,MAAM,CAAC,iBAAiB,GAAG,SAAS,QAAQ,EAAE,aAAa,EAAE;MAC3D,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;QACnC,IAAI,aAAa,GAAG,EAAE,CAAC;QACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;UACnD,IAAI,MAAM,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;UACpC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC;cAC9B,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;YAChCD,OAAK,CAAC,UAAU,CAAC,kBAAkB,EAAE,mBAAmB,CAAC,CAAC;YAC1D,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;YAC5C,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC;YACzB,OAAO,MAAM,CAAC,GAAG,CAAC;YAClB,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;WAC5B,MAAM;YACL,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;WAC5C;SACF;QACD,QAAQ,CAAC,UAAU,GAAG,aAAa,CAAC;OACrC;MACD,OAAO,IAAI,kBAAkB,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;KACxD,CAAC;IACF,MAAM,CAAC,iBAAiB,CAAC,SAAS,GAAG,kBAAkB,CAAC,SAAS,CAAC;;IAElE,IAAI,qBAAqB,IAAI,MAAM,CAAC,iBAAiB,EAAE;MACrD,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,EAAE,qBAAqB,EAAE;QACrE,GAAG,EAAE,WAAW;UACd,OAAO,kBAAkB,CAAC,mBAAmB,CAAC;SAC/C;OACF,CAAC,CAAC;KACJ;GACF;EACD,yBAAyB,EAAE,SAAS,MAAM,EAAE;;IAE1C,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,iBAAiB;SACrD,UAAU,IAAI,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC;;;QAG9C,CAAC,MAAM,CAAC,cAAc,EAAE;MAC1B,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,aAAa,CAAC,SAAS,EAAE,aAAa,EAAE;QACnE,GAAG,EAAE,WAAW;UACd,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;SAClC;OACF,CAAC,CAAC;KACJ;GACF;;EAED,qBAAqB,EAAE,SAAS,MAAM,EAAE;IACtC,IAAI,eAAe,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,WAAW,CAAC;IACrE,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,WAAW,GAAG,SAAS,YAAY,EAAE;MACtE,IAAI,EAAE,GAAG,IAAI,CAAC;MACd,IAAI,YAAY,EAAE;QAChB,IAAI,gBAAgB,GAAG,EAAE,CAAC,eAAe,EAAE,CAAC,IAAI,CAAC,SAAS,WAAW,EAAE;UACrE,OAAO,WAAW,CAAC,MAAM,CAAC,KAAK;cAC3B,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,KAAK,OAAO,CAAC;SAC/C,CAAC,CAAC;QACH,IAAI,YAAY,CAAC,mBAAmB,KAAK,KAAK,IAAI,gBAAgB,EAAE;UAClE,IAAI,gBAAgB,CAAC,SAAS,KAAK,UAAU,EAAE;YAC7C,gBAAgB,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;WAC3C,MAAM,IAAI,gBAAgB,CAAC,SAAS,KAAK,UAAU,EAAE;YACpD,gBAAgB,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;WAC3C;SACF,MAAM,IAAI,YAAY,CAAC,mBAAmB,KAAK,IAAI;YAChD,CAAC,gBAAgB,EAAE;UACrB,EAAE,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;SAC5B;;QAED,IAAI,gBAAgB,GAAG,EAAE,CAAC,eAAe,EAAE,CAAC,IAAI,CAAC,SAAS,WAAW,EAAE;UACrE,OAAO,WAAW,CAAC,MAAM,CAAC,KAAK;cAC3B,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,KAAK,OAAO,CAAC;SAC/C,CAAC,CAAC;QACH,IAAI,YAAY,CAAC,mBAAmB,KAAK,KAAK,IAAI,gBAAgB,EAAE;UAClE,IAAI,gBAAgB,CAAC,SAAS,KAAK,UAAU,EAAE;YAC7C,gBAAgB,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;WAC3C,MAAM,IAAI,gBAAgB,CAAC,SAAS,KAAK,UAAU,EAAE;YACpD,gBAAgB,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;WAC3C;SACF,MAAM,IAAI,YAAY,CAAC,mBAAmB,KAAK,IAAI;YAChD,CAAC,gBAAgB,EAAE;UACrB,EAAE,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;SAC5B;OACF;MACD,OAAO,eAAe,CAAC,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;KAC7C,CAAC;GACH;CACF,CAAC;;;AAGF,eAAc,GAAG;EACf,gBAAgB,EAAE,UAAU,CAAC,gBAAgB;EAC7C,mBAAmB,EAAE,UAAU,CAAC,mBAAmB;EACnD,oBAAoB,EAAE,UAAU,CAAC,oBAAoB;EACrD,gBAAgB,EAAE,UAAU,CAAC,gBAAgB;EAC7C,oBAAoB,EAAE,UAAU,CAAC,oBAAoB;EACrD,yBAAyB,EAAE,UAAU,CAAC,yBAAyB;EAC/D,qBAAqB,EAAE,UAAU,CAAC,qBAAqB;;;CAGxD;;;;ACpSD,SAAS,uBAAuB,CAAC,MAAM,EAAE,eAAe,EAAE,OAAO,EAAE;EACjE,IAAI,CAAC,MAAM,CAAC,iBAAiB,EAAE;IAC7B,OAAO;GACR;EACD,IAAI,KAAK,GAAG,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC;EAC/C,IAAI,sBAAsB,GAAG,KAAK,CAAC,gBAAgB,CAAC;EACpD,KAAK,CAAC,gBAAgB,GAAG,SAAS,eAAe,EAAE,EAAE,EAAE;IACrD,IAAI,eAAe,KAAK,eAAe,EAAE;MACvC,OAAO,sBAAsB,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KACtD;IACD,IAAI,eAAe,GAAG,SAAS,CAAC,EAAE;MAChC,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;KAChB,CAAC;IACF,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,IAAI,EAAE,CAAC;IACtC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,eAAe,CAAC;IACrC,OAAO,sBAAsB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,eAAe;MACxD,eAAe,CAAC,CAAC,CAAC;GACrB,CAAC;;EAEF,IAAI,yBAAyB,GAAG,KAAK,CAAC,mBAAmB,CAAC;EAC1D,KAAK,CAAC,mBAAmB,GAAG,SAAS,eAAe,EAAE,EAAE,EAAE;IACxD,IAAI,eAAe,KAAK,eAAe,IAAI,CAAC,IAAI,CAAC,SAAS;WACnD,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE;MAC1B,OAAO,yBAAyB,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KACzD;IACD,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;IACrC,OAAO,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;IAC1B,OAAO,yBAAyB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,eAAe;MAC3D,WAAW,CAAC,CAAC,CAAC;GACjB,CAAC;;EAEF,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,GAAG,eAAe,EAAE;IACnD,GAAG,EAAE,WAAW;MACd,OAAO,IAAI,CAAC,KAAK,GAAG,eAAe,CAAC,CAAC;KACtC;IACD,GAAG,EAAE,SAAS,EAAE,EAAE;MAChB,IAAI,IAAI,CAAC,KAAK,GAAG,eAAe,CAAC,EAAE;QACjC,IAAI,CAAC,mBAAmB,CAAC,eAAe;YACpC,IAAI,CAAC,KAAK,GAAG,eAAe,CAAC,CAAC,CAAC;QACnC,OAAO,IAAI,CAAC,KAAK,GAAG,eAAe,CAAC,CAAC;OACtC;MACD,IAAI,EAAE,EAAE;QACN,IAAI,CAAC,gBAAgB,CAAC,eAAe;YACjC,IAAI,CAAC,KAAK,GAAG,eAAe,CAAC,GAAG,EAAE,CAAC,CAAC;OACzC;KACF;GACF,CAAC,CAAC;CACJ;;AAED,eAAc,GAAG;EACf,mBAAmB,EAAE,SAAS,MAAM,EAAE;;;IAGpC,IAAI,MAAM,CAAC,eAAe,IAAI,YAAY;QACtC,MAAM,CAAC,eAAe,CAAC,SAAS,EAAE;MACpC,OAAO;KACR;;IAED,IAAI,qBAAqB,GAAG,MAAM,CAAC,eAAe,CAAC;IACnD,MAAM,CAAC,eAAe,GAAG,SAAS,IAAI,EAAE;;MAEtC,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,CAAC,SAAS;UAC1C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;QACtC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;QACxC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;OAC3C;;;MAGD,IAAI,eAAe,GAAG,IAAI,qBAAqB,CAAC,IAAI,CAAC,CAAC;MACtD,IAAI,eAAe,GAAGG,GAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;MAC9D,IAAI,kBAAkB,GAAG,MAAM,CAAC,MAAM,CAAC,eAAe;UAClD,eAAe,CAAC,CAAC;;;MAGrB,kBAAkB,CAAC,MAAM,GAAG,WAAW;QACrC,OAAO;UACL,SAAS,EAAE,kBAAkB,CAAC,SAAS;UACvC,MAAM,EAAE,kBAAkB,CAAC,MAAM;UACjC,aAAa,EAAE,kBAAkB,CAAC,aAAa;UAC/C,gBAAgB,EAAE,kBAAkB,CAAC,gBAAgB;SACtD,CAAC;OACH,CAAC;MACF,OAAO,kBAAkB,CAAC;KAC3B,CAAC;;;;IAIF,uBAAuB,CAAC,MAAM,EAAE,cAAc,EAAE,SAAS,CAAC,EAAE;MAC1D,IAAI,CAAC,CAAC,SAAS,EAAE;QACf,MAAM,CAAC,cAAc,CAAC,CAAC,EAAE,WAAW,EAAE;UACpC,KAAK,EAAE,IAAI,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,SAAS,CAAC;UAC9C,QAAQ,EAAE,OAAO;SAClB,CAAC,CAAC;OACJ;MACD,OAAO,CAAC,CAAC;KACV,CAAC,CAAC;GACJ;;;;EAID,mBAAmB,EAAE,SAAS,MAAM,EAAE;IACpC,IAAI,GAAG,GAAG,MAAM,IAAI,MAAM,CAAC,GAAG,CAAC;;IAE/B,IAAI,EAAE,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,gBAAgB;UACrD,WAAW,IAAI,MAAM,CAAC,gBAAgB,CAAC,SAAS;QAClD,GAAG,CAAC,eAAe,IAAI,GAAG,CAAC,eAAe,CAAC,EAAE;;MAE/C,OAAO,SAAS,CAAC;KAClB;;IAED,IAAI,qBAAqB,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC1D,IAAI,qBAAqB,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC1D,IAAI,OAAO,GAAG,IAAI,GAAG,EAAE,EAAE,KAAK,GAAG,CAAC,CAAC;;IAEnC,GAAG,CAAC,eAAe,GAAG,SAAS,MAAM,EAAE;MACrC,IAAI,WAAW,IAAI,MAAM,EAAE;QACzB,IAAI,GAAG,GAAG,WAAW,IAAI,EAAE,KAAK,CAAC,CAAC;QAClC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;QACzBH,OAAK,CAAC,UAAU,CAAC,6BAA6B;YAC1C,yBAAyB,CAAC,CAAC;QAC/B,OAAO,GAAG,CAAC;OACZ;MACD,OAAO,qBAAqB,CAAC,MAAM,CAAC,CAAC;KACtC,CAAC;IACF,GAAG,CAAC,eAAe,GAAG,SAAS,GAAG,EAAE;MAClC,qBAAqB,CAAC,GAAG,CAAC,CAAC;MAC3B,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;KACrB,CAAC;;IAEF,IAAI,GAAG,GAAG,MAAM,CAAC,wBAAwB,CAAC,MAAM,CAAC,gBAAgB,CAAC,SAAS;8CACjC,KAAK,CAAC,CAAC;IACjD,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,KAAK,EAAE;MAC9D,GAAG,EAAE,WAAW;QACd,OAAO,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;OAC5B;MACD,GAAG,EAAE,SAAS,GAAG,EAAE;QACjB,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC;QAC1C,OAAO,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;OACnC;KACF,CAAC,CAAC;;IAEH,IAAI,kBAAkB,GAAG,MAAM,CAAC,gBAAgB,CAAC,SAAS,CAAC,YAAY,CAAC;IACxE,MAAM,CAAC,gBAAgB,CAAC,SAAS,CAAC,YAAY,GAAG,WAAW;MAC1D,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC;UACtB,CAAC,EAAE,GAAG,SAAS,CAAC,CAAC,CAAC,EAAE,WAAW,EAAE,KAAK,KAAK,EAAE;QAC/C,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC;OACpD;MACD,OAAO,kBAAkB,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KAClD,CAAC;GACH;CACF;;;ACxJD,mBAAc,GAAG,SAAS,YAAY,EAAE,IAAI,EAAE;EAC5C,IAAI,MAAM,GAAG,YAAY,IAAI,YAAY,CAAC,MAAM,CAAC;;EAEjD,IAAI,OAAO,GAAG;IACZ,UAAU,EAAE,IAAI;IAChB,WAAW,EAAE,IAAI;IACjB,QAAQ,EAAE,IAAI;IACd,UAAU,EAAE,IAAI;GACjB,CAAC;;EAEF,KAAK,IAAI,GAAG,IAAI,IAAI,EAAE;IACpB,IAAI,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE;MAClC,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;KAC1B;GACF;;;EAGD,IAAI,OAAO,GAAGA,OAAK,CAAC,GAAG,CAAC;EACxB,IAAI,cAAc,GAAGA,OAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;;;EAGjD,IAAI,OAAO,GAAG;IACZ,cAAc,EAAE,cAAc;IAC9B,cAAc,EAAEA,OAAK,CAAC,cAAc;IACpC,UAAU,EAAEA,OAAK,CAAC,UAAU;IAC5B,eAAe,EAAEA,OAAK,CAAC,eAAe;GACvC,CAAC;;;;;;;;;EASF,IAAI,UAAU,GAAGC,WAA+B,IAAI,IAAI,CAAC;EACzD,IAAI,QAAQ,GAAGI,SAA2B,IAAI,IAAI,CAAC;EACnD,IAAI,WAAW,GAAGC,YAAiC,IAAI,IAAI,CAAC;EAC5D,IAAI,UAAU,GAAGC,WAA+B,IAAI,IAAI,CAAC;EACzD,IAAI,UAAU,GAAGC,WAAwB,IAAI,IAAI,CAAC;;;EAGlD,QAAQ,cAAc,CAAC,OAAO;IAC5B,KAAK,QAAQ;MACX,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,CAAC,kBAAkB;UAC7C,CAAC,OAAO,CAAC,UAAU,EAAE;QACvB,OAAO,CAAC,sDAAsD,CAAC,CAAC;QAChE,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,6BAA6B,CAAC,CAAC;;MAEvC,OAAO,CAAC,WAAW,GAAG,UAAU,CAAC;MACjC,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;;MAEvC,UAAU,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;MACpC,UAAU,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;MACnC,UAAU,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;MACpC,UAAU,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;MACtC,UAAU,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;MAC/B,UAAU,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC;MAC3C,UAAU,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;;MAE1C,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;MACvC,MAAM;IACR,KAAK,SAAS;MACZ,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW,CAAC,kBAAkB;UAC/C,CAAC,OAAO,CAAC,WAAW,EAAE;QACxB,OAAO,CAAC,uDAAuD,CAAC,CAAC;QACjE,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,8BAA8B,CAAC,CAAC;;MAExC,OAAO,CAAC,WAAW,GAAG,WAAW,CAAC;MAClC,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;;MAEvC,WAAW,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;MACrC,WAAW,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;MACrC,WAAW,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;MACvC,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;MAChC,WAAW,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;;MAErC,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;MACvC,MAAM;IACR,KAAK,MAAM;MACT,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,kBAAkB,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;QAClE,OAAO,CAAC,uDAAuD,CAAC,CAAC;QACjE,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,2BAA2B,CAAC,CAAC;;MAErC,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC;MAC/B,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;;MAEvC,QAAQ,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;MAClC,QAAQ,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;MACpC,QAAQ,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;;;MAGlC,MAAM;IACR,KAAK,QAAQ;MACX,IAAI,CAAC,UAAU,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;QACtC,OAAO,CAAC,sDAAsD,CAAC,CAAC;QAChE,OAAO,OAAO,CAAC;OAChB;MACD,OAAO,CAAC,6BAA6B,CAAC,CAAC;;MAEvC,OAAO,CAAC,WAAW,GAAG,UAAU,CAAC;MACjC,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;;MAEvC,UAAU,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;MACxC,UAAU,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;MACpC,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;MACvC,UAAU,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;MACxC,UAAU,CAAC,yBAAyB,CAAC,MAAM,CAAC,CAAC;MAC7C,UAAU,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;MACpC,UAAU,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;;MAEzC,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;MACvC,MAAM;IACR;MACE,OAAO,CAAC,sBAAsB,CAAC,CAAC;MAChC,MAAM;GACT;;EAED,OAAO,OAAO,CAAC;CAChB;;AC9HD,gBAAc,GAAGC,eAAc,CAAC,CAAC,MAAM,EAAEC,cAAM,CAAC,MAAM,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICZnCC;yBACL;;;SACPC,SAAL,GAAiB,EAAjB;;;wBAGFC,6CAAiBC,MAAMC,UAAU;QAC3B,EAAED,QAAQ,KAAKF,SAAf,CAAJ,EAA+B;WACxBA,SAAL,CAAeE,IAAf,IAAuB,EAAvB;;SAEGF,SAAL,CAAeE,IAAf,EAAqBE,IAArB,CAA0BD,QAA1B;;;wBAGFE,mDAAoBH,MAAMC,UAAU;QAC9B,EAAED,QAAQ,KAAKF,SAAf,CAAJ,EAA+B;;QAEzBM,QAAQ,KAAKN,SAAL,CAAeE,IAAf,CAAd;SACK,IAAIK,IAAI,CAAR,EAAWC,IAAIF,MAAMG,MAA1B,EAAkCF,IAAIC,CAAtC,EAAyCD,KAAK,CAA9C,EAAiD;UAC3CD,MAAMC,CAAN,MAAaJ,QAAjB,EAA2B;cACnBO,MAAN,CAAaH,CAAb,EAAgB,CAAhB;;;;;;wBAMNI,uCAAcC,OAAO;QACf,EAAEA,MAAMV,IAAN,IAAc,KAAKF,SAArB,CAAJ,EAAqC,OAAO,IAAP;;QAE/BM,QAAQ,KAAKN,SAAL,CAAeY,MAAMV,IAArB,CAAd;SACK,IAAIK,IAAI,CAAR,EAAWC,IAAIF,MAAMG,MAA1B,EAAkCF,IAAIC,CAAtC,EAAyCD,KAAK,CAA9C,EAAiD;YACzCA,CAAN,EAASM,IAAT,CAAc,IAAd,EAAoBD,KAApB;;WAEK,CAACA,MAAME,gBAAd;;;wBAGFC,iBAAGb,MAAMC,UAAU;WACV,KAAKF,gBAAL,CAAsBC,IAAtB,EAA4BC,QAA5B,CAAP;;;;;;IC/BiBa;;;yBACL;;;gDACZ,uBADY;;UAGPC,KAAL,GAAa,EAAb;;UAEKC,OAAL,GAAe;kBACD,IADC;eAEJ,IAFI;YAGP;KAHR;;UAMKC,wBAAL,GAAgC,EAAEC,YAAY,CAAC,EAAEC,MAAM,CAAC,8BAAD,CAAR,EAAD,CAAd,EAAhC;UACKC,qBAAL,GAA6B,EAAEC,SAAS,KAAX,EAAkBC,mBAAmB,IAArC,EAA7B;;UAEKC,eAAL,GAAuBC,GAAGC,OAAH,CAAW,GAAX,CAAvB;;UAEKC,gBAAL;UACKC,iBAAL;;;;wBAGFD,+CAAmB;;SAEZ,IAAME,MAAX,IAAqB,IAArB,EAA2B;UACrB,OAAO,KAAKA,MAAL,CAAP,KAAwB,UAA5B,EAAwC;aACjCA,MAAL,IAAe,KAAKA,MAAL,EAAaC,IAAb,CAAkB,IAAlB,CAAf;;;;;wBAKNF,iDAAoB;SACbJ,eAAL,CAAqBV,EAArB,CAAwB,SAAxB,EAAmC,KAAKiB,YAAxC;SACKP,eAAL,CAAqBV,EAArB,CAAwB,SAAxB,EAAmC,KAAKkB,SAAxC;SACKR,eAAL,CAAqBV,EAArB,CAAwB,YAAxB,EAAsC,KAAKmB,YAA3C;SACKT,eAAL,CAAqBV,EAArB,CAAwB,WAAxB,EAAqC,KAAKoB,WAA1C;SACKV,eAAL,CAAqBV,EAArB,CAAwB,gBAAxB,EAA0C,KAAKqB,gBAA/C;SACKX,eAAL,CAAqBV,EAArB,CAAwB,YAAxB,EAAsC,KAAKsB,YAA3C;SACKZ,eAAL,CAAqBV,EAArB,CAAwB,gBAAxB,EAA0C,KAAKuB,gBAA/C;SACKb,eAAL,CAAqBV,EAArB,CAAwB,wBAAxB,EAAkD,KAAKwB,wBAAvD;;;wBAGFC,mCAAYC,OAAiB;;;sCAAPC,KAAO;WAAA;;;QACrBC,OAAOD,MAAMjC,MAAN,KAAiB,CAAjB,GAAqBiC,MAAM,CAAN,CAArB,GAAgCA,KAA7C;QACME,WAAWC,OAAOC,IAAP,CAAY,KAAK7B,KAAjB,CAAjB;;aAES8B,OAAT,CAAiB,UAACC,MAAD,EAAY;UACvB,CAAC,OAAK/B,KAAL,CAAW+B,MAAX,EAAmBC,OAAxB,EAAiC;UAC7B,OAAKhC,KAAL,CAAW+B,MAAX,EAAmBC,OAAnB,CAA2BC,UAA3B,KAA0C,MAA9C,EAAsD;;UAEhDC,UAAUC,KAAKC,SAAL,CAAe,EAAEZ,YAAF,EAASE,UAAT,EAAf,CAAhB;aACK1B,KAAL,CAAW+B,MAAX,EAAmBC,OAAnB,CAA2BK,IAA3B,CAAgCH,OAAhC;KALF;;;wBASFnB,uCAAe;YACLuB,GAAR,CAAY,KAAK9B,eAAL,CAAqB+B,EAAjC;;;wBAGFvB,+BAAUe,QAAQS,iBAAiB;QAC7B,CAACA,gBAAgBC,SAArB,EAAgC;QAC5B,CAAC,KAAKzC,KAAL,CAAW+B,MAAX,CAAL,EAAyB;;SAEpB/B,KAAL,CAAW+B,MAAX,EAAmBW,UAAnB,CAA8BC,eAA9B,CAA8CH,eAA9C;;;wBAGFvB,qCAAac,QAAQa,6BAA6B;QAC5C,CAAC,KAAK5C,KAAL,CAAW+B,MAAX,CAAL,EAAyB;;SAEpB/B,KAAL,CAAW+B,MAAX,EAAmBW,UAAnB,CAA8BG,oBAA9B,CAAmDD,2BAAnD;;;wBAGF1B,mCAAYa,QAAQa,6BAA6B;;;QAC3C,KAAK5C,KAAL,CAAW+B,MAAX,CAAJ,EAAwB;;SAEnB/B,KAAL,CAAW+B,MAAX,iBAA0B,KAAK9B,OAA/B;QACM6C,OAAO,KAAK9C,KAAL,CAAW+B,MAAX,CAAb;;SAEKW,UAAL,GAAkB,IAAIK,iBAAJ,CAAsB,KAAK7C,wBAA3B,EAAqD,IAArD,CAAlB;;SAEKwC,UAAL,CACGG,oBADH,CACwBD,2BADxB,EAEGI,IAFH,CAEQ;aAAMF,KAAKJ,UAAL,CAAgBO,YAAhB,EAAN;KAFR,EAGGD,IAHH,CAGQ,UAACE,0BAAD,EAAgC;WAC/BR,UAAL,CAAgBS,mBAAhB,CAAoCD,0BAApC;aACK1C,eAAL,CAAqB4C,IAArB,CAA0B,YAA1B,EAAwCrB,MAAxC,EAAgDmB,0BAAhD;KALJ,EAOGG,KAPH,CAOS,YAAM;aACN3D,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,iBAAhB,EAAmC;gBAC5C,EAAEpB,SAAS,oCAAX;OADS,CAAnB;KARJ;;SAaKQ,UAAL,CAAgB1D,gBAAhB,CAAiC,cAAjC,EAAiD,UAACuE,yBAAD,EAA+B;UAC1E,CAACA,0BAA0Bd,SAA/B,EAA0C;;aAErCjC,eAAL,CAAqB4C,IAArB,CAA0B,SAA1B,EAAqCrB,MAArC,EAA6CwB,0BAA0Bd,SAAvE;KAHF;;SAMKC,UAAL,CAAgB1D,gBAAhB,CAAiC,aAAjC,EAAgD,UAACwE,mBAAD,EAAyB;UACnE,CAACA,oBAAoBxB,OAAzB,EAAkC;;WAE7BA,OAAL,GAAewB,oBAAoBxB,OAAnC;;WAEKA,OAAL,CAAahD,gBAAb,CAA8B,MAA9B,EAAsC,YAAM;eACrCU,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,wBAAhB,EAA0C;kBACnD,EAAEG,OAAO,MAAT,EAAiBf,YAAY,EAAEX,cAAF,EAA7B;SADS,CAAnB;;aAIKC,OAAL,CAAahD,gBAAb,CAA8B,SAA9B,EAAyC,OAAK0E,SAA9C;OALF;;WAQK1B,OAAL,CAAahD,gBAAb,CAA8B,OAA9B,EAAuC,YAAM;eACtCU,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,wBAAhB,EAA0C;kBACnD,EAAEG,OAAO,OAAT,EAAkBf,YAAY,EAAEX,cAAF,EAA9B;SADS,CAAnB;OADF;KAbF;;;wBAqBFZ,6CAAiBY,QAAQ;;;QACnB,KAAK/B,KAAL,CAAW+B,MAAX,CAAJ,EAAwB;;SAEnB/B,KAAL,CAAW+B,MAAX,iBAA0B,KAAK9B,OAA/B;QACM6C,OAAO,KAAK9C,KAAL,CAAW+B,MAAX,CAAb;;SAEKW,UAAL,GAAkB,IAAIK,iBAAJ,CAAsB,KAAK7C,wBAA3B,EAAqD,IAArD,CAAlB;;SAEK8B,OAAL,GAAec,KAAKJ,UAAL,CAAgBiB,iBAAhB,CAAkC,aAAlC,EAAiD,KAAKtD,qBAAtD,CAAf;;SAEKqC,UAAL,CAAgB1D,gBAAhB,CAAiC,aAAjC,EAAgD,UAACW,KAAD,EAAW;WACpDqC,OAAL,GAAerC,MAAMqC,OAArB;KADF;;SAIKU,UAAL,CAAgB1D,gBAAhB,CAAiC,cAAjC,EAAiD,UAACuE,yBAAD,EAA+B;UAC1E,CAACA,0BAA0Bd,SAA/B,EAA0C;;aAErCjC,eAAL,CAAqB4C,IAArB,CAA0B,SAA1B,EAAqCrB,MAArC,EAA6CwB,0BAA0Bd,SAAvE;KAHF;;SAMKC,UAAL,CAAgB1D,gBAAhB,CAAiC,mBAAjC,EAAsD,YAAM;WACrD0D,UAAL,CACGkB,WADH,GAEGZ,IAFH,CAEQ,UAACE,0BAAD,EAAgC;aAC/BR,UAAL,CAAgBS,mBAAhB,CAAoCD,0BAApC;eACK1C,eAAL,CAAqB4C,IAArB,CAA0B,WAA1B,EAAuCrB,MAAvC,EAA+CmB,0BAA/C;OAJJ,EAMGG,KANH,CAMS,YAAM;eACN3D,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,iBAAhB,EAAmC;kBAC5C,EAAEpB,SAAS,oCAAX;SADS,CAAnB;OAPJ;KADF;;SAcKF,OAAL,CAAahD,gBAAb,CAA8B,MAA9B,EAAsC,YAAM;aACrCU,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,wBAAhB,EAA0C;gBACnD,EAAEG,OAAO,MAAT,EAAiBf,YAAY,EAAEX,cAAF,EAA7B;OADS,CAAnB;;WAIKC,OAAL,CAAahD,gBAAb,CAA8B,SAA9B,EAAyC,OAAK0E,SAA9C;KALF;;SAQK1B,OAAL,CAAahD,gBAAb,CAA8B,OAA9B,EAAuC,YAAM;aACtCU,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,wBAAhB,EAA0C;gBACnD,EAAEG,OAAO,OAAT,EAAkBf,YAAY,EAAEX,cAAF,EAA9B;OADS,CAAnB;KADF;;;;;;wBAQFX,qCAAaW,QAAQL,MAAM;QACrB,CAAC,KAAK1B,KAAL,CAAW+B,MAAX,CAAL,EAAyB;;QAEnB8B,WAAW1B,KAAK2B,KAAL,CAAWpC,IAAX,CAAjB;;SAEK1B,KAAL,CAAW+B,MAAX,EAAmBL,IAAnB,GAA0B;YAClBmC,SAASE,IADS;WAEnBF,SAASG;KAFhB;;SAKKtE,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,YAAhB,EAA8B;cACvC,EAAEW,MAAM,EAAE1B,IAAIR,MAAN,EAAcgC,MAAMF,SAASE,IAA7B,EAAmCC,KAAKH,SAASG,GAAjD,EAAR;KADS,CAAnB;;;wBAKFN,+BAAUQ,cAAc;sBACE/B,KAAK2B,KAAL,CAAWI,aAAaxC,IAAxB,CADF;QACdF,KADc,eACdA,KADc;QACPE,IADO,eACPA,IADO;;QAGlBF,UAAU,UAAd,EAA0B,KAAK2C,cAAL,CAAoBzC,IAApB;QACtBF,UAAU,SAAd,EAAyB;WAClB9B,aAAL,CAAmB,IAAI0E,KAAJ,CAAU,SAAV,EAAqB,EAAEC,SAAS,KAAX,EAAkBC,YAAY,KAA9B,EAArB,CAAnB;;;;wBAIJjD,6CAAiBU,QAAQ;QACnB,CAAC,KAAK/B,KAAL,CAAW+B,MAAX,CAAL,EAAyB;;SAEpB/B,KAAL,CAAW+B,MAAX,EAAmBC,OAAnB,CAA2BuC,KAA3B;SACKvE,KAAL,CAAW+B,MAAX,EAAmBW,UAAnB,CAA8B6B,KAA9B;WACO,KAAKvE,KAAL,CAAW+B,MAAX,CAAP;;;wBAGFT,6DAAyBE,OAAOE,MAAM;;YAE5BY,GAAR,CAAYd,KAAZ,EAAmBE,IAAnB;;QAEIF,UAAU,aAAd,EAA6B;WACtB9B,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,aAAhB,EAA+B;gBACxC,EAAEkB,QAAQ,SAAV,EAAqBC,MAAM,EAAEV,MAAMrC,IAAR,EAA3B;OADS,CAAnB;;;QAKEF,UAAU,YAAd,EAA4B;WACrB9B,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,aAAhB,EAA+B;gBACxC,EAAEkB,QAAQ,QAAV,EAAoBC,MAAM,EAAEV,MAAMrC,IAAR,EAA1B;OADS,CAAnB;;;QAKEF,UAAU,WAAd,EAA2B;WACpB9B,aAAL,CAAmB,IAAI4D,WAAJ,CAAgB,WAAhB,EAA6B;gBACtC,EAAEpB,SAASR,IAAX;OADS,CAAnB;;;;wBAMJgD,mCAAa;SACNlE,eAAL,CAAqB4C,IAArB,CAA0B,YAA1B;;;wBAGFuB,6BAASC,UAAU;SACZpE,eAAL,CAAqB4C,IAArB,CAA0B,UAA1B,EAAsCwB,QAAtC;;;wBAGFC,mCAAYd,MAAMC,KAAK;SAChBxD,eAAL,CAAqB4C,IAArB,CAA0B,WAA1B,EAAuCjB,KAAKC,SAAL,CAAe,EAAE2B,UAAF,EAAQC,QAAR,EAAf,CAAvC;;;;EAzOqClF;;ACJzC,oBAAe,UAACgG,KAAD;MAAQC,KAAR,uEAAgB,GAAhB;SACb,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;QACzBC,SAAS,IAAIC,UAAJ,EAAf;QACMC,MAAM,IAAIC,KAAJ,EAAZ;QACMC,SAASC,SAASC,aAAT,CAAuB,QAAvB,CAAf;WACOC,KAAP,GAAeX,KAAf;WACOY,MAAP,GAAgBZ,KAAhB;WACO/F,gBAAP,CAAwB,MAAxB,EAAgC,YAAM;UAChCA,gBAAJ,CAAqB,MAArB,EAA6B,YAAM;YAC7BqG,IAAIK,KAAJ,KAAcL,IAAIM,MAAtB,EAA8B;iBACrBC,UAAP,CAAkB,IAAlB,EAAwBC,SAAxB,CAAkCR,GAAlC,EAAuC,CAAvC,EAA0C,CAA1C,EAA6CN,KAA7C,EAAoDA,KAApD;SADF,MAEO;iBAEFa,UADH,CACc,IADd,EAEGC,SAFH,CAGIR,GAHJ,EAIIA,IAAIK,KAAJ,GAAYL,IAAIM,MAAhB,GAAyB,CAACN,IAAIK,KAAJ,GAAYL,IAAIM,MAAjB,IAA2B,CAApD,GAAwD,CAJ5D,EAKIN,IAAIK,KAAJ,GAAYL,IAAIM,MAAhB,GAAyB,CAAzB,GAA6B,CAACN,IAAIM,MAAJ,GAAaN,IAAIK,KAAlB,IAA2B,CAL5D,EAMIL,IAAIK,KAAJ,GAAYL,IAAIM,MAAhB,GAAyBN,IAAIM,MAA7B,GAAsCN,IAAIK,KAN9C,EAOIL,IAAIK,KAAJ,GAAYL,IAAIM,MAAhB,GAAyBN,IAAIM,MAA7B,GAAsCN,IAAIK,KAP9C,EAQI,CARJ,EASI,CATJ,EAUIX,KAVJ,EAWIA,KAXJ;;gBAcMQ,OAAOO,SAAP,EAAR;OAlBF;UAoBI9G,gBAAJ,CAAqB,OAArB,EAA8BkG,MAA9B;UACIa,GAAJ,GAAUZ,OAAOa,MAAjB;KAtBF;WAwBOhH,gBAAP,CAAwB,OAAxB,EAAiCkG,MAAjC;WACOe,aAAP,CAAqBnB,KAArB;GA/BF,CADa;CAAf;;ACGA,IAAIoB,cAAc,IAAlB;;AAEA,IAAMC,oBAAoBX,SAASY,aAAT,CAAuB,qBAAvB,CAA1B;AACA,IAAMC,kBAAkBb,SAASY,aAAT,CAAuB,mBAAvB,CAAxB;AACA,IAAME,iBAAiBd,SAASY,aAAT,CAAuB,kBAAvB,CAAvB;AACA,IAAMG,kBAAkBf,SAASY,aAAT,CAAuB,mBAAvB,CAAxB;;AAEA,IAAMI,iBAAiBhB,SAASY,aAAT,CAAuB,kBAAvB,CAAvB;AACA,IAAMK,oBAAoBjB,SAASY,aAAT,CAAuB,qBAAvB,CAA1B;AACA,IAAMM,eAAelB,SAASY,aAAT,CAAuB,eAAvB,CAArB;;AAEA,IAAM9D,MAAM;QACJ,cAACd,KAAD;;;sCAAWE,IAAX;UAAA;;;WACJ,qBAAQY,GAAR,0BAAkBd,KAAlB,QAA4B,sCAA5B,SAAuEE,IAAvE,EADI;GADI;OAGL,aAACF,KAAD;;;uCAAWE,IAAX;UAAA;;;WAAoB,sBAAQY,GAAR,2BAAkBd,KAAlB,QAA4B,+BAA5B,SAAgEE,IAAhE,EAApB;GAHK;SAIH,eAACF,KAAD;;;uCAAWE,IAAX;UAAA;;;WACL,sBAAQY,GAAR,2BAAkBd,KAAlB,QAA4B,uCAA5B,SAAwEE,IAAxE,EADK;;CAJT;;AAQA,IAAMiF,cAAc,SAAdA,WAAc,CAAChH,KAAD,EAAW;MACzBiH,MAAJ,CAAW,MAAX,EAAmBjH,MAAMkH,MAAN,CAAa3E,OAAhC;CADF;;AAIA,IAAM4E,gBAAgB,SAAhBA,aAAgB,CAACnH,KAAD,EAAW;MACzB6E,SAAS7E,MAAMkH,MAAN,CAAarC,MAAb,KAAwB,SAAxB,GAAoC,oBAApC,GAA2D,QAA1E;MACMT,OAAOpE,MAAMkH,MAAN,CAAapC,IAAb,CAAkBV,IAA/B;;MAEIpE,MAAMkH,MAAN,CAAarC,MAAb,KAAwB,SAA5B,EAAuC;oBACrBuC,WAAhB,GAA8BhD,IAA9B;;;iBAGaiD,QAAf,GAA0B,IAA1B;oBACkBA,QAAlB,GAA6B,IAA7B;kBACgBA,QAAhB,GAA2B,IAA3B;;MAEIC,IAAJ,CAAS,KAAT,oBAAgCzC,MAAhC,cAA+CT,IAA/C;CAZF;;AAeA,IAAMmD,gBAAgB,SAAhBA,aAAgB,CAACvH,KAAD,EAAW;MACzB8D,QAAQ9D,MAAMkH,MAAN,CAAapD,KAA3B;MACM1B,SAASpC,MAAMkH,MAAN,CAAanE,UAAb,CAAwBX,MAAvC;;MAEI0B,UAAU,MAAd,EAAsBnB,IAAI6E,KAAJ,CAAU,YAAV,wBAA4CpF,MAA5C;MAClB0B,UAAU,OAAd,EAAuBnB,IAAI8E,GAAJ,CAAQ,eAAR,YAAiCrF,MAAjC;CALzB;;AAQA,IAAMX,eAAe,SAAfA,YAAe,CAACzB,KAAD,EAAW;MAC1BsH,IAAJ,CAAS,KAAT,4BAAwCtH,MAAMkH,MAAN,CAAa5C,IAAb,CAAkB1B,EAA1D,eAAsE5C,MAAMkH,MAAN,CAAa5C,IAAb,CAAkBF,IAAxF;CADF;;AAIA,IAAMsD,UAAU,SAAVA,OAAU,GAAM;MACdtD,OAAOyC,eAAec,KAA5B;MACMC,UAAUd,kBAAkBe,KAAlB,CAAwB,CAAxB,CAAhB;;MAEI,CAACzD,IAAD,IAASA,SAAS,EAAlB,IAAwB,CAACwD,OAA7B,EAAsC;;eAEzBA,OAAb,EAAsBvE,IAAtB,CAA2B;WAAOkD,YAAYrB,WAAZ,CAAwBd,IAAxB,EAA8BC,GAA9B,CAAP;GAA3B;CANF;;AASA,IAAMyD,aAAa,SAAbA,UAAa,GAAM;MACjB7C,WAAW0B,eAAegB,KAAhC;MACI,CAAC1C,QAAD,IAAaA,aAAa,EAA9B,EAAkC;cACtBD,QAAZ,CAAqBC,QAArB;CAHF;;AAMA,IAAM8C,YAAY,SAAZA,SAAY,CAAC/H,KAAD,EAAW;MACvBA,MAAMgI,OAAN,KAAkB,EAAtB,EAA0B;;CAD5B;;AAKA,IAAMC,kBAAkB,SAAlBA,eAAkB,GAAM;gBACd,IAAI7H,WAAJ,EAAd;;kBAEgBf,gBAAhB,CAAiC,OAAjC,EAA0CyI,UAA1C;iBACezI,gBAAf,CAAgC,SAAhC,EAA2C0I,SAA3C;oBACkB1I,gBAAlB,CAAmC,OAAnC,EAA4CkH,YAAYxB,UAAxD;eACa1F,gBAAb,CAA8B,OAA9B,EAAuCqI,OAAvC;;cAEYvH,EAAZ,CAAe,WAAf,EAA4B6G,WAA5B;cACY7G,EAAZ,CAAe,aAAf,EAA8BgH,aAA9B;cACYhH,EAAZ,CAAe,wBAAf,EAAyCoH,aAAzC;cACYpH,EAAZ,CAAe,YAAf,EAA6BsB,YAA7B;CAXF;;AAcA,IAAMyG,OAAO,SAAPA,IAAO,GAAM;;;SAGV7H,KAAP,GAAekG,YAAYlG,KAA3B;SACOqC,IAAP,GAAc6D,YAAY3E,WAA1B;CAJF;;AAOAsG;;;;"}